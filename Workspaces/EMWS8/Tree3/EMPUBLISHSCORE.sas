****************************************************************;
******             DECISION TREE SCORING CODE             ******;
****************************************************************;

******         LENGTHS OF NEW CHARACTER VARIABLES         ******;
LENGTH I_DepVar  $   12;
LENGTH _WARN_  $    4;

******              LABELS FOR NEW VARIABLES              ******;
LABEL _NODE_  = 'Node' ;
LABEL _LEAF_  = 'Leaf' ;
LABEL P_DepVar0  = 'Predicted: DepVar=0' ;
LABEL P_DepVar1  = 'Predicted: DepVar=1' ;
LABEL Q_DepVar0  = 'Unadjusted P: DepVar=0' ;
LABEL Q_DepVar1  = 'Unadjusted P: DepVar=1' ;
LABEL V_DepVar0  = 'Validated: DepVar=0' ;
LABEL V_DepVar1  = 'Validated: DepVar=1' ;
LABEL I_DepVar  = 'Into: DepVar' ;
LABEL U_DepVar  = 'Unnormalized Into: DepVar' ;
LABEL _WARN_  = 'Warnings' ;


******      TEMPORARY VARIABLES FOR FORMATTED VALUES      ******;
LENGTH _ARBFMT_12 $     12; DROP _ARBFMT_12;
_ARBFMT_12 = ' '; /* Initialize to avoid warning. */


******             ASSIGN OBSERVATION TO NODE             ******;
_ARBFMT_12 = PUT( GRP_RFMstat , BEST12.);
 %DMNORMIP( _ARBFMT_12);
IF _ARBFMT_12 IN ('5' ) THEN DO;
  _ARBFMT_12 = PUT( GRP_AcceptedCmp5 , BEST12.);
   %DMNORMIP( _ARBFMT_12);
  IF _ARBFMT_12 IN ('3' ) THEN DO;
    _ARBFMT_12 = PUT( GRP_Recency , BEST12.);
     %DMNORMIP( _ARBFMT_12);
    IF _ARBFMT_12 IN ('2' ) THEN DO;
      _NODE_  =                    8;
      _LEAF_  =                    1;
      P_DepVar0  =     0.90254237288135;
      P_DepVar1  =     0.09745762711864;
      Q_DepVar0  =     0.90254237288135;
      Q_DepVar1  =     0.09745762711864;
      V_DepVar0  =     0.65853658536585;
      V_DepVar1  =     0.34146341463414;
      I_DepVar  = '0' ;
      U_DepVar  =                    0;
      END;
    ELSE DO;
      _NODE_  =                    9;
      _LEAF_  =                    2;
      P_DepVar0  =     0.90254237288135;
      P_DepVar1  =     0.09745762711864;
      Q_DepVar0  =     0.90254237288135;
      Q_DepVar1  =     0.09745762711864;
      V_DepVar0  =     0.65853658536585;
      V_DepVar1  =     0.34146341463414;
      I_DepVar  = '0' ;
      U_DepVar  =                    0;
      END;
    END;
  ELSE DO;
    _ARBFMT_12 = PUT( GRP_Recency , BEST12.);
     %DMNORMIP( _ARBFMT_12);
    IF _ARBFMT_12 IN ('3' ,'5' ,'4' ) THEN DO;
      _NODE_  =                   11;
      _LEAF_  =                    5;
      P_DepVar0  =     0.83132530120481;
      P_DepVar1  =     0.16867469879518;
      Q_DepVar0  =     0.83132530120481;
      Q_DepVar1  =     0.16867469879518;
      V_DepVar0  =     0.82222222222222;
      V_DepVar1  =     0.17777777777777;
      I_DepVar  = '0' ;
      U_DepVar  =                    0;
      END;
    ELSE DO;
      _ARBFMT_12 = PUT( GRP_NumCatalogPurchases , BEST12.);
       %DMNORMIP( _ARBFMT_12);
      IF _ARBFMT_12 IN ('5' ) THEN DO;
        _NODE_  =                   18;
        _LEAF_  =                    3;
        P_DepVar0  =     0.93548387096774;
        P_DepVar1  =     0.06451612903225;
        Q_DepVar0  =     0.93548387096774;
        Q_DepVar1  =     0.06451612903225;
        V_DepVar0  =     0.48333333333333;
        V_DepVar1  =     0.51666666666666;
        I_DepVar  = '0' ;
        U_DepVar  =                    0;
        END;
      ELSE DO;
        _NODE_  =                   19;
        _LEAF_  =                    4;
        P_DepVar0  =     0.94262295081967;
        P_DepVar1  =     0.05737704918032;
        Q_DepVar0  =     0.94262295081967;
        Q_DepVar1  =     0.05737704918032;
        V_DepVar0  =     0.75510204081632;
        V_DepVar1  =     0.24489795918367;
        I_DepVar  = '0' ;
        U_DepVar  =                    0;
        END;
      END;
    END;
  END;
ELSE DO;
  _ARBFMT_12 = PUT( GRP_Recency , BEST12.);
   %DMNORMIP( _ARBFMT_12);
  IF _ARBFMT_12 IN ('2' ) THEN DO;
    _NODE_  =                    7;
    _LEAF_  =                    9;
    P_DepVar0  =      0.5645933014354;
    P_DepVar1  =     0.43540669856459;
    Q_DepVar0  =      0.5645933014354;
    Q_DepVar1  =     0.43540669856459;
    V_DepVar0  =     0.72268907563025;
    V_DepVar1  =     0.27731092436974;
    I_DepVar  = '0' ;
    U_DepVar  =                    0;
    END;
  ELSE DO;
    _ARBFMT_12 = PUT( GRP_AcceptedCmp5 , BEST12.);
     %DMNORMIP( _ARBFMT_12);
    IF _ARBFMT_12 IN ('3' ) THEN DO;
      _ARBFMT_12 = PUT( GRP_MntWines , BEST12.);
       %DMNORMIP( _ARBFMT_12);
      IF _ARBFMT_12 IN ('3' ,'4' ) THEN DO;
        _NODE_  =                   22;
        _LEAF_  =                    6;
        P_DepVar0  =     0.51785714285714;
        P_DepVar1  =     0.48214285714285;
        Q_DepVar0  =     0.51785714285714;
        Q_DepVar1  =     0.48214285714285;
        V_DepVar0  =     0.58064516129032;
        V_DepVar1  =     0.41935483870967;
        I_DepVar  = '0' ;
        U_DepVar  =                    0;
        END;
      ELSE DO;
        _NODE_  =                   23;
        _LEAF_  =                    7;
        P_DepVar0  =     0.51785714285714;
        P_DepVar1  =     0.48214285714285;
        Q_DepVar0  =     0.51785714285714;
        Q_DepVar1  =     0.48214285714285;
        V_DepVar0  =     0.66666666666666;
        V_DepVar1  =     0.33333333333333;
        I_DepVar  = '0' ;
        U_DepVar  =                    0;
        END;
      END;
    ELSE DO;
      _NODE_  =                   13;
      _LEAF_  =                    8;
      P_DepVar0  =      0.9068710959682;
      P_DepVar1  =      0.0931289040318;
      Q_DepVar0  =      0.9068710959682;
      Q_DepVar1  =      0.0931289040318;
      V_DepVar0  =     0.95980707395498;
      V_DepVar1  =     0.04019292604501;
      I_DepVar  = '0' ;
      U_DepVar  =                    0;
      END;
    END;
  END;

****************************************************************;
******          END OF DECISION TREE SCORING CODE         ******;
****************************************************************;
drop _LEAF_;
