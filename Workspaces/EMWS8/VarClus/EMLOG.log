*------------------------------------------------------------*
User:                Lukas Fahr
Date:                19. April 2016
Time:                17.21 Uhr
Site:                70107571
Platform:            X64_7PRO
Maintenance Release: 9.03.01M2P081512
EM Version:          12.1
* 
MPRINT(EM_DIAGRAM):    data _null_;
MPRINT(EM_DIAGRAM):   call symput('NLDATE', strip(put(date(), NLDATE.)));
MPRINT(EM_DIAGRAM):   call symput('NLTIME', strip(put(datetime(), NLTIME.)));
MPRINT(EM_DIAGRAM):   run;
MPRINT(EM_DIAGRAM):   data _null_;
MPRINT(EM_DIAGRAM):   nldate= sasmsg("sashelp.dmine", "log_date_note", 'N', "19. April 2016" );
MPRINT(EM_DIAGRAM):   nltime= sasmsg("sashelp.dmine", "log_time_note", 'N', "17.21 Uhr" );
MPRINT(EM_DIAGRAM):   put "*------------------------------------------------------------*";
MPRINT(EM_DIAGRAM):   put "* Training Log";
MPRINT(EM_DIAGRAM):   put nldate;
MPRINT(EM_DIAGRAM):   put nltime;
MPRINT(EM_DIAGRAM):   put "*------------------------------------------------------------*";
MPRINT(EM_DIAGRAM):   run;
*------------------------------------------------------------*
* Training Log
Date:                19. April 2016
Time:                17.21 Uhr
*------------------------------------------------------------*
MPRINT(EM_DIAGRAM):    filename O0YALE9Y "C:\\predictive-models-project\Workspaces\EMWS8\VarClus\EMTRAIN.out" encoding="UTF-8" NOBOM;
MPRINT(EM_DIAGRAM):   proc printto print=O0YALE9Y new;
MPRINT(EM_DIAGRAM):   run;
MPRINT(EM_DIAGRAM):    filename _LOG "C:\\predictive-models-project\Workspaces\EMWS8\VarClus\EMLOG.log" encoding="UTF-8" NOBOM;
MPRINT(EM_DIAGRAM):    data _null_;
MPRINT(EM_DIAGRAM):   call symput('NLDATE', strip(put(date(), NLDATE.)));
MPRINT(EM_DIAGRAM):   call symput('NLTIME', strip(put(datetime(), NLTIME.)));
MPRINT(EM_DIAGRAM):   run;
MPRINT(EM_DIAGRAM):   data _null_;
MPRINT(EM_DIAGRAM):   nldate= sasmsg("sashelp.dmine", "log_date_note", 'N', "19. April 2016" );
MPRINT(EM_DIAGRAM):   nltime= sasmsg("sashelp.dmine", "log_time_note", 'N', "17.21 Uhr" );
MPRINT(EM_DIAGRAM):   file _LOG;
MPRINT(EM_DIAGRAM):   put "*------------------------------------------------------------*";
MPRINT(EM_DIAGRAM):   put "User:                Lukas Fahr";
MPRINT(EM_DIAGRAM):   put nldate;
MPRINT(EM_DIAGRAM):   put nltime;
MPRINT(EM_DIAGRAM):   put "Site:                70107571";
MPRINT(EM_DIAGRAM):   put "Platform:            X64_7PRO";
MPRINT(EM_DIAGRAM):   put "Maintenance Release: 9.03.01M2P081512";
MPRINT(EM_DIAGRAM):   put "EM Version:          12.1";
MPRINT(EM_DIAGRAM):   put "* ";
MPRINT(EM_DIAGRAM):   run;
MPRINT(EM_DIAGRAM):    filename _LOGIN "C:\\predictive-models-project\Workspaces\EMWS8\VarClus\EMTRAIN.log" encoding="UTF-8" NOBOM;
MPRINT(EM_COPYFILE):   data _null_;
MPRINT(EM_COPYFILE):   length line $20000;
MPRINT(EM_COPYFILE):   file _LOG MOD lrecl=20000;
MPRINT(EM_COPYFILE):   fid=fopen("_LOGIN",'i',20000,'v');
MPRINT(EM_COPYFILE):   if fid > 0 then do;
MPRINT(EM_COPYFILE):   do while(^fread(fid));
MPRINT(EM_COPYFILE):   rlen = frlen(fid);
MPRINT(EM_COPYFILE):   rc= fget(fid,line,20000);
MPRINT(EM_COPYFILE):   start = length(line)-length(left(line))+1;
MPRINT(EM_COPYFILE):   line=strip(line);
MPRINT(EM_COPYFILE):   put @start line;
MPRINT(EM_COPYFILE):   end;
MPRINT(EM_COPYFILE):   if fid > 0 then rc=fclose(fid);
MPRINT(EM_COPYFILE):   end;
MPRINT(EM_COPYFILE):   run;
MPRINT(EM_DIAGRAM):  ;
MPRINT(EM_DIAGRAM):   filename _LOGIN;
MPRINT(EM_DIAGRAM):    data _null_;
MPRINT(EM_DIAGRAM):   file _LOG mod;
MPRINT(EM_DIAGRAM):   put _page_;
MPRINT(EM_DIAGRAM):   run;
MPRINT(EM_DIAGRAM):   filename _LOGIN "C:\\predictive-models-project\Workspaces\EMWS8\VarClus\EMSCORE.log" encoding="UTF-8" NOBOM;
MPRINT(EM_DIAGRAM):  ;
MPRINT(EM_DIAGRAM):   data _null_;
MPRINT(EM_DIAGRAM):   file _LOG mod;
MPRINT(EM_DIAGRAM):   put _page_;
MPRINT(EM_DIAGRAM):   run;
MPRINT(EM_DIAGRAM):    filename _LOGIN "C:\\predictive-models-project\Workspaces\EMWS8\VarClus\EMREPORT.log" encoding="UTF-8" NOBOM;
MPRINT(EM_DIAGRAM):  ;
MPRINT(EM_DIAGRAM):   filename _LOGIN;
MPRINT(EM_DIAGRAM):    filename _LOG;
MPRINT(EM_DIAGRAM):    filename _OUT "C:\\predictive-models-project\Workspaces\EMWS8\VarClus\EMOUTPUT.out" encoding="UTF-8" NOBOM;
MPRINT(EM_DIAGRAM):    data _null_;
MPRINT(EM_DIAGRAM):   call symput('NLDATE', strip(put(date(), NLDATE.)));
MPRINT(EM_DIAGRAM):   call symput('NLTIME', strip(put(datetime(), NLTIME.)));
MPRINT(EM_DIAGRAM):   run;
MPRINT(EM_DIAGRAM):   data _null_;
MPRINT(EM_DIAGRAM):   nldate= sasmsg("sashelp.dmine", "log_date_note", 'N', "19. April 2016" );
MPRINT(EM_DIAGRAM):   nltime= sasmsg("sashelp.dmine", "log_time_note", 'N', "17.21 Uhr" );
MPRINT(EM_DIAGRAM):   file _OUT;
MPRINT(EM_DIAGRAM):   put "*------------------------------------------------------------*";
MPRINT(EM_DIAGRAM):   put "User:                Lukas Fahr";
MPRINT(EM_DIAGRAM):   put nldate;
MPRINT(EM_DIAGRAM):   put nltime;
MPRINT(EM_DIAGRAM):   put "*------------------------------------------------------------*";
MPRINT(EM_DIAGRAM):   put "* Training Output";
MPRINT(EM_DIAGRAM):   put "*------------------------------------------------------------*";
MPRINT(EM_DIAGRAM):   run;
MPRINT(EM_DIAGRAM):    filename _OUTIN "C:\\predictive-models-project\Workspaces\EMWS8\VarClus\EMTRAIN.out" encoding="UTF-8" NOBOM;
MPRINT(EM_DIAGRAM):   ;
MPRINT(EM_COPYFILE):   data _null_;
MPRINT(EM_COPYFILE):   length line $20000;
MPRINT(EM_COPYFILE):   file _OUT MOD lrecl=20000;
MPRINT(EM_COPYFILE):   fid=fopen("_OUTIN",'i',20000,'v');
MPRINT(EM_COPYFILE):   if fid > 0 then do;
MPRINT(EM_COPYFILE):   do while(^fread(fid));
MPRINT(EM_COPYFILE):   rlen = frlen(fid);
MPRINT(EM_COPYFILE):   rc= fget(fid,line,20000);
MPRINT(EM_COPYFILE):   start = length(line)-length(left(line))+1;
MPRINT(EM_COPYFILE):   line=strip(line);
MPRINT(EM_COPYFILE):   put @start line;
MPRINT(EM_COPYFILE):   end;
MPRINT(EM_COPYFILE):   if fid > 0 then rc=fclose(fid);
MPRINT(EM_COPYFILE):   end;
MPRINT(EM_COPYFILE):   run;
MPRINT(EM_DIAGRAM):  ;
MPRINT(EM_DIAGRAM):   filename _OUTIN;
MPRINT(EM_DIAGRAM):    data _null_;
MPRINT(EM_DIAGRAM):   file _OUT mod;
MPRINT(EM_DIAGRAM):   put _page_;
MPRINT(EM_DIAGRAM):   put // "*------------------------------------------------------------*";
MPRINT(EM_DIAGRAM):   put "* Score Output";
MPRINT(EM_DIAGRAM):   put "*------------------------------------------------------------*";
MPRINT(EM_DIAGRAM):   run;
MPRINT(EM_DIAGRAM):    filename _OUTIN "C:\\predictive-models-project\Workspaces\EMWS8\VarClus\EMSCORE.out" encoding="UTF-8" NOBOM;
MPRINT(EM_DIAGRAM):  ;
MPRINT(EM_DIAGRAM):   filename _OUTIN;
MPRINT(EM_DIAGRAM):    data _null_;
MPRINT(EM_DIAGRAM):   file _OUT mod;
MPRINT(EM_DIAGRAM):   put _page_;
MPRINT(EM_DIAGRAM):   put // "*------------------------------------------------------------*";
MPRINT(EM_DIAGRAM):   put "* Report Output";
MPRINT(EM_DIAGRAM):   put "*------------------------------------------------------------*";
MPRINT(EM_DIAGRAM):   run;
MPRINT(EM_DIAGRAM):    filename _OUTIN "C:\\predictive-models-project\Workspaces\EMWS8\VarClus\EMREPORT.out" encoding="UTF-8" NOBOM;
MPRINT(EM_DIAGRAM):  ;
MPRINT(EM_DIAGRAM):   filename _OUTIN;
MPRINT(EM_DIAGRAM):    filename _OUT;
MPRINT(EM_DIAGRAM):    filename _emtool_ 'C:\\predictive-models-project\Workspaces\EMWS8\VarClus\EMRUNSTATUS.xml' encoding="UTF-8" NOBOM;
96314      proc freq data=EMWS8.VarClus_VariableSet noprint;
MPRINT(EM_DIAGRAM):    proc freq data=EMWS8.VarClus_VariableSet noprint;
96315      table ROLE*LEVEL/out=WORK.VarClusMETA;
MPRINT(EM_DIAGRAM):   table ROLE*LEVEL/out=WORK.VarClusMETA;
96316      run;
MPRINT(EM_DIAGRAM):   run;
 
NOTE: There were 36 observations read from the data set EMWS8.VARCLUS_VARIABLESET.
NOTE: The data set WORK.VARCLUSMETA has 6 observations and 4 variables.
NOTE: PROCEDURE FREQ used (Total process time):
      real time           0.01 seconds
      cpu time            0.01 seconds
 
 
96317      proc print data=WORK.VarClusMETA label noobs;
MPRINT(EM_DIAGRAM):   proc print data=WORK.VarClusMETA label noobs;
96318      var ROLE LEVEL COUNT;
MPRINT(EM_DIAGRAM):   var ROLE LEVEL COUNT;
96319      label ROLE = "%sysfunc(sasmsg(sashelp.dmine, meta_role_vlabel, NOQUOTE))" LEVEL = "%sysfunc(sasmsg(sashelp.dmine, meta_level_vlabel, NOQUOTE))" COUNT = "%sysfunc(sasmsg(sashelp.dmine, rpt_count_vlabel, NOQUOTE))";
MPRINT(EM_DIAGRAM):   label ROLE = "Role" LEVEL = "Measurement Level" COUNT = "Frequency Count";
96320      title9 ' ';
MPRINT(EM_DIAGRAM):   title9 ' ';
96321      title10 "%sysfunc(sasmsg(sashelp.dmine, rpt_varSummary_title  , NOQUOTE))";
MPRINT(EM_DIAGRAM):   title10 "Variable Summary";
MPRINT(EM_DIAGRAM):   run;
96322      run;
 
NOTE: There were 6 observations read from the data set WORK.VARCLUSMETA.
NOTE: The PROCEDURE PRINT printed page 56.
NOTE: PROCEDURE PRINT used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
 
 
96323      title10;
MPRINT(EM_DIAGRAM):   title10;
96324      %let EMEXCEPTIONSTRING=;
MPRINT(EM_DIAGRAM):     *------------------------------------------------------------*;
MPRINT(EM_DIAGRAM):   * VarClus: Generation of macros and macro variables;
MPRINT(EM_DIAGRAM):   * To see the code generated, set the EM_DEBUG macro variable to SOURCE or _ALL_;
MPRINT(EM_DIAGRAM):   *------------------------------------------------------------*;
MPRINT(EM_DIAGRAM):   *------------------------------------------------------------*;
MPRINT(EM_DIAGRAM):   * VarClus: EM Macro Variables and Macros;
MPRINT(EM_DIAGRAM):   *------------------------------------------------------------*;
MPRINT(EM_DIAGRAM):   *------------------------------------------------------------* ;
MPRINT(EM_DIAGRAM):   * System Macro Variables;
MPRINT(EM_DIAGRAM):   *------------------------------------------------------------* ;
MPRINT(EM_DIAGRAM):   data _null_;
MPRINT(EM_DIAGRAM):   length string $2000;
MPRINT(EM_DIAGRAM):   string = 'Tugas';
MPRINT(EM_DIAGRAM):   call symput('EM_PROJECTNAME', trim(string));
MPRINT(EM_DIAGRAM):   string = 'Predictive Models';
MPRINT(EM_DIAGRAM):   call symput('EM_WSNAME', trim(string));
MPRINT(EM_DIAGRAM):   run;
MPRINT(EM_DIAGRAM):   *------------------------------------------------------------* ;
MPRINT(EM_DIAGRAM):   * Properties Macro Variables ;
MPRINT(EM_DIAGRAM):   *------------------------------------------------------------* ;
MPRINT(EM_DIAGRAM):   *------------------------------------------------------------*;
MPRINT(EM_DIAGRAM):   * Files Macro Variables;
MPRINT(EM_DIAGRAM):   *------------------------------------------------------------*;
MPRINT(EM_DIAGRAM):   *------------------------------------------------------------*;
MPRINT(EM_DIAGRAM):   * Import Macro Variables;
MPRINT(EM_DIAGRAM):   *------------------------------------------------------------*;
MPRINT(EM_DIAGRAM):   *------------------------------------------------------------*;
MPRINT(EM_DIAGRAM):   * Export Macro Variables;
MPRINT(EM_DIAGRAM):   *------------------------------------------------------------*;
MPRINT(EM_DIAGRAM):   *------------------------------------------------------------*;
MPRINT(EM_DIAGRAM):   * Decision Macro Variables;
MPRINT(EM_DIAGRAM):   *------------------------------------------------------------*;
MPRINT(EM_DIAGRAM):   *------------------------------------------------------------*;
MPRINT(EM_DIAGRAM):   * Statement Macro Variables;
MPRINT(EM_DIAGRAM):   *------------------------------------------------------------*;
MPRINT(EM_DIAGRAM):   data _null_;
MPRINT(EM_DIAGRAM):   set EMWS8.FIMPORT_EMINFO;
MPRINT(EM_DIAGRAM):   where key in('HPDMSAMPLE', 'IDSTABLE');
MPRINT(EM_DIAGRAM):   if key = 'HPDMSAMPLE' then call symput('_ForceGrid', '1');
MPRINT(EM_DIAGRAM):   else call symput('_IDS_TABLE', DATA);
MPRINT(EM_DIAGRAM):   run;
MPRINT(HPDM_PERFORMANCE):  ;
PERFORMANCE  DETAILS
MPRINT(EM_DIAGRAM):  ;
MPRINT(EM_DIAGRAM):   *------------------------------------------------------------*;
MPRINT(EM_DIAGRAM):   * Variable Macros;
MPRINT(EM_DIAGRAM):   *------------------------------------------------------------*;
MPRINT(EM_DIAGRAM):   *------------------------------------------------------------*;
MPRINT(EM_DIAGRAM):   * General Variable Macros;
MPRINT(EM_DIAGRAM):   *------------------------------------------------------------*;
MPRINT(EM_DIAGRAM):   *------------------------------------------------------------*;
MPRINT(EM_DIAGRAM):   * Target Variable Macros;
MPRINT(EM_DIAGRAM):   *------------------------------------------------------------*;
MPRINT(EM_DIAGRAM):   *------------------------------------------------------------*;
MPRINT(EM_DIAGRAM):   * Input Variable Macros;
MPRINT(EM_DIAGRAM):   *------------------------------------------------------------*;
MPRINT(EM_DIAGRAM):   *------------------------------------------------------------*;
MPRINT(EM_DIAGRAM):   * Rejected Variable Macros;
MPRINT(EM_DIAGRAM):   *------------------------------------------------------------*;
MPRINT(EM_DIAGRAM):   *------------------------------------------------------------*;
MPRINT(EM_DIAGRAM):   * Misc Variable Macros;
MPRINT(EM_DIAGRAM):   *------------------------------------------------------------*;
MPRINT(EM_DIAGRAM):   *------------------------------------------------------------*;
MPRINT(EM_DIAGRAM):   * End Create EM Macro Variables and Macros;
MPRINT(EM_DIAGRAM):   *------------------------------------------------------------*;
96700      *------------------------------------------------------------*;
MPRINT(EM_DIAGRAM):    *------------------------------------------------------------*;
96701      * VarClus: Generation of macros and macro variables;
MPRINT(EM_DIAGRAM):   * VarClus: Generation of macros and macro variables;
96702      * To see the code generated, set the EM_DEBUG macro variable to SOURCE or _ALL_;
MPRINT(EM_DIAGRAM):   * To see the code generated, set the EM_DEBUG macro variable to SOURCE or _ALL_;
96703      *------------------------------------------------------------*;
MPRINT(EM_DIAGRAM):   *------------------------------------------------------------*;
 
96704      %let EMEXCEPTIONSTRING=;
96705      *------------------------------------------------------------*;
MPRINT(EM_DIAGRAM):    *------------------------------------------------------------*;
96706      * TRAIN: VarClus;
MPRINT(EM_DIAGRAM):   * TRAIN: VarClus;
96707      *------------------------------------------------------------*;
MPRINT(EM_DIAGRAM):   *------------------------------------------------------------*;
96708      %let EM_ACTION = TRAIN;
96709      %let syscc = 0;
96710
96711      %macro main;
96712
96713         filename temp catalog 'sashelp.emexpl.variableclustering_macros.source';
96714         %include temp;
96715         filename temp catalog 'sashelp.emexpl.variableclustering_macros2.source';
96716         %include temp;
96717         filename temp;
96718
96719        %SetProperties;
96720
96721         %if %upcase(&EM_ACTION) = CREATE %then %do;
96722             filename temp catalog 'sashelp.emexpl.variableclustering_create.source';
96723             %include temp;
96724             filename temp;
96725             %create;
96726         %end;
96727         %else
96728         %if %upcase(&EM_ACTION) = TRAIN %then %do;
96729              filename temp catalog 'sashelp.emexpl.variableclustering_train.source';
96730                 %include temp;
96731                 filename temp;
96732                 %train;
96733         %end;
96734         %else
96735         %if %upcase(&EM_ACTION) = SCORE %then %do;
96736                 filename temp catalog 'sashelp.emexpl.variableclustering_score.source';
96737                 %include temp;
96738                 filename temp;
96739                 %score;
96740         %end;
96741         %else
96742         %if %upcase(&EM_ACTION) = REPORT %then %do;
96743                 filename temp catalog 'sashelp.emexpl.variableclustering_report.source';
96744                 %include temp;
96745                 filename temp;
96746                 %report;
96747         %end;
96748         /*
96749         %if %upcase(&EM_ACTION) = OPENTESTTABLE %then %do;
96750             %put 'OPENING TABLE';
96751         %end;
96752         %if %upcase(&EM_ACTION) = CLOSETESTTABLE %then %do;
96753             %put 'CLOSE TABLE';
96754         %end;
96755         */
96756      %mend main;
96757      %main;
MPRINT(EM_DIAGRAM):
MPRINT(MAIN):   filename temp catalog 'sashelp.emexpl.variableclustering_macros.source';
NOTE: %INCLUDE (level 1) file TEMP is file SASHELP.EMEXPL.VARIABLECLUSTERING_MACROS.SOURCE.
96759     +/* Initialize property macro variables */
96760     +%macro SetProperties;
96761     +   %em_checkmacro(name=EM_PROPERTY_MAXCLUS,       global=Y, value=DEFAULT);
96762     +   %em_checkmacro(name=EM_PROPERTY_HIDEVARIABLE,  global=Y, value=Y);
96763     +   %em_checkmacro(name=EM_PROPERTY_PRINTOPTION,   global=Y, value=SHORT);
96764     +   %em_checkmacro(name=EM_PROPERTY_CLUSSOURCE,    global=Y, value=CORR);
96765     +   %em_checkmacro(name=EM_PROPERTY_CLUSCOMP,      global=Y, value=PRINCIPAL);
96766     +   %em_checkmacro(name=EM_PROPERTY_CLUSHIERACHY,      global=Y, value=Y);
96767     +   %em_checkmacro(name=EM_PROPERTY_INCLUDECLASSVAR,      global=Y, value=N);
96768     +   %em_checkmacro(name=EM_PROPERTY_EXPORTEDCOMP,      global=Y, value=CLUSTERCOMP);
96769     +   %em_checkmacro(name=EM_PROPERTY_MAXEIGEN,         global=Y, value=DEFAULT);
96770     +   %em_checkmacro(name=EM_PROPERTY_PROPORTION,      global=Y, value=DEFAULT);
96771     +   %em_checkmacro(name=EM_PROPERTY_PRINTOPTION,      global=Y, value=SHORT);
96772     +   %em_checkmacro(name=EM_PROPERTY_TWOSTAGECLUS,      global=Y, value=AUTO);
96773     +   %em_checkmacro(name=EM_PROPERTY_SUPPRESSSAMPWARN,      global=Y, value=N);
96775     +%mend SetProperties;
96777     +%Macro MakeDummyVariables(indata=,
96778     +                          outvar=,
96779     +                          outdata=,
96780     +                          fileref=,
96781     +                          recreatecmeta=N, /* optional */
96782     +                          incmeta=,     /* optional */
96783     +                          outcmeta=,    /* optional */
96784     +                          ndummyvars=_ndummyvars
96785     +                          );
96786     +    %global &ndummyvars;
96788     +    proc dmdb batch data=&indata out=_dmdbdat dmdbcat=_dmdbcat classout=_classout;;
96789     +       class
96790     +       %EM_BINARY_INPUT %EM_NOMINAL_INPUT %EM_ORDINAL_INPUT
96791     +       %EM_BINARY_REJECTED %EM_NOMINAL_REJECTED %EM_ORDINAL_REJECTED
96792     +    ;
96793     +    run;
96794     +    %let &ndummyvars = 0;
96795     +    data _null_;
96796     +    %let dsid = %sysfunc(open(work._classout));
96797     +      %let &ndummyvars = %sysfunc(attrn(&dsid, NOBS));
96798     +    %let dsid = %sysfunc(close(&dsid));
96799     +    run;
96801     +    proc dmzip data=_dmdbdat dmdbcat=_dmdbcat;
96802     +       input
96803     +       %EM_BINARY_INPUT %EM_NOMINAL_INPUT %EM_ORDINAL_INPUT
96804     +       %EM_BINARY_REJECTED %EM_NOMINAL_REJECTED %EM_ORDINAL_REJECTED
96805     +        / level=nominal stdize=no;
96806     +       make outvar = &outvar;
96807     +       score data = &indata out =&outdata;
96808     +       code  file=  "&fileref";
96809     +    run;
96810     +    %if &recreatecmeta eq Y %then %do;
96811     +    proc contents data =&outvar out=_tmpds(keep=NAME LABEL);
96812     +    data _tmpds;
96813     +        set _tmpds;
96814     +           ROLE = 'INPUT';
96815     +           LEVEL = 'INTERVAL';
96816     +           CREATOR='DMZIP';
96817     +           if NAME = '_TYPE_' then delete;
96818     +    run;
96819     +    data &outcmeta;
96820     +         set &incmeta _tmpds;
96821     +    run;
96822     +    %end;
96823     +    proc datasets lib=work nolist;
96824     +      delete  _dmdbdat _dmdbcat _classout
96825     +    %if &recreatecmeta eq Y %then %do;
96826     +    _tmpds
96827     +    %end;
96828     +    ;
96829     +    quit;
96830     +%Mend MakeDummyVariables;
96832     +/*--- Determine Optimal Number of Cluster ----
96833     +%macro FindClusNum(statds=, groupds=, minvariation=);
96834     +   %global optnclus;
96835     +   data varclus_tmp(drop=_NAME_);
96836     +      set &statDs;
96837     +      where _type_ ='PROPOR';
96838     +   run;
96839     +   proc sort data=varclus_tmp;
96840     +      by _NCL_;
96841     +   run;
96842     +   proc transpose data=varclus_tmp out=varclus_tmp;
96843     +      by _NCL_;
96844     +      var %EM_INTERVAL_INPUT
96845     +      %if &EM_PROPERTY_INCLUDECLASSVAR eq Y %then %do;
96846     +      %let dsid = %sysfunc(open(&EM_USER_OUTDUMMY));
96847     +      %let nvar = %sysfunc(attrn(&dsid, NVAR));
96848     +          %do i = 2 %to &nvar;
96849     +          %let varname = %sysfunc(varname(&dsid, &i));
96850     +          &varname
96851     +          %end;
96852     +      %end;
96853     +   ;
96854     +   run;
96856     +   %if &minVariation eq %then %do;
96857     +       %let minVariation = &EM_PROPERTY_MINVARIATION;
96858     +   %end;
96859     +   %if ^(0<&minVariation<100) %then %do;
96860     +       %let minVariation = 90;
96861     +   %end;
96863     +   data _null_;
96864     +      set varclus_tmp end=eof;
96865     +      by _NCL_;
96866     +      retain flag 0;
96867     +      if first._ncl_ then flag=0;
96868     +      if .<col1 < &minVariation then flag=1;
96869     +      if last._ncl_ and ^flag then do;
96870     +         call symput('OPTNCL', _ncl_);
96871     +         stop;
96872     +      end;
96873     +     if eof then call symput('OPTNCL', _ncl_);
96874     +   run;
96876     +   %let optnclus = &OPTNCL;
96878     +   data varclus_tmp(drop=_NCL_ _NAME_);
96879     +      set &statDs;
96880     +      where _type_ in('RSQUARED' 'GROUP') and _NCL_=&OPTNCL;
96881     +   run;
96882     +   proc sort data=varclus_tmp;
96883     +      by _TYPE_;
96884     +   run;
96885     +   proc transpose data=varclus_tmp out=varclus_tmp;
96886     +      by _TYPE_;
96887     +   run;
96888     +   proc sort data=varclus_tmp;
96889     +      by _name_ _type_;
96890     +   run;
96892     +  proc transpose data=varclus_tmp out=&groupds;
96893     +      by _NAME_;
96894     +   run;
96895     +   proc sort data=&groupDs(rename=(col1=Cluster col2=Rsquare _NAME_=VARIABLE));
96896     +      by Cluster descending Rsquare;
96897     +      where Cluster ne 0;
96898     +   run;
96899     +   proc datasets lib=work nolist mt=(DATA VIEW);
96900     +      delete varclus_tmp;
96901     +   run;
96902     +   quit;
96903     +%mend findClusNum;
96904     +*/
96906     +%macro getNclusfromTrain(inoutstat=, nc=);
96907     +%global &nc;
96908     +data _null_;
96909     +    set &inoutstat end=eof;
96910     +    if eof then do;
96911     +    call symput("&nc", _ncl_);
96912     +    end;
96913     +run;
96914     +%mend  getNclusfromTrain;
96916     +%macro MakeDeltaCode(groupds=, outstatscore=, deltacodefile=);
96918     +     *--- Build Code to Modify Metadata ---*;
96919     +     filename X "&deltacodefile";
96920     +     data _null_;
96921     +        FILE X;
96922     +        set &groupds end=eof;
96923     +        /*by Cluster;*/
96924     +         if _N_=1 then do;
96925     +           %if &EM_PROPERTY_INCLUDECLASSVAR eq Y %then %do;
96926     +            put "if upcase(strip(ROLE)) ='INPUT' and upcase(strip(LEVEL)) ^='INTERVAL' then ROLE ='REJECTED' ;";
96927     +           %end;
96928     +           put "if upcase(strip(ROLE))='INPUT' and upcase(strip(LEVEL))='INTERVAL' then do;";
96929     +           put "if upcase(strip(NAME)) in (";
96930     +        end;
96931     +        if Strip(upcase(Selected)) eq 'YES' then do;
The SAS System
 
96932     +           string = '"'!!trim(left(VARIABLE))!!'"';
96933     +           put string;
96934     +        end;
96935     +        if eof then do;
96936     +           put ') then ROLE="INPUT";';
96937     +           put 'else ROLE="REJECTED";';
96938     +           put 'end;';
96940     +           %if %upcase(&EM_PROPERTY_HIDEVARIABLE) eq Y %then %do;
96941     +             put 'if upcase(strip(ROLE)) = "REJECTED" then delete ;';
96942     +           %end;
96943     +        end;
96944     +     run;
96945     +     quit;
96947     +     filename X;
96949     +     quit;
96950     +%mend MakeDeltaCode;
96952     +%macro MakeVarClusCorrData(statds=, corrds=, corrplotds= );
96953     +    %if ^%sysfunc(exist(&statds)) %then %do;
96954     +         %goto doendc;
96955     +    %end;
96957     +    data &corrds(drop=_TYPE_ _NCL_) ;
96958     +       set &statds;
96959     +       where _type_ eq 'CORR' ;
96960     +    run ;
96961     +    proc sort data=&corrds;
96962     +       by _NAME_ ;
96963     +    run ;
96964     +    proc transpose data=&corrds out=&corrplotds name=_TMP_;
96965     +      BY _NAME_ ;
96966     +    run ;
96967     +    data &corrplotds;
96968     +       length _Y_ $100;
96969     +       set &corrplotDs;
96970     +       if _LABEL_ ne '' then _Y_=_LABEL_ ; else _Y_=_TMP_ ;
96971     +    run ;
96972     +    data varclus_match(rename=(_TMP_= _NAME_ _LABEL_=_X_));
96973     +       set &corrplotds;
96974     +       where _LABEL_ ne '' ;
96975     +       keep _TMP_ _LABEL_ ;
96976     +    run ;
96977     +    data _null_;
96978     +       nobs=0;
96979     +       dsid = open('varclus_match');
96980     +       if dsid then do;
96981     +          nobs = attrn(dsid, 'NOBS');
96982     +          dsid = close(dsid);
96983     +       end;
96984     +       call symput ('CORR_NOBS', nobs);
96985     +    run;
96986     +    %if &corr_nobs %then %do;
96987     +        proc sort data=varclus_match;
96988     +           by _name_;
96989     +        run ;
96990     +        proc sort data=&corrplotds;
96991     +           by _name_;
96992     +        run ;
96993     +        data &corrplotds(keep= _X_ _Y_ col1 rename=(col1=Correlation)) ;
96994     +           merge varclus_match &corrplotds;
96995     +           by _NAME_ ;
96996     +           if _X_ eq '' then _X_=_NAME_ ;
96997     +           label _X_ = "%sysfunc(sasmsg(sashelp.dmine, rpt_varclus_label_variable, noquote))";
96998     +           label _Y_ = "%sysfunc(sasmsg(sashelp.dmine, rpt_varclus_label_variable, noquote))";
96999     +           label col1 = "%sysfunc(sasmsg(sashelp.dmine, rpt_correlation_vlabel, noquote))";
97001     +       run ;
97002     +    %end;
97003     +    %else %do;
97004     +        proc sort data=&corrplotds;
97005     +           by _name_;
97006     +        run ;
97007     +        data &corrplotds(keep= _NAME_ _Y_ col1 rename=(_NAME_=_X_ col1=Correlation)) ;
97008     +           set &corrplotds;
97009     +           label _NAME_ = "%sysfunc(sasmsg(sashelp.dmine, rpt_varclus_label_variable, noquote))" ;
97010     +           label _Y_ = "%sysfunc(sasmsg(sashelp.dmine, rpt_varclus_label_variable, noquote))" ;
97011     +           label col1 = "%sysfunc(sasmsg(sashelp.dmine, rpt_correlation_vlabel, noquote))";
97013     +        run ;
97014     +    %end;
97015     +    proc sort data=&corrplotds;
97016     +       by _X_ _Y_;
97017     +    run ;
97018     +    proc datasets lib=work nolist mt=(DATA VIEW);
97019     +       delete varclus_match;
97020     +    run;
97021     +    quit;
97023     +%doendc:
97025     +%mend MakeVarClusCorrData;
97027     +%macro MakeStatPlotData(statds= , outstatplotds=);
97028     +   %if %sysfunc(exist(&statds)) %then %do;
97030     +       data varclus_tmp(drop=_NAME_ _NCL_) ;
97031     +          set &statDs;
97032     +          where _type_ in('MEAN', 'STD', 'N');
97033     +       run ;
97034     +       proc transpose data=varclus_tmp out=&outstatplotds;
97035     +          id _TYPE_ ;
97036     +       run ;
97037     +       data &outstatplotds;
97038     +          set &outstatplotds(obs=1000);
97039     +          label _name_= "%sysfunc(sasmsg(sashelp.dmine, rpt_varclus_label_name, noquote))";
97040     +          label _label_="%sysfunc(sasmsg(sashelp.dmine, rpt_varclus_label_label, noquote))" ;
97041     +          if MEAN ne 0 then SCALEDSTD= STD / MEAN ;
97042     +          else SCALEDSTD= STD ;
97043     +          label SCALEDSTD = "%sysfunc(sasmsg(sashelp.dmine, rpt_varclus_label_scaledstd, noquote))";
97044     +       run ;
97045     +       proc sort data=&outstatplotds;
97046     +          by descending SCALEDSTD ;
97047     +       run ;
97048     +       proc datasets lib=work nolist mt=(DATA VIEW);
97049     +          delete varclus_tmp;
97050     +       run;
97051     +       quit;
97052     +    %end;
97054     +%mend MakeStatPlotData;
97057     +%macro CreateScoreCode(indata=, ncluscomp=, fileref=);
97058     +     %EM_GETNAME(KEY=OUTSTATSCORE, type=DATA);
97059     +    data &EM_USER_OUTSTATSCORE;
97060     +          set &indata;
97061     +          if (_TYPE_ in ('SCORE' 'MEAN' 'STD') and _NCL_ = &ncluscomp ) or (_TYPE_ in ('MEAN' 'STD'));
97062     +          if _TYPE_ = 'MEAN' then _NAME_='MEAN';
97063     +          if _TYPE_ = 'STD' then _NAME_='STD';
97064     +          DROP _TYPE_ _NCL_;
97065     +     run;
97067     +     filename _file_  "&fileRef";
97069     +     data _null_;
97070     +        FILE _file_ MOD;
97071     +        put ' ';
97072     +        put '/*-------------------------------------------------*/';
97073     +        put '/* ' "%sysfunc(sasmsg(sashelp.dmine, rpt_varclus_score_title_begin , noquote))" '*/';
97074     +        put '/*-------------------------------------------------*/';
97075     +        put ' ';
97076     +        %let dsid = %sysfunc(open(&EM_USER_OUTSTATSCORE));
97078     +        %let nvar = %sysfunc(attrn(&dsid, NVAR));
97079     +        %let vn_name =%sysfunc(varnum(&dsid, _NAME_));
97081     +        %let k = 1;
97082     +        %do %while(^%sysfunc(fetch(&dsid)));
97083     +                %let _name = %sysfunc(getvarc(&dsid, &vn_name));
97084     +                %if &k > 2 %then %do;
97085     +                 %let cn = %eval(&k-2);
97086     +                 put "&_name = 0 ; /*---" "%sysfunc(sasmsg(sashelp.dmine, rpt_varclus_score_cluscompnum, noquote, &cn))"  "------ */";
97087     +                %end;
97088     +                %let k = %eval(&k+1);
97089     +        %end;
97091     +        %let rc = %sysfunc(rewind(&dsid));
97093     +        %do i= 2 %to &nvar;
97094     +            %let _varname =  %sysfunc(varname(&dsid, &i));
97095     +            %do %while(^%sysfunc(fetch(&dsid)));
97096     +                %let _name = %sysfunc(getvarc(&dsid, &vn_name));
97097     +                %if &_name = MEAN %then
97098     +                %let _mean = %sysfunc(getvarn(&dsid, &i));
97099     +                %else %if &_name = STD %then
97100     +                %let _std = %sysfunc(getvarn(&dsid, &i));
97101     +                %else %do;
97102     +                      %let coeff =  %sysfunc(getvarn(&dsid, &i));
97103     +                      %let abscoeff = %sysfunc(abs(&coeff));
97104     +                          %if &abscoeff >  0 %then %do;
97105     +                       put "&_name = &_name+&coeff * (&_varname - &_mean)/&_std;";
97106     +                           %end;
97107     +                 %end;
97108     +             %end;
97109     +             %let rc = %sysfunc(rewind(&dsid));
97110     +         %end;
97112     +        %let dsid= %sysfunc(close(&dsid));
97113     +       run;
97114     +%mend CreateScoreCode;
97118     +/*----------------------------------------------------------
97119     +    Instead of using %MakeRSquareData,
97120     +    %MakeVarClusResultTable at macro2.source is used
97121     + +----------------------------------------------------------*/
97124     +%macro MakeRSquareData(indata=, inClusRSquare=, outdata=, ncluster=);
97126     +/* modifying  from ods rsquare = data */
97128     +data &outdata(drop= ControlVar  NumberOfClusters CurrentCluster);
97129     +    Length Cluster $16;
97130     +    length Variable $32;
97131     +    Length VariableLabel $64;
97132     +    set &indata; retain CurrentCluster;
97133     +    if NumberOfClusters ^= &ncluster then delete;
97134     +    if strip(Cluster) eq '' then Cluster = CurrentCluster;
97135     +    CurrentCluster = Cluster;
97136     +   run;
97137     +proc sort data =&outdata ;
97138     +     by Cluster RsquareRatio;
97139     +run;
97140     +data _tmprsq(drop=index);
97141     +     set &outdata; by Cluster;
97142     +     if first.Cluster then do;
97143     +     index = strip(scan(Cluster,2 ));
97144     +     Variable = "Clus"||index;
97145     +     VariableLabel = "Cluster Component "||index;
97146     +     OwnCluster = 1;
97147     +     NextClosest = .;
97148     +     RsquareRatio = 0;
97149     +     output;
97150     +     end;
97151     +run;
97153     +proc sort data = _tmprsq ;
97154     +     by Cluster RsquareRatio;
97155     +run;
97156     +data &outdata;
97157     +     set &outdata _tmprsq;
97158     +by Cluster;
97159     +run;
97162     +/* Just create the Selected variable with all YES */
97164     +data &outdata;
97165     +    set &outdata; by cluster;
97166     +    length Selected $8;
97167     +    Selected = 'YES';
97168     +    label  OwnCluster = 'R-Sqaure with Cluster Component';
97169     +    label  NextClosest = 'R-Sqaure with Next Cluster Component';
97170     +    rename OwnCluster = RSqWithClusterComp;
97171     +    rename NextClosest = RSqWithNextClusComp;
97172     +run;
97175     +/* Selected = Y/N will be done %score section -----
97177     +%if &EM_PROPERTY_EXPORTEDCOMP ne CLUSTERCOMP %then %do;
97178     +data &outdata;
97179     +    set &outdata; by cluster;
97180     +    length Selected $8;
97181     +    if first.Cluster then Selected = 'YES';
97182     +    else Selected = 'NO';
97183     +    label  OwnCluster = 'R-Sqaure with Cluster Component';
97184     +    label  NextClosest = 'R-Sqaure with Next Cluster Component';
97185     +    rename OwnCluster = RSqWithClusterComp;
97186     +    rename NextClosest = RSqWithNextClusComp;
97187     +run;
97188     +%end;
97189     +%else %do;
97190     +data &outdata;
97191     +    set &outdata; by cluster;
97192     +    if last.Cluster then Selected = 'YES';
97193     +    else Selected = 'NO';
97194     +    label  OwnCluster = 'R-Sqaure with Cluster Component';
97195     +    label  NextClosest = 'R-Sqaure with Next Cluster Component';
97196     +    rename OwnCluster = RSqWithClusterComp;
97197     +    rename NextClosest = RSqWithNextClusComp;
97198     +run;
97199     +%end;
97200     +---------------------------------------------------------------*/
97202     +%if %sysfunc(exist(&inClusRSquare)) %then %do;
97203     +/* to calculate NextClosestClusRsq */
97204     +proc transpose data = &inClusRSquare  out=_clusRsq;
97205     +      by cluster;
97206     +      run;
97207     +data _clusRsq;
97208     +     set _clusRsq;
97209     +     if strip(upcase(Cluster)) eq strip(upcase(_NAME_)) then delete;
97210     +run;
97212     +proc sort data=_clusRsq;
97213     +    by cluster col1;
97214     +    run;
97215     +data _clusRsq(drop=_NAME_ _LABEL_);
97216     +     set _clusRsq; by cluster;
97217     +     if last.Cluster then output;
97218     +     label  COL1 = 'R-Sqaure with Next Cluster Component';
97219     +     rename COL1 = RSqWithNextClusComp;
97220     +     rename Cluster = Variable;
97221     +     label  Cluster = "Variable";
97222     +run;
97224     +proc sort data =&outdata;
97225     +     by Variable;
97226     +run;
97227     +data &outdata;
97228     +    merge &outdata _clusRsq;
97229     +    by Variable;
97230     +run;
97231     +proc sort data =&outdata;
97232     +by Cluster  RsquareRatio;
97233     +run;
97234     +quit;
97235     +%end;
97237     +proc datasets lib = work nolist;
97238     +     delete _tmprsq _clusRsq;
97239     +     run;
97240     +quit;
97242     +%mend MakeRSquareData;
97245     +/*-------------------------------------------------------------------------*/
97249     +%macro ModifyCorr(indata=,
97250     +                  outdata=,
97251     +                  rsquare = Y
97252     +                  );
97253     +    data corr_tmp;
97254     +        set &indata;
97255     +    run;
97256     +     proc sql;
97257     +           update &indata
97258     +           set
97259     +     %let dsid = %sysfunc(open(work.corr_tmp));
97260     +     %let nvar = %sysfunc(attrn(&dsid, NVAR));
97261     +          %do i = 4 %to &nvar;
97262     +          %let _name = %sysfunc(varname(&dsid, &i));
97263     +             %if &rsquare eq Y %then %let _name_md = &_name.**2;
97264     +            %else  %let _name_md = &_name;
97265     +            %if &i < &nvar %then %do;
97266     +               &_name = 1- &_name_md ,
97267     +            %end;
97268     +            %else %do;
97269     +               &_name = &_name_md where _TYPE_ contains 'CORR' ;
97270     +            %end;
97271     +          %end;
97272     +      %let dsid= %sysfunc(close(&dsid));
97274     +      select * from &indata;
97275     +      run;
97276     +      proc datasets lib = work nolist;
97277     +           delete corr_tmp;
97278     +      run;
97279     +      quit;
97281     + %mend ModifyCorr;
97283     + %macro MakeClusStructCorrData(indata=,outdata=, ncluster=, Rsquare=N);
97284     +    data &outdata(drop= _NCL_  _TYPE_);
97285     +       set &indata;
97286     +       if ^(strip(_NCL_) eq &ncluster and strip(_TYPE_) eq 'STRUCTUR') then delete;
97287     +       rename _NAME_ = Cluster;
97288     +       label _NAME_ = "%sysfunc(sasmsg(sashelp.dmine, rpt_varclus_label_clustername,  noquote))";
97289     +    run;
97290     +    %if &RSquare eq Y %then %do;
97291     +     data corr_tmp;
97292     +        set &outdata;
97293     +     run;
97295     +     data &outdata(drop=i);
97296     +          set &outdata;
97297     +          %let dsid = %sysfunc(open(work.corr_tmp));
97298     +          %let nvar = %sysfunc(attrn(&dsid, NVAR));
97299     +          %do i = 2 %to &nvar;
97300     +            %let _name = %sysfunc(varname(&dsid, &i));
97301     +            %let _name_md = &_name.**2;
97302     +                &_name = &_name_md;
97303     +          %end;
97304     +      %let dsid= %sysfunc(close(&dsid));
97305     +      run;
97306     +      proc datasets lib = work nolist;
97307     +           delete corr_tmp;
97308     +      run;
97310     +    %end;
97311     +     quit;
97312     +%mend MakeClusStructCorrData;
97314     +%macro MakeInterClusCorrData(indata=, outdata=, ncluster=, RSquare=N, makeplotds=N, plotds=);
97315     +    data &outdata(drop= _NCL_  _TYPE_);
97316     +       set &indata;
97317     +       if ^(strip(_NCL_) eq &ncluster and strip(_TYPE_) eq 'CCORR') then delete;
97318     +       rename _NAME_ = Cluster;
97319     +       label _NAME_ = "%sysfunc(sasmsg(sashelp.dmine, rpt_varclus_label_clustername,  noquote))";
97320     +    run;
97321     +    data corr_tmp;
97322     +        set &outdata;
97323     +    run;
97325     +    %let dsid = %sysfunc(open(work.corr_tmp));
97326     +    %let nclus2= %eval(&ncluster+1);
97327     +    data &outdata;
97328     +         set &outdata;
97329     +          %do i = 2 %to &nclus2;
97330     +          %let i_1 = %eval(&i-1);
97331     +            %let _name = %sysfunc(varname(&dsid, &i));
97332     +            %let _newName = Clus&i_1;
97333     +                rename &_name = &_newName; ;
97334     +                *label &_name ="Cluster &i_1";
97335     +                label &_name = "%sysfunc(sasmsg(sashelp.dmine, rpt_varclus_label_clusternum, noquote,  &i_1))";
97336     +          %end;
97337     +          keep Cluster
97338     +          %do i = 2 %to &nclus2;
97339     +                %let _name = %sysfunc(varname(&dsid, &i));
97340     +                &_name
97341     +          %end;
97342     +          ;
97343     +    %let dsid= %sysfunc(close(&dsid));
97344     +     run;
97345     +     quit;
97347     +    %if &RSquare eq Y %then %do;
97349     +       data corr_tmp;
97350     +        set &outdata;
97351     +     run;
97353     +     data &outdata(drop=i);
97354     +          set &outdata;
97355     +          %let dsid = %sysfunc(open(work.corr_tmp));
97356     +          %let nvar = %sysfunc(attrn(&dsid, NVAR));
97357     +          %do i = 2 %to &nvar;
97358     +            %let _name = %sysfunc(varname(&dsid, &i));
97359     +            %let _name_md = &_name.**2;
97360     +                &_name = &_name_md;
97361     +          %end;
97362     +      %let dsid= %sysfunc(close(&dsid));
97363     +      run;
97364     +    %end;
97366     +    %if &makeplotds eq Y %then %do;
97367     +     proc transpose data = &outdata
97368     +          out=&plotds(drop=_LABEL_ rename=(_NAME_ = Y Cluster=X Col1= Correlation));
97369     +          by cluster;
97370     +     run;
97371     +     data &plotds;
97372     +          set  &plotds;
97373     +          label x="%sysfunc(sasmsg(sashelp.dmine, rpt_varclus_label_cluster, noquote))";
97374     +          label Y="%sysfunc(sasmsg(sashelp.dmine, rpt_varclus_label_cluster, noquote))";
97375     +     run;
97376     +     %end;
97377     +     proc datasets lib = work nolist;
97378     +           delete corr_tmp;
97379     +     run;
97380     +     quit;
97381     +%mend MakeInterClusCorrData;
97384     +%macro MakeClusConstellData(indata=, outlink=, outnode=);
97386     +data &outlink(drop = Selected);
97387     +     set &indata;
97388     +     LINKID = _N_;
97389     +     label LINKID = "%sysfunc(sasmsg(sashelp.dmine, rpt_varclus_label_linkid,  noquote))";
97390     +     if strip(upcase(Cluster)) eq strip(upcase(Variable)) then Variable = ClosestCluster;
97391     +run;
97392     +data &outnode(keep=NODEID TYPE LABEL);
97393     +    set &indata;
97394     +    length TYPE $16;
97395     +    rename Variable = NODEID;
97396     +    label  Variable= "%sysfunc(sasmsg(sashelp.dmine, rpt_varclus_label_nodeidvar, noquote))";
97397     +    if strip(upcase(Cluster)) eq strip(upcase(Variable))
97398     +    then  TYPE = "CLUSTER";
97399     +    else  TYPE="VARIABLE";
97400     +    label TYPE = "%sysfunc(sasmsg(sashelp.dmine, rpt_varclus_label_nodetype, noquote))";
97401     +run;
97402     +quit;
97403     +%mend MakeClusConstellData;
97407     +%macro MakeClusConstellData(indata=, outlink=, outnode=);
97409     +data &outlink(drop = Selected);
97410     +     set &indata;
97411     +     LINKID = _N_;
97412     +     label LINKID = "%sysfunc(sasmsg(sashelp.dmine, rpt_varclus_label_linkid,  noquote))";
97413     +     if strip(upcase(Cluster)) eq strip(upcase(Variable)) then Variable = ClosestCluster;
97414     +run;
97415     +data &outnode(keep=NODEID TYPE LABEL);
97416     +    set &indata;
97417     +    length TYPE $16;
97418     +    rename Variable = NODEID;
97419     +    label  Variable= "%sysfunc(sasmsg(sashelp.dmine, rpt_varclus_label_nodeidvar, noquote))";
97420     +    if strip(upcase(Cluster)) eq strip(upcase(Variable))
97421     +    then  TYPE = "CLUSTER";
97422     +    else  TYPE="VARIABLE";
97423     +    label TYPE = "%sysfunc(sasmsg(sashelp.dmine, rpt_varclus_label_nodetype, noquote))";
97424     +run;
97425     +quit;
97426     +%mend MakeClusConstellData;
97429     +/*--- This will work only when inds is not a view data -------
97431     +%macro getNVarNObs(inds=, nvar=, nobs=);
97433     +    %global &nvar;
97434     +    %global &nobs;
97435     +    data _null_;
97436     +         dsid = open("&inds");
97437     +         nv = attrn(dsid, 'NVAR');
97438     +         no = attrn(dsid, 'NOBS');
97439     +         dsid = close(dsid);
97440     +         call symput("&nvar", nv);
97441     +         call symput("&nobs", no);
97442     +    run;
97443     +    quit;
97444     +%mend  getNVarNObs;
97446     ++---------------------------------------------------------------*/
97449     +%macro getNVar(inds=, nvar=);
97450     +    %global &nvar;
97451     +    data _null_;
97452     +         dsid = open("&inds");
97453     +         nv = attrn(dsid, 'NVAR');
97454     +         dsid = close(dsid);
97455     +         call symput("&nvar", nv);
97456     +    run;
97457     +    quit;
97458     +%mend  getNVar;
97462     +%macro getNObs(inds=, nobs=);
97463     +    %global &nobs;
97464     +    data _null_;
97465     +        set &inds end=eof;
97466     +        if eof then call symput("&nobs", _N_);
97467     +    run;
97468     +    quit;
97469     +%mend  getNObs;
97471     +%Macro CreateVarclusMeta(trainnum=);
97472     +   %EM_GETNAME(KEY=VARCLUSMETA, TYPE=DATA);
97473     +    data &EM_USER_VARCLUSMETA;
97474     +         length TrainNum 8.;
97475     +         length NewTrain $8;
97476     +         length NGCluster 8.;
97477     +         length ExportedComp $16;
97478     +         length HideVariable $8;
97479     +         TrainNum = &trainnum;
97480     +         NewTrain = "Y";
97481     +         ExportedComp = "&EM_PROPERTY_EXPORTEDCOMP";
97482     +         HideVariable = "&EM_PROPERTY_HIDEVARIABLE";
97483     +         NGCluster = 0; /* zero means no twostage */
97484     +   run;
97485     +   quit;
97486     +%mend CreateVarclusMeta;
NOTE: %INCLUDE (level 1) ending.
MPRINT(MAIN):   filename temp catalog 'sashelp.emexpl.variableclustering_macros2.source';
NOTE: %INCLUDE (level 1) file TEMP is file SASHELP.EMEXPL.VARIABLECLUSTERING_MACROS2.SOURCE.
97488     +%macro MakeInterClusCorrData(indata=, outdata=, ncluster=, globalclusid=, RSquare=N, makeplotds=N, plotds=);
97489     +    data &outdata(drop= _NCL_  _TYPE_);
97490     +       set &indata;
97491     +       if ^(strip(_NCL_) eq &ncluster and strip(_TYPE_) eq 'CCORR') then delete;
97492     +       %if &globalclusid ne %then %do;
97493     +       _NAME_ = "GC&globalclusid._"||upcase(_NAME_);
97494     +       rename _NAME_ = Cluster;
97495     +       %end;
97496     +       %else %do;
97497     +        _NAME_ = upcase(_NAME_);
97498     +       rename _NAME_ = Cluster;
97499     +       %end;
97500     +       label _NAME_ = "%sysfunc(sasmsg(sashelp.dmine, rpt_varclus_label_clustername,  noquote))";
97501     +    run;
97502     +    data corr_tmp;
97503     +        set &outdata;
97504     +    run;
97506     +    %let dsid = %sysfunc(open(work.corr_tmp));
97507     +    %let nclus2= %eval(&ncluster+1);
97508     +    data &outdata;
97509     +         set &outdata;
97510     +          %do i = 2 %to &nclus2;
97511     +          %let i_1 = %eval(&i-1);
97512     +            %let _name = %sysfunc(varname(&dsid, &i));
97513     +            %if &globalclusid ne %then
97514     +                %do; %let _newName = GC&globalclusid._CLUS&i_1;
97515     +                     rename &_name = &_newName;
97516     +                     *label &_name ="GC &globalclusid : Cluster &i_1";
97517     +                     label &_name = "%sysfunc(sasmsg(sashelp.dmine, rpt_varclus_label_gc_clusternum, noquote,  &globalclusid, &i_1))";
97518     +                %end;
97519     +            %else
97520     +                %do; %let _newName = CLUS&i_1;
97521     +                     rename &_name = &_newName;
97522     +                     *label &_name ="Cluster &i_1";
97523     +                     label &_name = "%sysfunc(sasmsg(sashelp.dmine, rpt_varclus_label_clusternum, noquote,  &i_1))";
97524     +                %end;
97525     +          %end;
97526     +          keep Cluster
97527     +          %do i = 2 %to &nclus2;
97528     +                %let _name = %sysfunc(varname(&dsid, &i));
97529     +                &_name
97530     +          %end;
97531     +          ;
97532     +    %let dsid= %sysfunc(close(&dsid));
97533     +     run;
97534     +     quit;
97536     +    %if &RSquare eq Y %then %do;
97538     +       data corr_tmp;
97539     +        set &outdata;
97540     +     run;
97542     +     data &outdata;
97543     +          set &outdata;
97544     +          %let dsid = %sysfunc(open(work.corr_tmp));
97545     +          %let nvar = %sysfunc(attrn(&dsid, NVAR));
97546     +          %do i = 2 %to &nvar;
97547     +            %let _name = %sysfunc(varname(&dsid, &i));
97548     +            %let _name_md = &_name.**2;
97549     +                &_name = &_name_md;
97550     +          %end;
97551     +      %let dsid= %sysfunc(close(&dsid));
97552     +      run;
97553     +    %end;
97555     +    %if &makeplotds eq Y %then %do;
97556     +     proc transpose data = &outdata
97557     +          out=&plotds(drop=_LABEL_ rename=(_NAME_ = Y Cluster=X Col1= Correlation));
97558     +          by cluster;
97559     +     run;
97560     +     data &plotds;
97561     +          set  &plotds;
97562     +          label x="%sysfunc(sasmsg(sashelp.dmine, rpt_varclus_label_cluster, noquote))";
97563     +          label Y="%sysfunc(sasmsg(sashelp.dmine, rpt_varclus_label_cluster, noquote))";
97564     +          label  Correlation="%sysfunc(sasmsg(sashelp.dmine, rpt_correlation_vlabel, noquote))";
97565     +     run;
97566     +     %end;
97567     +     proc datasets lib = work nolist;
97568     +           delete corr_tmp;
97569     +     run;
97570     +     quit;
97571     +%mend MakeInterClusCorrData;
97573     +%macro MakeOwnRSquare(indata=, outdata=, ncluster=, globalclusid=);
97574     +    data _tmpds(drop= _NCL_);
97575     +       set &indata;
97576     +       if ^(strip(_NCL_) eq &ncluster and strip(_TYPE_) in ('GROUP','RSQUARED')) then delete;
97577     +       %if &globalclusid ne %then %do;
97578     +           _NAME_ = "GC&globalclusid.";
97579     +       rename _NAME_ = Cluster;
97580     +       %end;
97581     +       %else %do;
97582     +        _NAME_ = "CLUS";
97583     +        rename _NAME_ = Cluster;
97584     +       %end;
97585     +       label _NAME_ = "%sysfunc(sasmsg(sashelp.dmine, rpt_varclus_label_clustername,  noquote))";
97586     +    run;
97587     +    proc transpose data =_tmpds out =&outdata;
97588     +    run;
97590     +    data &outdata(drop=COL1);
97591     +        %if &globalclusid ne %then %do;
97592     +        length GCluster $16;
97593     +        %end;
97594     +        length Cluster $32;
97595     +        length _NAME_ $32;
97596     +         set &outdata;
97597     +         _NAME_ = upcase(_NAME_);
97598     +         rename _NAME_=Variable;
97599     +         *label _NAME_="Variable";
97600     +         label _NAME_ = "%sysfunc(sasmsg(sashelp.dmine, rpt_varclus_label_variable, noquote))" ;
97601     +         label Cluster = "%sysfunc(sasmsg(sashelp.dmine, rpt_varclus_label_cluster, noquote))" ;
97602     +         label GCluster = "%sysfunc(sasmsg(sashelp.dmine, rpt_varclus_label_gcluster, noquote))" ;
97604     +         %if &globalclusid ne %then %do;
97605     +          GCluster = "GC&globalclusid";
97606     +          Cluster = "GC&globalclusid._CLUS"||strip(COL1);
97607     +         %end;
97608     +         %else %do;
97609     +         Cluster = "CLUS"||strip(COL1);
97610     +        %end;
97611     +         rename COL2 = RSqWithOwnClusComp;
97612     +         *label COL2 = "R-Square With Own Cluster Component";
97613     +         label COL2 = "%sysfunc(sasmsg(sashelp.dmine, rpt_varclus_label_ownrsq, noquote))" ;
97615     +   run;
97616     +   proc sort data =&outdata;
97617     +        by Cluster RSqWithOwnClusComp;
97618     +   run;
97619     +   proc datasets lib = work nolist;
97620     +           delete _tmpds;
97621     +   run;
97622     +   quit;
97623     +%mend MakeOwnRSquare;
97625     +%macro MakeClusStructCorrData(indata=, outdata=, globalclusid=, ncluster=, Rsquare=N);
97626     +    data &outdata(drop= _NCL_  _TYPE_);
97627     +       %if &globalclusid ne %then %do;
97628     +        length GCluster $16;
97629     +        %end;
97630     +       set &indata;
97631     +       if ^(strip(_NCL_) eq &ncluster and strip(_TYPE_) eq 'STRUCTUR') then delete;
97632     +       %if &globalclusid ne %then %do;
97633     +         GCluster = "GC&globalclusid";
97634     +         _NAME_ = "GC&globalclusid._"||upcase(_NAME_);
97635     +         rename _NAME_ = Cluster;
97636     +         label _NAME_ = "%sysfunc(sasmsg(sashelp.dmine, rpt_varclus_label_cluster, noquote))" ;
97637     +         label GCluster = "%sysfunc(sasmsg(sashelp.dmine, rpt_varclus_label_gcluster, noquote))" ;
97639     +       %end;
97640     +       %else %do;
97641     +         _NAME_ = upcase(_NAME_);
97642     +         rename _NAME_ = Cluster;
97643     +         label _NAME_ = "%sysfunc(sasmsg(sashelp.dmine, rpt_varclus_label_cluster, noquote))" ;
97644     +         label GCluster = "%sysfunc(sasmsg(sashelp.dmine, rpt_varclus_label_gcluster, noquote))" ;
97646     +       %end;
97647     +     run;
97648     +    %if &RSquare eq Y %then %do;
97649     +     data corr_tmp;
97650     +          set &outdata;
97651     +     run;
97652     +     %let istart = 2;
97653     +     %if &globalclusid ne %then %let istart = 3;
97654     +     data &outdata;
97655     +          set &outdata;
97656     +          %let dsid = %sysfunc(open(work.corr_tmp));
97657     +          %let nvar = %sysfunc(attrn(&dsid, NVAR));
97658     +          %do i =&istart %to &nvar;
97659     +            %let _name = %sysfunc(varname(&dsid, &i));
97660     +            %let _name_md = &_name.**2;
97661     +                &_name = &_name_md;
97662     +          %end;
97663     +      %let dsid= %sysfunc(close(&dsid));
97664     +      run;
97665     +      proc datasets lib = work nolist;
97666     +           delete corr_tmp;
97667     +      run;
97668     +    %end;
97669     +     quit;
97670     +%mend MakeClusStructCorrData;
97672     +/*
97673     +%MakeClusStructCorrData(indata=playpen._outstat, outdata=_structrsq , ncluster=7, Rsquare=Y);
97674     +*/
97676     +%macro FindNextClosestClusByVar(indata=, outdata=, globalclusid=, ncluster=);
97678     +     /* The indata should be the outdata
97679     +        from %MakeClusStructCorrData(indata=, outdata=, ); */
97681     +     proc sort data =&indata out=_tmpclusRsq;
97682     +     by cluster;
97683     +     run;
97685     +     proc transpose data =_tmpclusRsq out=_tmpclusRsq;
97686     +      by cluster;
97687     +     run;
97689     +     proc sort data=_tmpclusRsq;
97690     +        by _NAME_ COL1;
97691     +     run;
97693     +     data _tmpclusRsq;
97694     +         length _NAME_ $32;
97695     +         set _tmpclusRsq; by _NAME_;
97696     +          _NAME_ = upcase(_NAME_);
97697     +          %if &ncluster ne 1 %then %do;
97698     +             if last._NAME_ then delete;
97699     +          %end;
97700     +          %else %do;
97701     +             COL1 = 0;
97702     +          %end;
97703     +     run;
97704     +     /* need to sort again */
97705     +     proc sort data=_tmpclusRsq;
97706     +        by _NAME_ COL1;
97707     +     run;
97709     +     data &outdata;
97710     +         set _tmpclusRsq; by _NAME_;
97711     +         Cluster = upcase(Cluster);
97712     +         if last._NAME_ then output;
97713     +         *label  COL1 = 'R-Sqaure with Next Cluster Component';
97714     +         label COL1 = "%sysfunc(sasmsg(sashelp.dmine, rpt_varclus_label_nextrsq, noquote))" ;
97715     +         rename COL1 = RSqWithNextClusComp;
97716     +         Cluster = upcase(Cluster);
97717     +         rename Cluster = ClosestCluster;
97718     +         *label  Cluster = "Next Closest Cluster";
97719     +         label Cluster = "%sysfunc(sasmsg(sashelp.dmine, rpt_varclus_label_nextclus, noquote))" ;
97720     +         rename _NAME_ = Variable;
97721     +         label  _NAME_ = "%sysfunc(sasmsg(sashelp.dmine, rpt_varclus_label_variable, noquote))" ;
97722     +    run;
97725     +    %if &globalclusid ne %then %do;
97726     +    data &outdata;
97727     +       length GCluster $16;
97728     +       set &outdata;
97729     +       GCluster = "GC&globalclusid";
97730     +       run;
97731     +    %end;
97732     +    proc datasets lib = work nolist;
97733     +           delete _tmpclusRsq;
97734     +    run;
97735     +    quit;
97736     +%mend FindNextClosestClusByVar;
97739     +%macro FindNextClosestClusByCluster(indata=, outdata=, globalclusid=, ncluster=);
97740     +     /* The indata should be the outdata from %MakeInterClusCorrData(indata=, outdata=, ); */
97741     +     proc sort data =&indata out=_tmpclusRsq;
97742     +     by cluster;
97743     +     run;
97744     +     proc transpose data =_tmpclusRsq out=_tmpclusRsq;
97745     +     by cluster;
97746     +     run;
97747     +     proc sort data=_tmpclusRsq;
97748     +        by _NAME_ col1;
97749     +     run;
97750     +     data _tmpclusRsq;
97751     +         length _NAME_ $32;
97752     +         set _tmpclusRsq; by _NAME_;
97753     +          _NAME_ = upcase(_NAME_);
97754     +          %if &ncluster ne 1 %then %do;
97755     +             if last._NAME_ then delete;
97756     +          %end;
97757     +          %else %do;
97758     +             COL1 = 0;
97759     +          %end;
97760     +     run;
97761     +     data &outdata;
97762     +         set _tmpclusRsq; by _NAME_;
97763     +         Cluster = upcase(Cluster);
97764     +         if last._NAME_ then output;
97765     +         *label  COL1 = 'R-Sqaure with Next Cluster Component';
97766     +         label COL1 = "%sysfunc(sasmsg(sashelp.dmine, rpt_varclus_label_nextrsq, noquote))" ;
97767     +         rename COL1 = RSqWithNextClusComp;
97768     +         Cluster = upcase(Cluster);
97769     +         rename Cluster = ClosestCluster;
97770     +         *label  Cluster = "Next Closest Cluster";
97771     +         label Cluster = "%sysfunc(sasmsg(sashelp.dmine, rpt_varclus_label_nextclus, noquote))" ;
97772     +         rename _NAME_ = Variable;
97773     +         *label  _NAME_ = "Variable";
97774     +         label  _NAME_ = "%sysfunc(sasmsg(sashelp.dmine, rpt_varclus_label_variable, noquote))" ;
97776     +    run;
97777     +    %if &globalclusid ne %then %do;
97778     +    data &outdata;
97779     +       length GCluster $16;
97780     +       set &outdata;
97781     +       GCluster = "GC&globalclusid";
97782     +       run;
97783     +    %end;
97785     +    proc datasets lib = work nolist;
97786     +           delete _tmpclusRsq;
97787     +    run;
97789     +    quit;
97790     +%mend FindNextClosestClusByCluster;
97792     +%macro MakeVarClusResultTable(indata1=, indata2=, indata3=, outdata=, globalclusid=, ncluster=, selectedcomp=clustercomp);
97793     +/*----
97794     +  indata1=_ownRsq, indata2=_nextVarRsq, indata3=_nextClusRSq,
97795     +-----------*/
97797     +proc sort data =&indata1;
97798     +    by Variable;
97799     +run;
97800     +proc sort data =&indata2;
97801     +    by Variable;
97802     +run;
97803     +data &outdata;
97804     +    merge &indata1 &indata2;
97805     +    by Variable;
97806     +    length Type $16;
97807     +    Type = 'Variable';
97808     +    *label Type ='Type';
97809     +    label Type = "%sysfunc(sasmsg(sashelp.dmine, rpt_varclus_label_type, noquote))" ;
97810     +run;
97813     +data &indata3;
97814     +    set  &indata3 ;
97815     +    length RSqWithOwnClusComp 8.;
97816     +    Cluster = Variable;
97817     +    RSqWithOwnClusComp = 1;
97818     +    *label RSqWithOwnClusComp = "R-Square With Own Cluster Component";
97819     +    label RSqWithOwnClusComp = "%sysfunc(sasmsg(sashelp.dmine, rpt_varclus_label_ownrsq, noquote))" ;
97820     +    length Type $16;
97821     +    Type = 'ClusterComp';
97822     +    label Type = "%sysfunc(sasmsg(sashelp.dmine, rpt_varclus_label_type, noquote))" ;
97824     +;
97825     +run;
97827     +proc sort data=&outdata;
97828     +    by Cluster;
97829     +run;
97830     +proc sort data =&indata3;
97831     +    by Cluster;
97832     +run;
97834     +data &outdata;
97835     +     set &outdata &indata3;
97836     +     by Cluster;
97837     +run;
97840     +/* Create the Selected variable with all YES */
97842     +data &outdata;
97843     +     set &outdata;
97844     +     length RsqRatio 8.;
97845     +     length Selected $8;
97846     +     *label RSqRatio = "1-R**2 Ratio";
97847     +     label RSqRatio =  "%sysfunc(sasmsg(sashelp.dmine, rpt_varclus_label_oneminusrsq, noquote))" ;
97848     +     *label Selected = "Variable Selected";
97849     +     label Selected = "%sysfunc(sasmsg(sashelp.dmine, rpt_varclus_label_varselected, noquote))" ;
97850     +     RsqRatio = (1-RSqWithOwnClusComp)/(1-RSqWithNextClusComp);
97851     +     Selected ='YES';
97852     +     rename _LABEL_ = Label;
97853     +     label _LABEL_ =  "%sysfunc(sasmsg(sashelp.dmine, rpt_varclus_label_label, noquote))" ;
97854     +run;
97857     +/*----  Selected = Y/N will be assigened at the %score                   -------+
97858     +        Just create the Selected variable with all YES at the step above
97859     + +------------------------------------------------------------------------------+
97861     +proc sort data=&outdata;
97862     +    by Cluster RsqRatio;
97863     +run;
97865     +%if &selectedcomp eq CLUSTERCOMP %then %do;
97866     +data &outdata;
97867     +     set &outdata; by Cluster;
97868     +     length Selected $8;
97869     +     label Selected = "Variable Selected";
97870     +     if  first.Cluster then Selected ='Yes';
97871     +     else Selected = 'No';
97872     +    run;
97873     +%end;
97874     +%else %do;
97875     +data &outdata(drop = _var _varchange);
97876     +     set &outdata; retain _var 0; by Cluster;
97877     +     length Selected $8;
97878     +     label Selected = "Variable Selected";
97879     +     if first.Cluster then  _varchange = 0;
97880     +     else _varchange =1;
97881     +     if _var ne _varchange then  Selected  = 'Yes';
97882     +     else Selected = 'No';
97883     +     if last.cluster then  _var = 0;
97884     +     else _var = _varchange;
97885     +run;
97886     +%end;
97888     +--------------------------------------------------------------*/
97890     +quit;
97891     +%mend MakeVarClusResultTable;
97893     +%Macro MakePlotDataFromCorrTable(indata=, outdata=, globalclusid=);
97894     +     proc sort data =&indata;
97895     +        by cluster;
97896     +     run;
97897     +     proc transpose data =&indata
97898     +          out=&outdata(drop=_LABEL_ rename=(_NAME_ = Y Cluster=X Col1= Correlation));
97899     +          by cluster;
97900     +     run;
97901     +     data &outdata;
97902     +          set  &outdata;
97903     +          label x= "%sysfunc(sasmsg(sashelp.dmine, rpt_varclus_label_cluster, noquote))" ;
97904     +          label Y= "%sysfunc(sasmsg(sashelp.dmine, rpt_varclus_label_cluster, noquote))" ;
97905     +          label Correlation = "%sysfunc(sasmsg(sashelp.dmine, rpt_correlation_vlabel, noquote))" ;
97906     +     run;
97907     +     %if &globalclusid ne %then %do;
97908     +     data &outdata;
97909     +          Length GCluster $16;
97910     +          label GCluster = "%sysfunc(sasmsg(sashelp.dmine, rpt_varclus_label_gcluster, noquote))" ;
97911     +          set  &outdata;
97912     +          GCluster ="GC&globalclusid.";
97913     +          run;
97914     +     %end;
97916     +%Mend MakePlotDataFromCorrTable;
97919     +%macro MakeCorrelation(indata=,
97920     +                       outstat=_tmpoutstat,
97921     +                       corrmatrix=N,
97922     +                       outcorr=_tmpoutcorr,
97923     +                       includeclassvar=N,
97924     +                       target=,
97925     +                       freq=,
97926     +                       weight=);
97927     +   %if &target eq  %then %do;
97929     +       proc varclus data=&indata outstat=&outstat hi maxclusters=1 noprint;
97930     +            var %EM_INTERVAL_INPUT %EM_INTERVAL_REJECTED
97931     +       %if &includeclassvar eq Y %then %do;
97932     +          %let dsid = %sysfunc(open(&EM_USER_OUTDUMMY));
97933     +          %let nvar = %sysfunc(attrn(&dsid, NVAR));
97934     +          %do i = 2 %to &nvar;
97935     +          %let varname = %sysfunc(varname(&dsid, &i));
97936     +          &varname
97937     +          %end;
97938     +       %end;
97939     +       ;
97940     +      %if &freq ne  %then %do;
97941     +          freq &freq;
97942     +      %end;
97943     +      %if &weight ne  %then %do;
97944     +          weight &weight;
97945     +      %end;
97947     +      run;
97948     +      %if &corrmatrix eq Y %then %do;
97949     +      data  &outcorr (drop = _NCL_ _TYPE_);
97950     +           set  &outstat ;
97951     +           if _TYPE_ ='CORR' then output;
97952     +      run;
97953     +      %end;
97954     +    %end;
97955     +    %else %do;
97956     +       proc corr data=&indata outp=&outstat noprint;
97957     +            var
97958     +       %let dsid = %sysfunc(open(&indata));
97959     +       %let nvar = %sysfunc(attrn(&dsid, NVAR));
97960     +          %do i = 1 %to &nvar;
97961     +              %let _name = %sysfunc(varname(&dsid, &i));
97962     +              %if &_name ne &target %then;
97963     +              &_name
97964     +           %end;
97965     +        %let dsid= %sysfunc(close(&dsid));
97966     +        ;
97967     +        with &target;
97968     +        run;
97969     +    %end;
97970     +    quit;
97971     +%mend MakeCorrelation;
97974     +%macro MakeCorrelationDistance(indata=,
97975     +                               outdata=,
97976     +                               rsquare = N
97977     +                               );
97978     +    data corr_tmp;
97979     +        set &indata;
97980     +        if _N_ = 1 then do;
97981     +           output;
97982     +           stop;
97983     +         end;
97984     +    run;
97985     +    %if &outdata ne  %then %let  _outdata = &outdata;
97986     +    %else %let _outdata = &indata;
97988     +    data &_outdata;
97989     +         set &indata;
97991     +         %let dsid = %sysfunc(open(work.corr_tmp));
97992     +         %let nvar = %sysfunc(attrn(&dsid, NVAR));
97993     +          %do i = 2 %to &nvar;
97994     +              %let _name = %sysfunc(varname(&dsid, &i));
97995     +              %if &rsquare eq Y %then %let _name_md = &_name.**2;
97996     +              %else  %let _name_md = &_name;
97997     +              &_name = 1- &_name_md;
97998     +          %end;
97999     +      %let dsid= %sysfunc(close(&dsid));
98000     +      run;
98001     +      proc datasets lib = work nolist;
98002     +           delete corr_tmp;
98003     +      run;
98004     +      quit;
98005     +  %mend MakeCorrelationDistance;
98008     +%macro UpdateOutStatCorrToDistance(indata=, /* indata should be a outstat from proc varclus */
98009     +                                   rsquare = N
98010     +                                   );
98011     +    data corr_tmp;
98012     +        set &indata;
98013     +    run;
98014     +    proc sql noprint;
98015     +           update &indata
98016     +           set
98017     +     %let dsid = %sysfunc(open(work.corr_tmp));
98018     +     %let nvar = %sysfunc(attrn(&dsid, NVAR));
98019     +          %do i = 4 %to &nvar;
98020     +          %let _name = %sysfunc(varname(&dsid, &i));
98021     +             %if &rsquare eq Y %then %let _name_md = &_name.**2;
98022     +            %else  %let _name_md = &_name;
98023     +            %if &i < &nvar %then %do;
98024     +               &_name = 1- &_name_md ,
98025     +            %end;
98026     +            %else %do;
98027     +               &_name = &_name_md where _TYPE_ eq 'CORR' ;
98028     +            %end;
98029     +          %end;
98030     +      %let dsid= %sysfunc(close(&dsid));
98032     +      select * from &indata;
98033     +      run;
98034     +     data &indata( drop = _NCL_);
98035     +           set &indata;
98036     +           if _TYPE_ not in ('CORR', 'STD', 'N', 'MEAN') then delete;
98037     +           if _TYPE_ ='CORR' then _TYPE_ ='DISTANCE';
98038     +     run;
98039     +     data &indata(DROP = _NCL_);
98040     +           set &indata;
98041     +           if _TYPE_ = 'CORR' then _TYPE_ ='DISTANCE';
98042     +           if _TYPE_ not in ('DISTANCE', 'N', 'STD', 'MEAN') then delete;
98043     +           rename _NAME_ = _VAR_;
98044     +     run;
98045     +     proc datasets lib = work nolist;
98046     +           delete corr_tmp;
98047     +     run;
98048     +     quit;
98049     + %mend UpdateOutStatCorrToDistance;
98052     +%macro HierClusWithCorr(indata= ,
98053     +                        ncluster=,
98054     +                        method = Ward,
98055     +                        outtree = _outtree,
98056     +                        idvar =_VAR_,
98057     +                        outdata=,
98058     +                        rescore = N,
98059     +                        newncluster=
98060     +                        );
98061     +      %global &newncluster;
98062     +      %if &rescore ne Y %then %do;
98063     +      proc cluster data=&indata(type=Distance where=(upcase(strip(_TYPE_)) = "DISTANCE"))
98064     +                   method=&method outtree=&outtree noprint;
98065     +           id &idvar;
98066     +      run;
98067     +      %end;
98068     +      proc tree data=&outtree nclusters = &ncluster out=&outdata noprint;
98069     +      run;
98070     +      /* ----- Check some variables like CL1, CL5..., remove them ----*/
98071     +      proc contents data =&indata out=_outcontent(keep=NAME) noprint;
98072     +      run;
98073     +      data _outcontent;
98074     +          set _outcontent;
98075     +          if NAME in ('_TYPE_' , '_VAR_') then delete;
98076     +          index = 1;
98077     +          rename NAME = _NAME_;
98078     +      run;
98079     +      proc sort data=_outcontent;
98080     +          by _NAME_;
98081     +      run;
98082     +      proc sort data =&outdata;
98083     +           by _NAME_;
98084     +      run;
98085     +      data &outdata(drop=index);
98086     +          merge &outdata _outcontent;
98087     +          by _NAME_;
98088     +          if index = . then delete;
98089     +      run;
98090     +      /*-----------------------------------------------------------*/
98091     +      data &outdata;
98092     +           length CLUSNAME $16;
98093     +           set &outdata;
98094     +           if CLUSTER > &ncluster then delete;
98095     +           CLUSNAME='GC'||strip(CLUSTER);
98096     +           *label CLUSNAME = "Cluster Name";
98097     +           label CLUSNAME  = "%sysfunc(sasmsg(sashelp.dmine, rpt_varclus_label_clustername, noquote))" ;
98098     +           rename _NAME_ = VARIABLE ;
98099     +           *label _NAME_ = "Variable";
98100     +           *label CLUSTER = "Cluster";
98101     +           label _NAME_ ="%sysfunc(sasmsg(sashelp.dmine, rpt_varclus_label_variable, noquote))" ;
98102     +           label CLUSTER ="%sysfunc(sasmsg(sashelp.dmine, rpt_varclus_label_cluster, noquote))" ;
98103     +      run;
98104     +      proc sort data=&outdata out=&outdata;
98105     +           by CLUSTER;
98106     +      run;
98107     +      proc means data =&outdata noprint;
98108     +           output out=_meanout;
98109     +      run;
98110     +      data _null_;
98111     +            set _meanout;
98112     +            if strip(_STAT_) eq 'MAX' then do;
98113     +            call symput("&newncluster", CLUSTER);
98114     +            stop;
98115     +            end;
98116     +      run;
98118     +      proc datasets lib = work nolist;
98119     +           delete _outcontent _meanout;
98120     +      run;
98121     +      quit;
98122     +%mend  HierClusWithCorr;
98124     +%macro CreateScoreCode2(indata=, ncluscomp=, globalclusid=, fileref=);
98126     +     data _tmpindata;
98127     +          set &indata;
98128     +          if (_TYPE_ in ('SCORE' 'MEAN' 'STD') and _NCL_ = &ncluscomp ) or (_TYPE_ in ('MEAN' 'STD'));
98129     +          if _TYPE_ = 'MEAN' then _NAME_='MEAN';
98130     +          if _TYPE_ = 'STD' then _NAME_='STD';
98131     +          if _TYPE_ = 'SCORE' then _NAME_=upcase("GC&globalclusid._"||_NAME_);
98132     +          DROP _TYPE_ _NCL_;
98133     +     run;
98135     +     filename _file_  "&fileRef";
98137     +     data _null_;
98138     +        FILE _file_ MOD;
98139     +        put ' ';
98140     +        put "/*-------------------------------------------------*/";
98141     +        put '/* ' "%sysfunc(sasmsg(sashelp.dmine, rpt_varclus_score_title_gclus, noquote, &globalclusid))" '*/';
98142     +        put "/*-------------------------------------------------*/";
98143     +        put ' ';
98144     +        %let dsid = %sysfunc(open(work._tmpindata));
98146     +        %let nvar = %sysfunc(attrn(&dsid, NVAR));
98147     +        %let vn_name =%sysfunc(varnum(&dsid, _NAME_));
98148     +        %let k = 1;
98149     +        %do %while(^%sysfunc(fetch(&dsid)));
98150     +               %let _name = %sysfunc(getvarc(&dsid, &vn_name));
98151     +               %if &k > 2 %then %do;
98152     +                %let cn = %eval(&k-2);
98153     +                 put "&_name = 0 ; /*---" "%sysfunc(sasmsg(sashelp.dmine, rpt_varclus_score_gcluscompnum, noquote, &globalclusid, &cn))" "------ */";
98154     +                %end;
98155     +                %let k = %eval(&k+1);
98157     +        %end;
98158     +        %let rc = %sysfunc(rewind(&dsid));
98160     +        %do j= 2 %to &nvar;
98161     +            %let _varname = %sysfunc(varname(&dsid, &j));
98162     +            %do %while(^%sysfunc(fetch(&dsid)));
98163     +                %let _name = %sysfunc(getvarc(&dsid, &vn_name));
98164     +                %if &_name = MEAN %then
98165     +                %let _mean = %sysfunc(getvarn(&dsid, &j));
98166     +                %else %if &_name = STD %then
98167     +                %let _std = %sysfunc(getvarn(&dsid, &j));
98168     +                %else %do;
98169     +                      %let coeff =  %sysfunc(getvarn(&dsid, &j));
98170     +                      %let abscoeff = %sysfunc(abs(&coeff));
98171     +                          %if &abscoeff >  0 %then %do;
98172     +                       put "&_name = &_name+&coeff * (&_varname - &_mean)/&_std;";
98173     +                           %end;
98174     +                 %end;
98175     +             %end;
98176     +             %let rc = %sysfunc(rewind(&dsid));
98177     +         %end;
98179     +        %let dsid= %sysfunc(close(&dsid));
98181     +     run;
98183     +     filename _file_;
98184     +     proc datasets lib = work nolist;
98185     +           delete _tmpindata;
98186     +     run;
98187     +     quit;
98188     +%mend CreateScoreCode2;
98191     +%macro MakeDeltaCode2(groupds=,deltacodefile=);
98193     +     /*--- Build Code to Modify Metadata ---*/
98194     +     filename X "&deltacodefile";
98195     +     data _null_;
98196     +        FILE X;
98197     +        set &groupds end=eof;
98198     +        if _N_=1 then do;
98199     +           %if &EM_PROPERTY_INCLUDECLASSVAR eq Y %then %do;
98200     +            put "if upcase(strip(ROLE)) ='INPUT' and upcase(strip(LEVEL)) ^='INTERVAL' then ROLE ='REJECTED' ;";
98201     +           %end;
98202     +           put "if upcase(strip(ROLE))='INPUT' and upcase(strip(LEVEL))='INTERVAL' then do;";
98203     +           put "if upcase(strip(NAME)) in (";
98204     +        end;
98205     +        if Strip(upcase(Selected)) eq 'YES' then do;
98206     +           string = '"'!!trim(left(VARIABLE))!!'"';
98207     +           put string;
98208     +        end;
98209     +        if eof then do;
98210     +           put ') then ROLE="INPUT";';
98211     +           put 'else ROLE="REJECTED";';
98212     +           put 'end;';
98214     +           %if %upcase(&EM_PROPERTY_HIDEVARIABLE) eq Y %then %do;
98215     +             put 'if upcase(strip(ROLE)) = "REJECTED" then delete ;';
98216     +           %end;
98217     +        end;
98218     +     run;
98219     +     quit;
98221     +     filename X;
98222     +     quit;
98223     +%mend MakeDeltaCode2;
98225     +%macro getInitialGClusterNumber(indata=, ninput=, ndummy=0, div=100, ngc=);
98226     +  %global &ngc;
98227     +  data _null_;
98228     +  %if &indata ne %then %do;
98229     +      %let dsid = %sysfunc(open(&indata));
98230     +           %let nvar = %sysfunc(attrn(&dsid, NVAR));
98231     +      %let dsid = %sysfunc(close(&dsid));
98232     +  %end;
98233     +  %else %do;
98234     +       %let nvar = %eval(&ninput+&ndummy); ;
98235     +  %end;
98236     +  %let numgc = %eval(&nvar/&div+2);
98237     +  %let &ngc = &numgc;
98238     +   run;
98239     +  quit;
98240     +%mend getInitialGClusterNumber;
98243     +%macro MakeGobalConstellData(indata=, outlink=, outnode=);
98244     +data &outlink(drop = Selected);
98245     +     set &indata;
98246     +     LINKID = _N_;
98247     +     label LINKID = "%sysfunc(sasmsg(sashelp.dmine, rpt_varclus_label_linkid, noquote))" ;
98248     +run;
98249     +data &outnode(keep=NODEID TYPE LABEL);
98250     +    set &indata;
98251     +    length TYPE $16;
98252     +    rename VARIABLE = NODEID;
98253     +    *label  CLUSNAME="Node ID";
98254     +    label CLUSNAME= "%sysfunc(sasmsg(sashelp.dmine, rpt_varclus_label_nodeidvar, noquote))" ;
98255     +    TYPE = "VARIABLE";
98256     +    *label TYPE = "Node Type";
98257     +    label TYPE =  "%sysfunc(sasmsg(sashelp.dmine, rpt_varclus_label_nodetype, noquote))" ;
98258     +    run;
98259     +data _tmp(keep=NODEID TYPE LABEL);
98260     +    set &indata;
98261     +    length TYPE $16;
98262     +    rename CLUSNAME = NODEID;
98263     +    label  CLUSNAME= "%sysfunc(sasmsg(sashelp.dmine, rpt_varclus_label_nodeidvar, noquote))" ;
98264     +    TYPE = "GCLUSTER";
98265     +    label TYPE = "%sysfunc(sasmsg(sashelp.dmine, rpt_varclus_label_nodetype, noquote))" ;
98266     +    run;
98267     +proc sort data=_tmp;
98268     +    by NODEID;
98269     +run;
98270     +data _tmp;
98271     +    set _tmp; by NODEID;
98272     +    if first.NODEID then output;
98273     +run;
98274     +proc sort data=&outnode;
98275     +    by NODEID;
98276     +run;
98277     +data  &outnode;
98278     +    set _tmp &outnode;
98279     +run;
98280     +proc datasets lib = work nolist;
98281     +     delete _tmp;
98282     +run;
98283     +quit;
98284     +%mend MakeGobalConstellData;
98286     +/* Make contellation plot data among GCLUSTERS */
98288     +%Macro MakeGClusterConstData(indata=, inoutrsq=, outnode=, outlink=);
98290     +data &outlink(keep = _NAME_ _PARENT_ _LABEL_ LINKID);
98291     +     set &indata;
98292     +     LINKID = _N_;
98293     +     if upcase(substr(strip(_NAME_),1, 2))="CL" then do;
98294     +        _NAME_ = "ROOT"||upcase(substr(strip(_NAME_),5));
98295     +     end;
98296     +     if _PARENT_ ne " " and upcase(substr(strip(_PARENT_),1, 2))="CL" then do;
98297     +        _PARENT_ = "ROOT"||upcase(substr(strip(_PARENT_),5));
98298     +     end;
98299     +     if upcase(substr(strip(_LABEL_),1, 2))="CL" then do;
98300     +        _LABEL_ = "ROOT"||upcase(substr(strip(_LABEL_),5));
98301     +    end;
98302     +run;
98304     +data _tmp_outrsquare;
98305     +        set &inoutrsq;
98306     +        if upcase(strip(TYPE)) = 'CLUSTERCOMP' then delete;
98307     +run;
98309     +proc freq data =_tmp_outrsquare noprint;
98310     +         tables GCluster/out=_tmp_GCLUSFREQ(rename=(GCLUSTER=_NAME_));
98311     +run;
98313     +data &outnode(keep=_NAME_ TYPE LABEL);
98314     +    set &outlink;
98315     +    length TYPE $16;
98316     +    length LABEL $100;
98317     +    /*label CLUSNAME= "%sysfunc(sasmsg(sashelp.dmine, rpt_varclus_label_nodeidvar, noquote))" ;*/
98319     +    if upcase(substr(strip(_NAME_),1, 2))='GC' then do;
98320     +    TYPE = "GCLUSTER";
98321     +    LABEL = "%sysfunc(sasmsg(sashelp.dmine, rpt_varclus_label_gcluster, noquote)):"||_NAME_;
98322     +    end;
98323     +    else do;
98324     +    TYPE= "ROOT";
98325     +    LABEL= _NAME_;
98326     +    end;
98327     +    label TYPE  =  "%sysfunc(sasmsg(sashelp.dmine, rpt_varclus_label_nodetype, noquote))" ;
98328     +    label LABEL =  "%sysfunc(sasmsg(sashelp.dmine, rpt_varclus_label_label, noquote))" ;
98329     +    label _NAME_ =  "%sysfunc(sasmsg(sashelp.dmine, rpt_varclus_label_nodeidvar, noquote))" ;
98330     +    run;
98332     +proc sort data=&outnode;
98333     +     by _NAME_;
98334     +proc sort data=_tmp_GCLUSFREQ;
98335     +     by _NAME_;
98336     +run;
98338     +data  &outnode;
98339     +     merge &outnode _tmp_GCLUSFREQ; by _NAME_;
98340     +     if COUNT=. then COUNT=1;
98341     +run;
98343     +proc datasets lib = work nolist;
98344     +     delete _tmp_outrsquare _tmp_GCLUSFREQ;
98345     +run;
98347     +quit;
98348     +%Mend MakeGClusterConstData;
98351     +%macro CreateGClusterScoreCode(indata=,  globalclusid=, fileref=);
98353     +    data _gscoretmpds;
98354     +          set &indata;
98355     +          if (_TYPE_ in ('SCORE' 'MEAN' 'STD') and _NCL_ = 1 ) or (_TYPE_ in ('MEAN' 'STD'));
98356     +          if _TYPE_ = 'MEAN' then _NAME_='MEAN';
98357     +          if _TYPE_ = 'STD' then _NAME_='STD';
98358     +          if _TYPE_ = 'SCORE' then _NAME_ = "GC"||strip(&globalclusid);
98359     +          DROP _TYPE_ _NCL_;
98360     +     run;
98362     +    /*  %let gscorefile =  %bquote(&EM_NODEDIR)&EM_DSEP.gclusterscore.sas;
98363     +        GCluster Component &globalclusid ------ */
98365     +    filename _file_  "&fileref";
98367     +    data _null_;
98368     +        %if &globalclusid eq 1 %then %do;
98369     +          FILE _file_;
98370     +        %end;
98371     +        %else %do;
98372     +          FILE _file_ MOD;
98373     +        %end;
98375     +        %let dsid = %sysfunc(open(work._gscoretmpds));
98376     +        %let nvar = %sysfunc(attrn(&dsid, NVAR));
98377     +        %let vn_name =%sysfunc(varnum(&dsid, _NAME_));
98379     +        %let k = 1;
98380     +        %do %while(^%sysfunc(fetch(&dsid)));
98381     +                %let _name = %sysfunc(getvarc(&dsid, &vn_name));
98382     +                %if &k > 2 %then %do;
98383     +                put "&_name = 0 ; ";
98384     +                %end;
98385     +                %let k = %eval(&k+1);
98386     +        %end;
98388     +        %let rc = %sysfunc(rewind(&dsid));
98389     +        %do i= 2 %to &nvar;
98390     +            %let _varname =  %sysfunc(varname(&dsid, &i));
98391     +            %do %while(^%sysfunc(fetch(&dsid)));
98392     +                %let _name = %sysfunc(getvarc(&dsid, &vn_name));
98393     +                %if &_name = MEAN %then
98394     +                %let _mean = %sysfunc(getvarn(&dsid, &i));
98395     +                %else %if &_name = STD %then
98396     +                %let _std = %sysfunc(getvarn(&dsid, &i));
98397     +                %else %do;
98398     +                      %let coeff =  %sysfunc(getvarn(&dsid, &i));
98399     +                      %let abscoeff = %sysfunc(abs(&coeff));
98400     +                          %if &abscoeff >  0 %then %do;
98401     +                       put "&_name = &_name+&coeff * (&_varname - &_mean)/&_std;";
98402     +                           %end;
98403     +                 %end;
98404     +             %end;
98405     +             %let rc = %sysfunc(rewind(&dsid));
98407     +         %end;
98409     +        %let dsid= %sysfunc(close(&dsid));
98410     +       run;
98413     +       proc datasets lib=work nolist;
98414     +            delete _gscoretmpds;
98415     +       run;
98416     +      quit;
98418     +%mend CreateGClusterScoreCode;
98421     +%macro MakeGClusterCorrelation(Indata=, ngcluster=, gscorecode=, outrsquare=);
98423     +   %EM_REGISTER(KEY=GSCORE, TYPE=DATA);
98424     +   %EM_GETNAME(KEY=GSCORE, TYPE=DATA);
98425     +   %EM_REGISTER(KEY=GSCORESTAT, TYPE=DATA);
98426     +   %EM_GETNAME(KEY=GSCORESTAT, TYPE=DATA);
98427     +   %EM_REGISTER(KEY=GSCORETREE, TYPE=DATA);
98428     +   %EM_GETNAME(KEY=GSCORETREE, TYPE=DATA);
98429     +   %EM_REGISTER(KEY=GSCORECORR, TYPE=DATA);
98430     +   %EM_GETNAME(KEY=GSCORECORR, TYPE=DATA);
98431     +   %EM_REGISTER(KEY=GSCORECORRPLOT, TYPE=DATA);
98432     +   %EM_GETNAME(KEY=GSCORECORRPLOT, TYPE=DATA);
98433     +   %EM_REGISTER(KEY=GCLUSLINK, TYPE=DATA);
98434     +   %EM_GETNAME(KEY=GCLUSLINK, TYPE=DATA);
98435     +   %EM_REGISTER(KEY=GCLUSNODE, TYPE=DATA);
98436     +   %EM_GETNAME(KEY=GCLUSNODE, TYPE=DATA);
98438     +   filename gsfile "&gscorecode";
98440     +   data &EM_USER_GSCORE;
98441     +             set &indata;
98442     +             %include  gsfile;
98443     +        keep
98444     +        %do i=1 %to &ngcluster;
98445     +         %let gcvarname = GC&i;
98446     +         &gcvarname
98447     +        %end;
98448     +     ;
98449     +   run;
98451     +   proc varclus data=&EM_USER_GSCORE outstat=&EM_USER_GSCORESTAT outtree=&EM_USER_GSCORETREE
98452     +    %if %upcase(&EM_PROPERTY_CLUSCOMP) eq CENTROID %then %do; centroid %end;
98453     +    %if %upcase(&EM_PROPERTY_CLUSSOURCE) eq COV %then %do; cov %end;
98454     +    %if %upcase(&EM_PROPERTY_CLUSHIERACHY) eq Y %then %do; hi %end;
98455     +    noprint  ;
98456     +     var
98457     +       %do i=1 %to &ngcluster;
98458     +         %let gcvarname = GC&i;
98459     +         &gcvarname
98460     +        %end;
98461     +   ;
98462     +   run;
98465     +   %MakeVarClusCorrData(statds=&EM_USER_GSCORESTAT, corrds=&EM_USER_GSCORECORR, corrplotds=&EM_USER_GSCORECORRPLOT );
98466     +   data &EM_USER_GSCORECORRPLOT ;
98467     +        set &EM_USER_GSCORECORRPLOT;
98468     +        rename _X_ = X;
98469     +        rename _Y_ = Y;
98470     +        label _X_ = "%sysfunc(sasmsg(sashelp.dmine, rpt_varclus_label_gcluster, noquote))" ;
98471     +        label _Y_ = "%sysfunc(sasmsg(sashelp.dmine, rpt_varclus_label_gcluster, noquote))" ;
98472     +   run;
98474     +   %MakeGClusterConstData(indata=&EM_USER_GSCORETREE, inoutrsq=&outrsquare, outnode=&EM_USER_GCLUSNODE, outlink=&EM_USER_GCLUSLINK);
98476     +   data &EM_USER_GSCORETREE;
98477     +        length _NAME_ $32;
98478     +        length _LABEL_ $100;
98479     +        set &EM_USER_GSCORETREE(DROP=_LABEL_);
98480     +        if upcase(substr(strip(_NAME_),1, 2))='GC' then do;
98481     +         _LABEL_ = "%sysfunc(sasmsg(sashelp.dmine, rpt_varclus_label_gcluster, noquote)):"||_NAME_;
98482     +        end;else do;
98483     +         _LABEL_ = _NAME_;
98484     +        end;
98485     +       label _LABEL_ = "%sysfunc(sasmsg(sashelp.dmine, rpt_varclus_label_variable, noquote))";
98487     +   run;
98489     +   quit;
98491     +%mend MakeGClusterCorrelation;
NOTE: %INCLUDE (level 1) ending.
MPRINT(MAIN):   filename temp;
NOTE: Fileref TEMP has been deassigned.
MPRINT(SETPROPERTIES):  ;
MPRINT(SETPROPERTIES):  ;
MPRINT(SETPROPERTIES):  ;
MPRINT(SETPROPERTIES):  ;
MPRINT(SETPROPERTIES):  ;
MPRINT(SETPROPERTIES):  ;
MPRINT(SETPROPERTIES):  ;
MPRINT(SETPROPERTIES):  ;
MPRINT(SETPROPERTIES):  ;
MPRINT(SETPROPERTIES):  ;
MPRINT(SETPROPERTIES):  ;
MPRINT(SETPROPERTIES):  ;
MPRINT(SETPROPERTIES):  ;
MPRINT(MAIN):  ;
MPRINT(MAIN):   filename temp catalog 'sashelp.emexpl.variableclustering_train.source';
NOTE: %INCLUDE (level 1) file TEMP is file SASHELP.EMEXPL.VARIABLECLUSTERING_TRAIN.SOURCE.
98496     +%macro train;
98498     +   filename temp catalog 'sashelp.emexpl.variableclustering_train1.source';
98499     +   %include temp;
98500     +   filename temp catalog 'sashelp.emexpl.variableclustering_train2.source';
98501     +   %include temp;
98502     +   filename temp catalog 'sashelp.emutil.em_copyfile.source';
98503     +   %include temp;
98504     +   filename temp;
98506     +   %let VARCLUS_MAXNUMOBS = 100000;
98507     +   %let VARCLUS_MAXNUMVAR = 200;
98508     +   %let trainnum = 0;
98509     +   %let error = 0;
98511     +   %if &EM_IMPORT_DATA eq %then %do;
98512     +       %let  EMEXCEPTIONSTRING = exception.server.IMPORT.NOTRAIN,1;
98513     +       %let  error = 1;
98514     +       %goto endtrain;
98515     +   %end;
98517     +    %if (%sysfunc(exist(&EM_IMPORT_DATA)) or %sysfunc(exist(&EM_IMPORT_DATA, VIEW))) < 1 %then %do;
98518     +        %let  EMEXCEPTIONSTRING = exception.server.IMPORT.NOTRAIN,1;
98519     +        %let  error = 1;
98520     +        %goto endline;
98521     +    %end;
98523     +   %let _num_input_interval = %eval(&EM_NUM_INTERVAL_INPUT+&EM_NUM_INTERVAL_REJECTED);
98524     +   %let _num_input_binary = %eval(&EM_NUM_BINARY_INPUT+&EM_NUM_BINARY_REJECTED);
98525     +   %let _num_input_nominal = %eval(&EM_NUM_NOMINAL_INPUT+&EM_NUM_NOMINAL_REJECTED);
98526     +   %let _num_input_ordinal = %eval(&EM_NUM_ORDINAL_INPUT+&EM_NUM_ORDINAL_REJECTED);
98527     +   %let _num_input_class = %eval(&_num_input_binary+&_num_input_nominal+&_num_input_ordinal);
98528     +   %let _num_input_total = %eval(&_num_input_interval+&_num_input_class);
98530     +   %if (&EM_PROPERTY_INCLUDECLASSVAR eq Y) %then %do;
98531     +        %if  &_num_input_total < 2 %then %do;
98532     +            %let  EMEXCEPTIONSTRING = exception.server.METADATA.USEATLEAST2INPUTREJECT;
98533     +            %let error = 2;
98534     +            %goto endtrain;
98535     +        %end;
98536     +   %end;
98537     +   %else %do;
98538     +         %if  &_num_input_interval < 2 %then %do;
98539     +         %let  EMEXCEPTIONSTRING = exception.server.METADATA.USEATLEAST2INPUTREJECT;
98540     +         %let error = 2;
98541     +         %goto endtrain;
98542     +         %end;
98543     +   %end;
98545     +   %em_checkerror();
98547     +   %if &EMEXCEPTIONSTRING ne %then %do;
98548     +       %goto endtrain;
98549     +   %end;
98551     +   %if (&EM_PROPERTY_INCLUDECLASSVAR eq Y) and (&_num_input_class > 0) %then %do;
98553     +        %EM_GETNAME(key=OUTDUMMY, type=DATA);
98554     +        %MakeDummyVariables( indata=&EM_IMPORT_DATA,
98555     +                             outvar=&EM_USER_OUTDUMMY,
98556     +                             outdata=_newtrainds,
98557     +                             fileref=&EM_FILE_EMFLOWSCORECODE);
98559     +       %if &EM_PROPERTY_SUPPRESSSAMPWARN eq N %then %do;
98560     +           %getNObs(inds=_newtrainds, nobs=_varclus_nobs);
98561     +            %if &_varclus_nobs > &VARCLUS_MAXNUMOBS  %then %do;
98562     +                proc datasets lib=work nolist;
98563     +                delete  _newtrainds;
98564     +                run;
98565     +                quit;
98566     +                %let  EMEXCEPTIONSTRING = exception.server.varclus.sample.warning;
98567     +                %let error = 3;
98568     +               %goto endtrain;
98569     +            %end;
98570     +        %end;
98572     +        %if &EM_PROPERTY_TWOSTAGECLUS eq AUTO %then %do;
98573     +             %getNVar(inds=_newtrainds, nvar=_nvar);
98575     +            %if &_nvar > &VARCLUS_MAXNUMVAR %then %do;
98576     +                %let trainnum = 2;
98577     +            %end;
98578     +            %else %do;
98579     +                %let trainnum = 1;
98580     +            %end;
98581     +        %end;
98582     +    %end;
98583     +    %else %do;
98585     +          %if &EM_PROPERTY_SUPPRESSSAMPWARN eq N %then %do;
98587     +            %getNObs(inds=&EM_IMPORT_DATA, nobs=_varclus_nobs);
98589     +            %if &_varclus_nobs > &VARCLUS_MAXNUMOBS  %then %do;
98591     +                 %let  EMEXCEPTIONSTRING = exception.server.varclus.sample.warning;
98592     +                  %let error = 3;
98593     +                 %goto endtrain;
98594     +            %end;
98595     +        %end;
98598     +         %if &EM_PROPERTY_TWOSTAGECLUS eq AUTO %then %do;
98599     +            /*%getNVar(inds=&EM_IMPORT_DATA, nvar=_nvar);
98600     +              %if &_nvar > &VARCLUS_MAXNUMVAR %then %do;*/
98601     +            %if &EM_NUM_INTERVAL_INPUT > &VARCLUS_MAXNUMVAR %then %do;
98602     +                %let trainnum = 2;
98603     +            %end;
98604     +            %else %do;
98605     +                %let trainnum = 1;
98606     +            %end;
98607     +        %end;
98609     +   %end;
98611     +    %em_checkerror();
98613     +    %if &EMEXCEPTIONSTRING ne %then %do;
98614     +       %let error = 4;
98615     +       %goto endtrain;
98616     +    %end;
98618     +    %CreateVarclusMeta(trainnum=&trainnum);
98620     +    %if &error > 0 %then  %goto endtrain;
98622     +       /* when only EM_PROPERTY_TWOSTAGECLUS eq AUTO &_triannum will be 1 or 2  */
98624     +       %if (&trainnum = 1 ) or %upcase(&EM_PROPERTY_TWOSTAGECLUS) = NO %then %do;
98625     +           %train1;
98626     +       %end;
98627     +       %if (&trainnum = 2 ) or %upcase(&EM_PROPERTY_TWOSTAGECLUS) = YES %then %do;
98628     +           %train2;
98629     +       %end;
98631     +      filename _in  "&EM_FILE_EMFLOWSCORECODE";
98632     +      filename _out "&EM_FILE_EMPUBLISHSCORECODE";
98633     +      %em_copyfile(infref=_in, outfref=_out);
98634     +      filename _in;
98635     +      filename _out;
98638     +   %endtrain:
98641     +%mend train;
NOTE: %INCLUDE (level 1) ending.
MPRINT(MAIN):   filename temp;
NOTE: Fileref TEMP has been deassigned.
MPRINT(TRAIN):   filename temp catalog 'sashelp.emexpl.variableclustering_train1.source';
NOTE: %INCLUDE (level 1) file TEMP is file SASHELP.EMEXPL.VARIABLECLUSTERING_TRAIN1.SOURCE.
98643     +%macro VarClus(indata=,
98644     +               outstat=,
98645     +               outtree=,
98646     +               vars=,
98647     +               freq=,
98648     +               weight=,
98649     +               includeclassvar=
98650     +               );
98652     +   %if &vars eq %then
98653     +       %let vars = %EM_INTERVAL_INPUT %EM_INTERVAL_REJECTED;
98655     +       proc varclus data = &indata outstat= &outstat
98656     +        %if %upcase(&EM_PROPERTY_CLUSCOMP) eq CENTROID %then %do; centroid %end;
98657     +        %if %upcase(&EM_PROPERTY_CLUSSOURCE) eq COV %then %do; cov %end;
98658     +        %if %upcase(&EM_PROPERTY_CLUSHIERACHY) eq Y %then %do; hi %end;
98659     +        %if %upcase(&EM_PROPERTY_MAXCLUS) ne DEFAULT %then %do;
98660     +            %let maxc = %sysevalf(&EM_PROPERTY_MAXCLUS, int);
98661     +            %if &maxc > 1 %then %do;     maxc=&maxc %end;
98662     +       %end;
98664     +       %if (%upcase(&EM_PROPERTY_CLUSCOMP) ne CENTROID) and (%upcase(&EM_PROPERTY_MAXEIGEN) ne DEFAULT) %then %do;
98665     +            maxeigen = &EM_PROPERTY_MAXEIGEN
98666     +       %end;
98668     +       %if %upcase(&EM_PROPERTY_PROPORTION) ne DEFAULT %then %do;
98669     +            proportion = &EM_PROPERTY_PROPORTION
98670     +       %end;
98671     +       %if %upcase(&EM_PROPERTY_PRINTOPTION) eq SUMMARY %then %do;
98672     +               summary
98673     +       %end;
98675     +       %if %upcase(&EM_PROPERTY_PRINTOPTION) eq SHORT %then %do;
98676     +           short
98677     +       %end;
98678     +        %if %upcase(&EM_PROPERTY_PRINTOPTION) eq ALL %then %do;
98679     +           corr trace simple
98680     +       %end;
98681     +       %if %upcase(&EM_PROPERTY_PRINTOPTION) eq NONE %then %do;
98682     +          noprint
98683     +       %end;
98684     +       outtree=&outtree
98685     +       ;
98686     +       var %EM_INTERVAL_INPUT %EM_INTERVAL_REJECTED
98688     +      %if &includeclassvar eq Y %then %do;
98689     +          %let dsid = %sysfunc(open(&EM_USER_OUTDUMMY));
98690     +          %if &dsid > 0 %then %do;
98691     +             %let nvar = %sysfunc(attrn(&dsid, NVAR));
98692     +              %do i = 2 %to &nvar;
98693     +                  %let varname = %sysfunc(varname(&dsid, &i));
98694     +                   &varname
98695     +              %end;
98697     +          %end;
98698     +      %end;
98700     +      ;
98701     +      /*------------------------
98702     +      %if &freq ne  %then %do;
98703     +          freq &freq;
98704     +      %end;
98705     +      %if &weight ne  %then %do;
98706     +          weight &weight;
98707     +      %end;
98708     +      ----------------------------*/
98709     +      %if %EM_FREQ ne %then %do;
98710     +           Freq %EM_FREQ;
98711     +      %end;
98712     +      ;
98713     +    run;
98714     +    %endline:
98715     +    quit;
98716     +%mend VarClus;
98718     +%macro Train1;
98720     +   %EM_GETNAME(key=OUTCORRPLOT, type=DATA) ;
98721     +   %EM_GETNAME(key=OUTCORR, type=DATA) ;
98722     +   %EM_GETNAME(key=OUTSTAT, type=DATA) ;
98723     +   %EM_GETNAME(key=OUTGROUP, type=DATA) ;
98724     +   %EM_GETNAME(key=OUTSTATPLOT, type=DATA) ;
98725     +   %EM_GETNAME(key=OUTTREE, type=DATA) ;
98726     +   %EM_GETNAME(key=OUTRSQUARE, type=DATA) ;
98727     +   %EM_GETNAME(key=OUTCLUSSTRUCT, type=DATA) ;
98728     +   %EM_GETNAME(key=OUTCLUSCORR, type=DATA) ;
98729     +   %EM_GETNAME(key=OUTCLUSCORRPLOT, type=DATA) ;
98730     +   %EM_GETNAME(key=OUTCLUSRSQUARE, type=DATA) ;
98731     +   %EM_GETNAME(key=OUTLINK, type=DATA) ;
98732     +   %EM_GETNAME(key=OUTNODE, type=DATA) ;
98734     +   /*
98735     +     %let VARCLUS_MAXNUMOBS = 100;
98736     +     %let VARCLUS_MAXNUMVAR = 200;
98737     +   */
98739     +   /* Train
98741     +   %if &EM_IMPORT_DATA eq %then %do;
98742     +       %let  EMEXCEPTIONSTRING = exception.server.IMPORT.NOTRAIN,1;
98743     +       %goto endtrain1;
98744     +   %end;
98746     +   %if  &EM_NUM_INTERVAL_INPUT < 2 %then %do;
98747     +        %let  EMEXCEPTIONSTRING = exception.server.METADATA.USEATLEAST2INPUTREJECT;
98748     +        %goto endtrain1;
98749     +   %end;
98750     +   */
98751     +   %if &EM_PROPERTY_INCLUDECLASSVAR eq Y %then %do;
98752     +       /* moved this to pretrain ------------
98754     +        %EM_GETNAME(key=OUTDUMMY, type=DATA);
98755     +        %MakeDummyVariables( indata=&EM_IMPORT_DATA,
98756     +                             outvar=&EM_USER_OUTDUMMY,
98757     +                             outdata=_newtrainds,
98758     +                             fileref=&EM_FILE_EMFLOWSCORECODE);
98760     +        %if &EM_PROPERTY_SUPPRESSSAMPWARN eq N %then %do;
98761     +            %getNVarNObs(inds=_newtrainds, nvar=_nvar, nobs=_nobs);
98762     +            %if &_nobs > &VARCLUS_MAXNUMOBS ne %then %do;
98763     +                %let  EMEXCEPTIONSTRING = exception.server.varclus.sample.warning
98764     +                %goto endtrain;
98765     +            %end;
98766     +        %end;
98768     +        +-------------------------------------*/
98770     +        %if (%sysfunc(exist(_newtrainds)) or %sysfunc(exist(_newtrainds, VIEW))) < 1 %then %do;
98771     +        /*when there is no class var and &EM_PROPERTY_INCLUDECLASSVAR eq Y
98772     +          There is no _newtrainds */
98773     +         %VarClus( indata=&EM_IMPORT_DATA,
98774     +                  outstat=&EM_USER_OUTSTAT,
98775     +                  outtree = &EM_USER_OUTTREE,
98776     +                  includeclassvar=N
98777     +                 );
98778     +        %end;
98779     +        %else %do;
98780     +        %VarClus( indata=_newtrainds,
98781     +                  outstat=&EM_USER_OUTSTAT,
98782     +                  outtree = &EM_USER_OUTTREE,
98783     +                  includeclassvar=Y
98784     +                 );
98785     +         proc datasets lib=work nolist;
98786     +              delete  _newtrainds;
98787     +         run;
98788     +         %end;
98789     +    %end;
98790     +    %else %do;
98792     +        /*----- moved this to pretrain ------------
98793     +        %if &EM_PROPERTY_SUPPRESSSAMPWARN eq N %then %do;
98794     +            %getNVarNObs(inds=&EM_IMPORT_DATA, nvar=_nvar, nobs=_nobs);
98795     +            %if &_nobs > &VARCLUS_MAXNUMOBS ne %then %do;
98796     +                 %let  EMEXCEPTIONSTRING = exception.server.varclus.sample.warning;
98797     +                 %goto endtrain;
98798     +            %end;
98799     +        %end;
98800     +        +-------------------------------------*/
98802     +        %VarClus(indata=&EM_IMPORT_DATA,
98803     +                  outstat=&EM_USER_OUTSTAT,
98804     +                  outtree =&EM_USER_OUTTREE,
98805     +                  includeclassvar=N
98806     +               );
98808     +   %end;
98810     +   %em_checkerror();
98812     +   %if &EMEXCEPTIONSTRING ne %then %do;
98813     +       %goto endtrain1;
98814     +   %end;
98815     +    /*
98816     +    %FindClusNum(statds=&EM_USER_OUTSTAT, groupds=&EM_USER_OUTGROUP, minvariation=&EM_PROPERTY_MINVARIATION);
98817     +    */
98819     +    %getNclusfromTrain(inoutstat=&EM_USER_OUTSTAT, nc=_nclus);
98821     +    %let gid=;
98823     +    /*--- To make the main result table ----------------------*/
98825     +    %MakeInterClusCorrData(indata=&EM_USER_OUTSTAT, globalclusid=&gid, outdata=&EM_USER_OUTCLUSCORR, ncluster=&_nclus, RSquare=Y);
98826     +    %FindNextClosestClusByCluster(indata=&EM_USER_OUTCLUSCORR, outdata=_nextClusRSq, globalclusid=&gid, ncluster=&_nclus);
98827     +    %MakeOwnRSquare(indata=&EM_USER_OUTSTAT, globalclusid=&gid, outdata=_ownRsq, ncluster=&_nclus);
98828     +    %MakeClusStructCorrData(indata=&EM_USER_OUTSTAT, globalclusid=&gid, outdata=&EM_USER_OUTCLUSSTRUCT , ncluster=&_nclus, Rsquare=Y);
98829     +    %FindNextClosestClusByVar(indata=&EM_USER_OUTCLUSSTRUCT, outdata=_nextVarRSq, globalclusid=&gid, ncluster=&_nclus);
98830     +    %MakeVarClusResultTable(indata1=_ownRsq, indata2=_nextVarRsq, indata3=_nextClusRSq, outdata=&EM_USER_OUTRSQUARE, globalclusid=&gid, ncluster=&_nclus, selectedcomp=&EM_PROPERTY_EXPORTEDCOMP);
98832     +   /* Inter Cluster Correlation Plot ------------------------*/
98834     +    %MakeInterClusCorrData(indata=&EM_USER_OUTSTAT, globalclusid=&gid, outdata=&EM_USER_OUTCLUSCORRPLOT, ncluster=&_nclus, RSquare=N);
98835     +    %MakePlotDataFromCorrTable(indata=&EM_USER_OUTCLUSCORRPLOT, outdata=&EM_USER_OUTCLUSCORRPLOT, globalclusid=&gid);
98837     +   /* Create some other data sets for results ----*/
98839     +   %MakeStatPlotData(statds=&EM_USER_OUTSTAT , outstatplotds=&EM_USER_OUTSTATPLOT);
98840     +   %MakeVarClusCorrData(statds=&EM_USER_OUTSTAT, corrds=&EM_USER_OUTCORR, corrplotds=&EM_USER_OUTCORRPLOT);
98841     +   %MakeClusConstellData(indata=&EM_USER_OUTRSQUARE, outlink=&EM_USER_OUTLINK, outnode=&EM_USER_OUTNODE);
98843     +  /*---- move this to Score action ------------
98844     +   %MakeDeltaCode(groupds=&EM_USER_OUTRSQUARE, DeltaCodeFile=&EM_FILE_CDELTA_TRAIN);
98845     +   */
98847     +   /* create score code at training time */
98848     +   %CreateScoreCode(indata=&EM_USER_OUTSTAT, ncluscomp=&_nclus, fileref=&EM_FILE_EMFLOWSCORECODE);
98849     +   %endtrain1:
98850     +%mend Train1;
NOTE: %INCLUDE (level 1) ending.
MPRINT(TRAIN):   filename temp catalog 'sashelp.emexpl.variableclustering_train2.source';
NOTE: %INCLUDE (level 1) file TEMP is file SASHELP.EMEXPL.VARIABLECLUSTERING_TRAIN2.SOURCE.
98853     +%macro VarClus2( indata=,
98854     +                 outdata=,
98855     +                 outstat =outstat,
98856     +                 outrsquare=outrsquare,
98857     +                 outtree = outtree,
98858     +                 outclusstruct = outclusstruct,
98859     +                 outcluscorr =outcluscorr,
98860     +                 outcluscorrplot =outcluscorrplot,
98861     +                 outclusrsquare =outclusrsquare,
98862     +                 outstatplot = outstatplot,
98863     +                 outcorr = outcorr,
98864     +                 outcorrplot = outcorrplot,
98865     +                 clusdata=,
98866     +                 outnode=outnode,
98867     +                 outlink=outlink,
98868     +                 ngroup =1  );
98869     +         %if (%sysfunc(exist(&indata)) or %sysfunc(exist(&indata, VIEW))) < 1 %then %do;
98870     +              %let  EMEXCEPTIONSTRING = exception.server.IMPORT.NOTRAIN,1;
98871     +              %goto endline;
98872     +         %end;
98874     +        %global numglobalcluster;
98875     +        %let  numglobalcluster = &ngroup;
98876     +        %let  gscorefile =  %bquote(&EM_NODEDIR)&EM_DSEP.gclusterscore.sas;
98877     +        %do vci =1 %to &ngroup;
98878     +           data tmp_clusdata;
98879     +                set &clusdata;
98880     +                if CLUSTER ne &vci then delete;
98881     +           run;
98882     +           %let outstatds = &outstat.&vci;
98883     +           %let outrsquareds = &outrsquare.&vci;
98884     +           %let outtreeds = &outtree.&vci;
98885     +           %let outclusstuctds = &outclusstruct.&vci;
98886     +           %let outcluscorrds = &outcluscorr.&vci;
98887     +           %let outcluscorrplotds = &outcluscorrplot.&vci;
98888     +           %let outclusrsquareds = &outclussquare.&vci;
98889     +           %let outstatplotds = &outstatplot.&vci;
98890     +           %let outcorrds = &outcorr.&vci;
98891     +           %let outcorrplotds = &outcorrplot.&vci;
98892     +           %let outnodeds = &outnode.&vci;
98893     +           %let outlinkds = &outlink.&vci;
98895     +           %EM_REGISTER(KEY=&outstatds, TYPE=DATA);
98896     +           %EM_GETNAME(KEY=&outstatds, TYPE=DATA);
98897     +           %let emuseroutstat = &EM_USER_&outstatds;
98899     +           %EM_REGISTER(KEY=&outtreeds, TYPE=DATA);
98900     +           %EM_GETNAME(KEY=&outtreeds, TYPE=DATA);
98901     +           %let emuserouttree = &EM_USER_&outtreeds;
98903     +           %EM_REGISTER(KEY=&outcluscorrds, TYPE=DATA);
98904     +           %EM_GETNAME(KEY=&outcluscorrds, TYPE=DATA);
98905     +           %let emuseroutcluscorr = &EM_USER_&outcluscorrds;
98907     +           %EM_REGISTER(KEY=&outclusstuctds, TYPE=DATA);
98908     +           %EM_GETNAME(KEY=&outclusstuctds, TYPE=DATA);
98909     +           %let emuseroutclusstruct = &EM_USER_&outclusstuctds;
98911     +           %EM_REGISTER(KEY=&outrsquareds, TYPE=DATA);
98912     +           %EM_GETNAME(KEY=&outrsquareds, TYPE=DATA);
98913     +           %let emuseroutrsquare = &EM_USER_&outrsquareds;
98915     +           %EM_REGISTER(KEY=&outcluscorrplotds, TYPE=DATA);
98916     +           %EM_GETNAME(KEY=&outcluscorrplotds, TYPE=DATA);
98917     +           %let emuseroutcluscorrplot = &EM_USER_&outcluscorrplotds;
98919     +           %EM_REGISTER(KEY=&outstatplotds, TYPE=DATA);
98920     +           %EM_GETNAME(KEY=&outstatplotds, TYPE=DATA);
98921     +           %let emuseroutstatplot = &EM_USER_&outstatplotds;
98923     +           %EM_REGISTER(KEY=&outcorrds, TYPE=DATA);
98924     +           %EM_GETNAME(KEY=&outcorrds, TYPE=DATA);
98925     +           %let emuseroutcorr = &EM_USER_&outcorrds;
98927     +           %EM_REGISTER(KEY=&outcorrplotds, TYPE=DATA);
98928     +           %EM_GETNAME(KEY=&outcorrplotds, TYPE=DATA);
98929     +           %let emuseroutcorrplot = &EM_USER_&outcorrplotds;
98931     +           %EM_REGISTER(KEY=&outnodeds, TYPE=DATA);
98932     +           %EM_GETNAME(KEY=&outnodeds, TYPE=DATA);
98933     +           %let emuseroutnode = &EM_USER_&outnodeds;
98935     +           %EM_REGISTER(KEY=&outlinkds, TYPE=DATA);
98936     +           %EM_GETNAME(KEY=&outlinkds, TYPE=DATA);
98937     +           %let emuseroutlink = &EM_USER_&outlinkds;
98939     +           proc varclus data=&indata outstat=&emuseroutstat
98940     +            %if %upcase(&EM_PROPERTY_CLUSCOMP) eq CENTROID %then %do; centroid %end;
98941     +            %if %upcase(&EM_PROPERTY_CLUSSOURCE) eq COV %then %do; cov %end;
98942     +            %if %upcase(&EM_PROPERTY_CLUSHIERACHY) eq Y %then %do; hi %end;
98943     +            %if %upcase(&EM_PROPERTY_MAXCLUS) ne DEFAULT %then %do;
98944     +                %let maxc = %sysevalf(&EM_PROPERTY_MAXCLUS, int);
98945     +                %if &maxc > 1 %then %do;     maxc=&maxc %end;
98946     +           %end;
98948     +            %if (%upcase(&EM_PROPERTY_CLUSCOMP) ne CENTROID) and (%upcase(&EM_PROPERTY_MAXEIGEN) ne DEFAULT) %then %do;
98949     +            maxeigen = &EM_PROPERTY_MAXEIGEN
98950     +            %end;
98952     +           %if %upcase(&EM_PROPERTY_PROPORTION) ne DEFAULT %then %do;
98953     +                proportion = &EM_PROPERTY_PROPORTION
98954     +           %end;
98955     +           %if %upcase(&EM_PROPERTY_PRINTOPTION) eq SUMMARY %then %do;
98956     +               summary
98957     +           %end;
98958     +           %if %upcase(&EM_PROPERTY_PRINTOPTION) eq SHORT %then %do;
98959     +               short
98960     +           %end;
98961     +            %if %upcase(&EM_PROPERTY_PRINTOPTION) eq ALL %then %do;
98962     +               corr trace simple
98963     +           %end;
98964     +           %if %upcase(&EM_PROPERTY_PRINTOPTION) eq NONE %then %do;
98965     +               noprint
98966     +           %end;
98967     +              outtree=&emuserouttree
98968     +           ;
98969     +           var
98970     +           %let dsid=%sysfunc(open(work.tmp_clusdata));
98971     +           %let vn_name =%sysfunc(varnum(&dsid, VARIABLE));
98972     +                %do %while(^%sysfunc(fetch(&dsid)));
98973     +                    %let _varname= %sysfunc(getvarc(&dsid, &vn_name));
98974     +                    &_varname
98975     +                %end;
98976     +            %let dsid = %sysfunc(close(&dsid));
98977     +           ;
98978     +           %if %EM_FREQ ne %then %do;
98979     +           Freq %EM_FREQ;
98980     +           %end;
98981     +           run;
98983     +            %getNclusfromTrain(inoutstat=&emuseroutstat, nc=_nclus);
98985     +            %let gid=&vci;
98986     +            /*--- To make the main result table ----------------------*/
98987     +            %MakeInterClusCorrData(indata=&emuseroutstat, globalclusid=&gid, outdata=&emuseroutcluscorr, ncluster=&_nclus, RSquare=Y);
98988     +            %FindNextClosestClusByCluster(indata=&emuseroutcluscorr, outdata=_nextClusRSq, globalclusid=&gid, ncluster=&_nclus);
98989     +            %MakeOwnRSquare(indata=&emuseroutstat, globalclusid=&gid, outdata=_ownRsq, ncluster=&_nclus);
98990     +            %MakeClusStructCorrData(indata=&emuseroutstat, globalclusid=&gid, outdata=&emuseroutclusstruct , ncluster=&_nclus, Rsquare=Y);
98991     +            %FindNextClosestClusByVar(indata=&emuseroutclusstruct, outdata=_nextVarRSq, globalclusid=&gid, ncluster=&_nclus);
98992     +            %MakeVarClusResultTable(indata1=_ownRsq, indata2=_nextVarRsq, indata3=_nextClusRSq, outdata=&emuseroutrsquare, globalclusid=&gid, ncluster=&_nclus, selectedcomp=&EM_PROPERTY_EXPORTEDCOMP);
98994     +            /* Inter Cluster Correlation Plot ------------------------*/
98996     +            %MakeInterClusCorrData(indata=&emuseroutstat, globalclusid=&gid, outdata=&emuseroutcluscorrplot, ncluster=&_nclus, RSquare=N);
98997     +            %MakePlotDataFromCorrTable(indata=&emuseroutcluscorrplot, outdata=&emuseroutcluscorrplot, globalclusid=&gid);
98999     +           /* Create some other data sets for results ---------------*/
99001     +           %MakeStatPlotData(statds=&emuseroutstat , outstatplotds=&emuseroutstatplot);
99002     +           %MakeVarClusCorrData(statds=&emuseroutstat, corrds=&emuseroutcorr, corrplotds=&emuseroutcorrplot);
99003     +           %MakeClusConstellData(indata=&emuseroutrsquare, outlink=&emuseroutlink, outnode=&emuseroutnode);
99005     +           %CreateScoreCode2(indata=&emuseroutstat, ncluscomp=&_nclus, globalclusid=&gid, fileref=&EM_FILE_EMFLOWSCORECODE);
99007     +           %CreateGClusterScoreCode(indata=&emuseroutstat,  globalclusid=&gid, fileref=&gscorefile);
99009     +           %if &vci = 1 %then %do;
99010     +           data &EM_USER_OUTRSQUARE;
99011     +                set &emuseroutrsquare;
99012     +           run;
99013     +           %end;
99014     +           %else %do;
99015     +           data &EM_USER_OUTRSQUARE;
99016     +                set &EM_USER_OUTRSQUARE &emuseroutrsquare;
99017     +           run;
99018     +           %end;
99019     +           quit;
99020     +       %end;
99022     +       /*---- move this to Score action ------------
99023     +       %MakeDeltaCode2(groupds=&EM_USER_OUTRSQUARE, DeltaCodeFile=&EM_FILE_CDELTA_TRAIN);
99024     +       */
99026     +       /* Make Score Gcluster component & correlation  */
99027     +       %MakeGClusterCorrelation(Indata=&indata, ngcluster=&ngroup, gscorecode=&gscorefile, outrsquare=&EM_USER_OUTRSQUARE);
99029     +       quit;
99030     +       %endline:
99031     +%mend VarClus2;
99034     +%macro Train2;
99036     +   %EM_GETNAME(key=OUTCORRPLOT, type=DATA) ;
99037     +   %EM_GETNAME(key=OUTCORR, type=DATA) ;
99038     +   %EM_GETNAME(key=OUTSTAT, type=DATA) ;
99039     +   %EM_GETNAME(key=OUTGROUP, type=DATA) ;
99040     +   %EM_GETNAME(key=OUTSTATPLOT, type=DATA) ;
99041     +   %EM_GETNAME(key=OUTTREE, type=DATA) ;
99042     +   %EM_GETNAME(key=OUTRSQUARE, type=DATA) ;
99043     +   %EM_GETNAME(key=OUTCLUSSTRUCT, type=DATA) ;
99044     +   %EM_GETNAME(key=OUTCLUSCORR, type=DATA) ;
99045     +   %EM_GETNAME(key=OUTCLUSCORRPLOT, type=DATA) ;
99046     +   %EM_GETNAME(key=OUTCLUSRSQUARE, type=DATA) ;
99047     +   %EM_GETNAME(key=GOUTSTAT, type=DATA) ;
99048     +   %EM_GETNAME(key=GOUTTREE, type=DATA) ;
99049     +   %EM_GETNAME(key=GOUTCORR, type=DATA) ;
99050     +   %EM_GETNAME(key=GOUTGROUP, type=DATA) ;
99051     +   %EM_GETNAME(key=GOUTNODE, type=DATA) ;
99052     +   %EM_GETNAME(key=GOUTLINK, type=DATA) ;
99053     +   %EM_GETNAME(key=VARCLUSMETA, type=DATA) ;
99057     +    /* Train */
99059     +   /* moved to pretrain ------------
99061     +   %if &EM_IMPORT_DATA eq %then %do;
99062     +       %let  EMEXCEPTIONSTRING = exception.server.IMPORT.NOTRAIN,1;
99063     +       %goto endtrain2;
99064     +   %end;
99066     +   %if  &EM_NUM_INTERVAL_INPUT < 2 %then %do;
99067     +        %let  EMEXCEPTIONSTRING = exception.server.METADATA.USEATLEAST2INPUTREJECT;
99068     +        %goto endtrain2;
99069     +   %end;
99070     +   +-------------------------------------------*/
99072     +    %let _num_input_interval = %eval(&EM_NUM_INTERVAL_INPUT+&EM_NUM_INTERVAL_REJECTED);
99075     +    %if &EM_PROPERTY_INCLUDECLASSVAR eq Y %then %do;
99077     +        /*----- moved to pretrain ------------
99079     +        %EM_GETNAME(key=OUTDUMMY, type=DATA);
99080     +        %MakeDummyVariables( indata=&EM_IMPORT_DATA,
99081     +                             outvar=&EM_USER_OUTDUMMY,
99082     +                             outdata=_newtrainds,
99083     +                             fileref=&EM_FILE_EMFLOWSCORECODE,
99084     +                              ndummyvars=_ndummyvars
99085     +                            );
99087     +        %if &EM_PROPERTY_SUPPRESSSAMPWARN eq N %then %do;
99088     +            %getNVarNObs(inds=_newtrainds, nvar=_nvar, nobs=_nobs);
99089     +            %if &_nobs > &VARCLUS_MAXNUMOBS  %then %do;
99090     +                %let  EMEXCEPTIONSTRING = exception.server.varclus.sample.warning
99091     +                %goto endtrain;
99092     +            %end;
99093     +        %end;
99095     +        +---------------------------------------*/
99096     +        %if (%sysfunc(exist(_newtrainds)) or %sysfunc(exist(_newtrainds, VIEW))) < 1 %then %do;
99097     +        /*when there is no class var and &EM_PROPERTY_INCLUDECLASSVAR eq Y
99098     +          There is no _newtrainds */
99099     +        %MakeCorrelation(    indata=&EM_IMPORT_DATA,
99100     +                             outstat=&EM_USER_GOUTSTAT,
99101     +                             corrmatrix=Y,
99102     +                             outcorr=&EM_USER_GOUTCORR,
99103     +                             includeclassvar=N,
99104     +                             freq =%EM_FREQ
99105     +                          );
99106     +        %getInitialGClusterNumber(ninput=&_num_input_interval, ngc=_ngc);
99108     +        %end;
99109     +        %else %do;
99110     +         %MakeCorrelation(   indata=_newtrainds,
99111     +                             outstat=&EM_USER_GOUTSTAT,
99112     +                             corrmatrix=Y,
99113     +                             outcorr=&EM_USER_GOUTCORR,
99114     +                             includeclassvar=Y,
99115     +                             freq =%EM_FREQ
99116     +                          );
99117     +        %getInitialGClusterNumber(ninput=&_num_input_interval, ndummy=&_ndummyvars, ngc=_ngc);
99119     +        %end;
99121     +    %end;
99122     +    %else %do;
99124     +        /* moved to pretrain -------------------
99126     +         %if &EM_PROPERTY_SUPPRESSSAMPWARN eq N %then %do;
99127     +            %getNVarNObs(inds=&EM_IMPORT_DATA, nvar=_nvar, nobs=_nobs);
99128     +            %if &_nobs > &VARCLUS_MAXNUMOBS  %then %do;
99129     +                %let  EMEXCEPTIONSTRING = exception.server.varclus.sample.warning
99130     +                %goto endtrain;
99131     +            %end;
99132     +        %end;
99133     +         +------------------------------------------*/
99135     +        %MakeCorrelation( indata=&EM_IMPORT_DATA,
99136     +                          outstat=&EM_USER_GOUTSTAT,
99137     +                          corrmatrix=Y,
99138     +                          outcorr=&EM_USER_GOUTCORR,
99139     +                          includeclassvar=N,
99140     +                          freq =%EM_FREQ
99141     +                          );
99142     +        %getInitialGClusterNumber(ninput=&_num_input_interval, ngc=_ngc);
99143     +    %end;
99145     +   %UpdateOutStatCorrToDistance(indata=&EM_USER_GOUTSTAT, /* indata should be a outstat from proc varclus */
99146     +                                rsquare = N
99147     +                                );
99148     +   %HierClusWithCorr( indata=&EM_USER_GOUTSTAT ,
99149     +                      ncluster=&_ngc,
99150     +                      method = Ward,
99151     +                      outtree =&EM_USER_GOUTTREE,
99152     +                      idvar = _VAR_,
99153     +                      outdata=&EM_USER_GOUTGROUP,
99154     +                      rescore = N,
99155     +                      newncluster=_newnclus
99156     +                        );
99158     +   /* store the number of global cluster */
99160     +   data &EM_USER_VARCLUSMETA;
99161     +        set &EM_USER_VARCLUSMETA;
99162     +        NGCluster = &_newnclus;
99163     +   run;
99165     +   %MakeGobalConstellData(indata=&EM_USER_GOUTGROUP, outlink=&EM_USER_GOUTLINK, outnode=&EM_USER_GOUTNODE);
99167     +   %if &EM_PROPERTY_INCLUDECLASSVAR eq Y %then %do;
99168     +        %if (%sysfunc(exist(_newtrainds)) or %sysfunc(exist(_newtrainds, VIEW))) < 1 %then %do;
99169     +            %VarClus2(indata=&EM_IMPORT_DATA,
99170     +                 clusdata=&EM_USER_GOUTGROUP,
99171     +                 ngroup=&_newnclus);
99172     +         %end;
99173     +         %else %do;
99174     +             %VarClus2(indata=_newtrainds,
99175     +                 clusdata=&EM_USER_GOUTGROUP,
99176     +                 ngroup=&_newnclus);
99178     +         %end;
99180     +   %end;
99181     +   %else %do;
99182     +       %VarClus2(indata=&EM_IMPORT_DATA,
99183     +                 clusdata=&EM_USER_GOUTGROUP,
99184     +                 ngroup=&_newnclus);
99185     +   %end;
99187     +   %em_checkerror();
99188     +   %if &EMEXCEPTIONSTRING ne %then %do;
99189     +       %put &em_codebar;
99190     +       %put Error: Variable clustering failed.;
99191     +       %put &em_codebar;
99192     +       %goto endtrain2;
99193     +   %end;
99194     +   /*
99195     +    %FindClusNum(statds=&EM_USER_OUTSTAT, groupds=&EM_USER_OUTGROUP, minvariation=&EM_PROPERTY_MINVARIATION);
99196     +   */
99197     +   %endtrain2:
99198     +%mend Train2;
NOTE: %INCLUDE (level 1) ending.
MPRINT(TRAIN):   filename temp catalog 'sashelp.emutil.em_copyfile.source';
NOTE: %INCLUDE (level 1) file TEMP is file SASHELP.EMUTIL.EM_COPYFILE.SOURCE.
99200     +%macro em_copyfile(infref=, outfref=, append=N);
99202     +   %if %sysfunc(fileref(&infref))=0 and %sysfunc(fileref(&outfref))<=0 %then %do;
99204     +       %let omode =;
99205     +       %if &append=Y %then
99206     +           %let omode = MOD;
99207     +       data _null_;
99208     +          length line $20000;
99209     +          file &outfref &omode lrecl=20000;
99210     +          fid=fopen("&infref",'i',20000,'v');
99211     +          if fid > 0  then do;
99212     +             do while(^fread(fid));
99213     +                rlen = frlen(fid);
99214     +                rc= fget(fid,line,20000);
99215     +                start = length(line)-length(left(line))+1;
99216     +                line=strip(line);
99217     +                put @start line;
99218     +             end;
99219     +             if fid > 0  then rc=fclose(fid);
99220     +          end;
99221     +       run;
99223     +   %end;
99224     +%mend em_copyfile;
NOTE: %INCLUDE (level 1) ending.
MPRINT(TRAIN):   filename temp;
NOTE: Fileref TEMP has been deassigned.
MPRINT(EM_CHECKERROR):   proc display c=sashelp.emutil.checkerror.scl;
MPRINT(EM_CHECKERROR):   run;
 
99225      %let SYSCC = 0;
NOTE: PROCEDURE DISPLAY used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
 
 
MPRINT(EM_CHECKERROR):
MPRINT(TRAIN):  ;
MPRINT(GETNOBS):   data _null_;
MPRINT(GETNOBS):   set EMWS8.Part_TRAIN end=eof;
MPRINT(GETNOBS):   if eof then call symput("_varclus_nobs", _N_);
MPRINT(GETNOBS):   run;
 
NOTE: Numeric values have been converted to character values at the places given by: (Line):(Column).
      15:34
NOTE: There were 2374 observations read from the data set EMWS8.PART_TRAIN.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
 
 
MPRINT(GETNOBS):   quit;
MPRINT(TRAIN):  ;
MPRINT(EM_CHECKERROR):   proc display c=sashelp.emutil.checkerror.scl;
MPRINT(EM_CHECKERROR):   run;
 
99226      %let SYSCC = 0;
NOTE: PROCEDURE DISPLAY used (Total process time):
      real time           0.01 seconds
      cpu time            0.01 seconds
 
 
MPRINT(EM_CHECKERROR):
MPRINT(TRAIN):  ;
MPRINT(CREATEVARCLUSMETA):  ;
MPRINT(CREATEVARCLUSMETA):   data EMWS8.VarClus_VARCLUSMETA;
MPRINT(CREATEVARCLUSMETA):   length TrainNum 8.;
MPRINT(CREATEVARCLUSMETA):   length NewTrain $8;
MPRINT(CREATEVARCLUSMETA):   length NGCluster 8.;
MPRINT(CREATEVARCLUSMETA):   length ExportedComp $16;
MPRINT(CREATEVARCLUSMETA):   length HideVariable $8;
MPRINT(CREATEVARCLUSMETA):   TrainNum = 1;
MPRINT(CREATEVARCLUSMETA):   NewTrain = "Y";
MPRINT(CREATEVARCLUSMETA):   ExportedComp = "CLUSTERCOMP";
MPRINT(CREATEVARCLUSMETA):   HideVariable = "Y";
MPRINT(CREATEVARCLUSMETA):   NGCluster = 0;
MPRINT(CREATEVARCLUSMETA):   run;
 
NOTE: The data set EMWS8.VARCLUS_VARCLUSMETA has 1 observations and 5 variables.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
 
 
MPRINT(CREATEVARCLUSMETA):   quit;
MPRINT(TRAIN):  ;
MPRINT(TRAIN1):   ;
MPRINT(TRAIN1):   ;
MPRINT(TRAIN1):   ;
MPRINT(TRAIN1):   ;
MPRINT(TRAIN1):   ;
MPRINT(TRAIN1):   ;
MPRINT(TRAIN1):   ;
MPRINT(TRAIN1):   ;
MPRINT(TRAIN1):   ;
MPRINT(TRAIN1):   ;
MPRINT(TRAIN1):   ;
MPRINT(TRAIN1):   ;
MPRINT(TRAIN1):   ;
MPRINT(VARCLUS):   proc varclus data = EMWS8.Part_TRAIN outstat= EMWS8.VarClus_OUTSTAT hi maxc=8 short outtree=EMWS8.VarClus_OUTTREE ;
MPRINT(VARCLUS):   var
MPRINT(EM_INTERVAL_INPUT):   AcceptedCmpTotal Age Frq Income Kidhome Mnt MntFishProducts MntFruits MntGoldProds MntMeatProducts MntSweetProducts MntWines MonthsAsCustomer NumCatalogPurchases NumDealsPurchases NumDistPurchases NumStorePurchases
NumWebPurchases NumWebVisitsMonth RFMstat RMntFrq Recency Teenhome Year_Birth
MPRINT(VARCLUS):   ;
MPRINT(VARCLUS):   ;
MPRINT(VARCLUS):   run;
 
NOTE: Clustering algorithm converged.
NOTE: Clustering algorithm converged.
NOTE: Clustering algorithm converged.
NOTE: Clustering algorithm converged.
NOTE: Clustering algorithm converged.
NOTE: Clustering algorithm converged.
NOTE: Clustering algorithm converged.
NOTE: Clustering algorithm converged.
NOTE: The data set EMWS8.VARCLUS_OUTSTAT has 175 observations and 27 variables.
NOTE: The data set EMWS8.VARCLUS_OUTTREE has 35 observations and 8 variables.
NOTE: The PROCEDURE VARCLUS printed page 57.
NOTE: PROCEDURE VARCLUS used (Total process time):
      real time           0.01 seconds
      cpu time            0.01 seconds
 
 
MPRINT(VARCLUS):   quit;
MPRINT(TRAIN1):  ;
MPRINT(EM_CHECKERROR):   proc display c=sashelp.emutil.checkerror.scl;
MPRINT(EM_CHECKERROR):   run;
 
99227      %let SYSCC = 0;
NOTE: PROCEDURE DISPLAY used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
 
 
MPRINT(EM_CHECKERROR):
MPRINT(TRAIN1):  ;
MPRINT(GETNCLUSFROMTRAIN):   data _null_;
MPRINT(GETNCLUSFROMTRAIN):   set EMWS8.VarClus_OUTSTAT end=eof;
MPRINT(GETNCLUSFROMTRAIN):   if eof then do;
MPRINT(GETNCLUSFROMTRAIN):   call symput("_nclus", _ncl_);
MPRINT(GETNCLUSFROMTRAIN):   end;
MPRINT(GETNCLUSFROMTRAIN):   run;
 
NOTE: Numeric values have been converted to character values at the places given by: (Line):(Column).
      23:20
NOTE: There were 175 observations read from the data set EMWS8.VARCLUS_OUTSTAT.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
 
 
MPRINT(TRAIN1):  ;
MPRINT(MAKEINTERCLUSCORRDATA):   data EMWS8.VarClus_OUTCLUSCORR(drop= _NCL_ _TYPE_);
MPRINT(MAKEINTERCLUSCORRDATA):   set EMWS8.VarClus_OUTSTAT;
MPRINT(MAKEINTERCLUSCORRDATA):   if ^(strip(_NCL_) eq 8 and strip(_TYPE_) eq 'CCORR') then delete;
MPRINT(MAKEINTERCLUSCORRDATA):   _NAME_ = upcase(_NAME_);
MPRINT(MAKEINTERCLUSCORRDATA):   rename _NAME_ = Cluster;
MPRINT(MAKEINTERCLUSCORRDATA):   label _NAME_ = "Cluster Name";
MPRINT(MAKEINTERCLUSCORRDATA):   run;
 
NOTE: Numeric values have been converted to character values at the places given by: (Line):(Column).
      18:12
NOTE: Character values have been converted to numeric values at the places given by: (Line):(Column).
      18:6
NOTE: There were 175 observations read from the data set EMWS8.VARCLUS_OUTSTAT.
NOTE: The data set EMWS8.VARCLUS_OUTCLUSCORR has 8 observations and 25 variables.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
 
 
MPRINT(MAKEINTERCLUSCORRDATA):   data corr_tmp;
MPRINT(MAKEINTERCLUSCORRDATA):   set EMWS8.VarClus_OUTCLUSCORR;
MPRINT(MAKEINTERCLUSCORRDATA):   run;
 
NOTE: There were 8 observations read from the data set EMWS8.VARCLUS_OUTCLUSCORR.
NOTE: The data set WORK.CORR_TMP has 8 observations and 25 variables.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
 
 
MPRINT(MAKEINTERCLUSCORRDATA):   data EMWS8.VarClus_OUTCLUSCORR;
MPRINT(MAKEINTERCLUSCORRDATA):   set EMWS8.VarClus_OUTCLUSCORR;
MPRINT(MAKEINTERCLUSCORRDATA):   rename AcceptedCmpTotal = CLUS1;
MPRINT(MAKEINTERCLUSCORRDATA):   *label &_name ="Cluster &i_1";
MPRINT(MAKEINTERCLUSCORRDATA):   label AcceptedCmpTotal = "Cluster 1";
MPRINT(MAKEINTERCLUSCORRDATA):   rename Age = CLUS2;
MPRINT(MAKEINTERCLUSCORRDATA):   *label &_name ="Cluster &i_1";
MPRINT(MAKEINTERCLUSCORRDATA):   label Age = "Cluster 2";
MPRINT(MAKEINTERCLUSCORRDATA):   rename Frq = CLUS3;
MPRINT(MAKEINTERCLUSCORRDATA):   *label &_name ="Cluster &i_1";
MPRINT(MAKEINTERCLUSCORRDATA):   label Frq = "Cluster 3";
MPRINT(MAKEINTERCLUSCORRDATA):   rename Income = CLUS4;
MPRINT(MAKEINTERCLUSCORRDATA):   *label &_name ="Cluster &i_1";
MPRINT(MAKEINTERCLUSCORRDATA):   label Income = "Cluster 4";
MPRINT(MAKEINTERCLUSCORRDATA):   rename Kidhome = CLUS5;
MPRINT(MAKEINTERCLUSCORRDATA):   *label &_name ="Cluster &i_1";
MPRINT(MAKEINTERCLUSCORRDATA):   label Kidhome = "Cluster 5";
MPRINT(MAKEINTERCLUSCORRDATA):   rename Mnt = CLUS6;
MPRINT(MAKEINTERCLUSCORRDATA):   *label &_name ="Cluster &i_1";
MPRINT(MAKEINTERCLUSCORRDATA):   label Mnt = "Cluster 6";
MPRINT(MAKEINTERCLUSCORRDATA):   rename MntFishProducts = CLUS7;
MPRINT(MAKEINTERCLUSCORRDATA):   *label &_name ="Cluster &i_1";
MPRINT(MAKEINTERCLUSCORRDATA):   label MntFishProducts = "Cluster 7";
MPRINT(MAKEINTERCLUSCORRDATA):   rename MntFruits = CLUS8;
MPRINT(MAKEINTERCLUSCORRDATA):   *label &_name ="Cluster &i_1";
MPRINT(MAKEINTERCLUSCORRDATA):   label MntFruits = "Cluster 8";
MPRINT(MAKEINTERCLUSCORRDATA):   keep Cluster AcceptedCmpTotal Age Frq Income Kidhome Mnt MntFishProducts MntFruits ;
MPRINT(MAKEINTERCLUSCORRDATA):   run;
 
NOTE: There were 8 observations read from the data set EMWS8.VARCLUS_OUTCLUSCORR.
NOTE: The data set EMWS8.VARCLUS_OUTCLUSCORR has 8 observations and 9 variables.
NOTE: DATA statement used (Total process time):
      real time           0.01 seconds
      cpu time            0.01 seconds
 
 
MPRINT(MAKEINTERCLUSCORRDATA):   quit;
MPRINT(MAKEINTERCLUSCORRDATA):   data corr_tmp;
MPRINT(MAKEINTERCLUSCORRDATA):   set EMWS8.VarClus_OUTCLUSCORR;
MPRINT(MAKEINTERCLUSCORRDATA):   run;
 
NOTE: There were 8 observations read from the data set EMWS8.VARCLUS_OUTCLUSCORR.
NOTE: The data set WORK.CORR_TMP has 8 observations and 9 variables.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
 
 
MPRINT(MAKEINTERCLUSCORRDATA):   data EMWS8.VarClus_OUTCLUSCORR;
MPRINT(MAKEINTERCLUSCORRDATA):   set EMWS8.VarClus_OUTCLUSCORR;
MPRINT(MAKEINTERCLUSCORRDATA):   CLUS1 = CLUS1**2;
MPRINT(MAKEINTERCLUSCORRDATA):   CLUS2 = CLUS2**2;
MPRINT(MAKEINTERCLUSCORRDATA):   CLUS3 = CLUS3**2;
MPRINT(MAKEINTERCLUSCORRDATA):   CLUS4 = CLUS4**2;
MPRINT(MAKEINTERCLUSCORRDATA):   CLUS5 = CLUS5**2;
MPRINT(MAKEINTERCLUSCORRDATA):   CLUS6 = CLUS6**2;
MPRINT(MAKEINTERCLUSCORRDATA):   CLUS7 = CLUS7**2;
MPRINT(MAKEINTERCLUSCORRDATA):   CLUS8 = CLUS8**2;
MPRINT(MAKEINTERCLUSCORRDATA):   run;
 
NOTE: There were 8 observations read from the data set EMWS8.VARCLUS_OUTCLUSCORR.
NOTE: The data set EMWS8.VARCLUS_OUTCLUSCORR has 8 observations and 9 variables.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
 
 
MPRINT(MAKEINTERCLUSCORRDATA):   proc datasets lib = work nolist;
MPRINT(MAKEINTERCLUSCORRDATA):   delete corr_tmp;
MPRINT(MAKEINTERCLUSCORRDATA):   run;
 
NOTE: Deleting WORK.CORR_TMP (memtype=DATA).
MPRINT(MAKEINTERCLUSCORRDATA):   quit;
 
NOTE: PROCEDURE DATASETS used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
 
 
MPRINT(TRAIN1):  ;
MPRINT(FINDNEXTCLOSESTCLUSBYCLUSTER):   proc sort data =EMWS8.VarClus_OUTCLUSCORR out=_tmpclusRsq;
MPRINT(FINDNEXTCLOSESTCLUSBYCLUSTER):   by cluster;
MPRINT(FINDNEXTCLOSESTCLUSBYCLUSTER):   run;
 
NOTE: There were 8 observations read from the data set EMWS8.VARCLUS_OUTCLUSCORR.
NOTE: The data set WORK._TMPCLUSRSQ has 8 observations and 9 variables.
NOTE: PROCEDURE SORT used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
 
 
MPRINT(FINDNEXTCLOSESTCLUSBYCLUSTER):   proc transpose data =_tmpclusRsq out=_tmpclusRsq;
MPRINT(FINDNEXTCLOSESTCLUSBYCLUSTER):   by cluster;
MPRINT(FINDNEXTCLOSESTCLUSBYCLUSTER):   run;
 
NOTE: There were 8 observations read from the data set WORK._TMPCLUSRSQ.
NOTE: The data set WORK._TMPCLUSRSQ has 64 observations and 4 variables.
NOTE: PROCEDURE TRANSPOSE used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
 
 
MPRINT(FINDNEXTCLOSESTCLUSBYCLUSTER):   proc sort data=_tmpclusRsq;
MPRINT(FINDNEXTCLOSESTCLUSBYCLUSTER):   by _NAME_ col1;
MPRINT(FINDNEXTCLOSESTCLUSBYCLUSTER):   run;
 
NOTE: There were 64 observations read from the data set WORK._TMPCLUSRSQ.
NOTE: The data set WORK._TMPCLUSRSQ has 64 observations and 4 variables.
NOTE: PROCEDURE SORT used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
 
 
MPRINT(FINDNEXTCLOSESTCLUSBYCLUSTER):   data _tmpclusRsq;
MPRINT(FINDNEXTCLOSESTCLUSBYCLUSTER):   length _NAME_ $32;
MPRINT(FINDNEXTCLOSESTCLUSBYCLUSTER):   set _tmpclusRsq;
MPRINT(FINDNEXTCLOSESTCLUSBYCLUSTER):   by _NAME_;
MPRINT(FINDNEXTCLOSESTCLUSBYCLUSTER):   _NAME_ = upcase(_NAME_);
MPRINT(FINDNEXTCLOSESTCLUSBYCLUSTER):   if last._NAME_ then delete;
MPRINT(FINDNEXTCLOSESTCLUSBYCLUSTER):   run;
 
NOTE: There were 64 observations read from the data set WORK._TMPCLUSRSQ.
NOTE: The data set WORK._TMPCLUSRSQ has 56 observations and 4 variables.
NOTE: DATA statement used (Total process time):
      real time           0.01 seconds
      cpu time            0.01 seconds
 
 
MPRINT(FINDNEXTCLOSESTCLUSBYCLUSTER):   data _nextClusRSq;
MPRINT(FINDNEXTCLOSESTCLUSBYCLUSTER):   set _tmpclusRsq;
MPRINT(FINDNEXTCLOSESTCLUSBYCLUSTER):   by _NAME_;
MPRINT(FINDNEXTCLOSESTCLUSBYCLUSTER):   Cluster = upcase(Cluster);
MPRINT(FINDNEXTCLOSESTCLUSBYCLUSTER):   if last._NAME_ then output;
MPRINT(FINDNEXTCLOSESTCLUSBYCLUSTER):   *label COL1 = 'R-Sqaure with Next Cluster Component';
MPRINT(FINDNEXTCLOSESTCLUSBYCLUSTER):   label COL1 = "R-Square with Next Cluster Component" ;
MPRINT(FINDNEXTCLOSESTCLUSBYCLUSTER):   rename COL1 = RSqWithNextClusComp;
MPRINT(FINDNEXTCLOSESTCLUSBYCLUSTER):   Cluster = upcase(Cluster);
MPRINT(FINDNEXTCLOSESTCLUSBYCLUSTER):   rename Cluster = ClosestCluster;
MPRINT(FINDNEXTCLOSESTCLUSBYCLUSTER):   *label Cluster = "Next Closest Cluster";
MPRINT(FINDNEXTCLOSESTCLUSBYCLUSTER):   label Cluster = "Next Closest Cluster" ;
MPRINT(FINDNEXTCLOSESTCLUSBYCLUSTER):   rename _NAME_ = Variable;
MPRINT(FINDNEXTCLOSESTCLUSBYCLUSTER):   *label _NAME_ = "Variable";
MPRINT(FINDNEXTCLOSESTCLUSBYCLUSTER):   label _NAME_ = "Variable" ;
MPRINT(FINDNEXTCLOSESTCLUSBYCLUSTER):   run;
 
NOTE: There were 56 observations read from the data set WORK._TMPCLUSRSQ.
NOTE: The data set WORK._NEXTCLUSRSQ has 8 observations and 4 variables.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
 
 
MPRINT(FINDNEXTCLOSESTCLUSBYCLUSTER):   proc datasets lib = work nolist;
MPRINT(FINDNEXTCLOSESTCLUSBYCLUSTER):   delete _tmpclusRsq;
MPRINT(FINDNEXTCLOSESTCLUSBYCLUSTER):   run;
 
NOTE: Deleting WORK._TMPCLUSRSQ (memtype=DATA).
MPRINT(FINDNEXTCLOSESTCLUSBYCLUSTER):   quit;
 
NOTE: PROCEDURE DATASETS used (Total process time):
      real time           0.01 seconds
      cpu time            0.01 seconds
 
 
MPRINT(TRAIN1):  ;
MPRINT(MAKEOWNRSQUARE):   data _tmpds(drop= _NCL_);
MPRINT(MAKEOWNRSQUARE):   set EMWS8.VarClus_OUTSTAT;
MPRINT(MAKEOWNRSQUARE):   if ^(strip(_NCL_) eq 8 and strip(_TYPE_) in ('GROUP','RSQUARED')) then delete;
MPRINT(MAKEOWNRSQUARE):   _NAME_ = "CLUS";
MPRINT(MAKEOWNRSQUARE):   rename _NAME_ = Cluster;
MPRINT(MAKEOWNRSQUARE):   label _NAME_ = "Cluster Name";
MPRINT(MAKEOWNRSQUARE):   run;
 
NOTE: Numeric values have been converted to character values at the places given by: (Line):(Column).
      12:12
NOTE: Character values have been converted to numeric values at the places given by: (Line):(Column).
      12:6
NOTE: There were 175 observations read from the data set EMWS8.VARCLUS_OUTSTAT.
NOTE: The data set WORK._TMPDS has 2 observations and 26 variables.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
 
 
MPRINT(MAKEOWNRSQUARE):   proc transpose data =_tmpds out =_ownRsq;
MPRINT(MAKEOWNRSQUARE):   run;
 
NOTE: There were 2 observations read from the data set WORK._TMPDS.
NOTE: The data set WORK._OWNRSQ has 24 observations and 4 variables.
NOTE: PROCEDURE TRANSPOSE used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
 
 
MPRINT(MAKEOWNRSQUARE):   data _ownRsq(drop=COL1);
MPRINT(MAKEOWNRSQUARE):   length Cluster $32;
MPRINT(MAKEOWNRSQUARE):   length _NAME_ $32;
MPRINT(MAKEOWNRSQUARE):   set _ownRsq;
MPRINT(MAKEOWNRSQUARE):   _NAME_ = upcase(_NAME_);
MPRINT(MAKEOWNRSQUARE):   rename _NAME_=Variable;
MPRINT(MAKEOWNRSQUARE):   *label _NAME_="Variable";
MPRINT(MAKEOWNRSQUARE):   label _NAME_ = "Variable" ;
MPRINT(MAKEOWNRSQUARE):   label Cluster = "Cluster" ;
MPRINT(MAKEOWNRSQUARE):   label GCluster = "Global Cluster" ;
MPRINT(MAKEOWNRSQUARE):   Cluster = "CLUS"||strip(COL1);
MPRINT(MAKEOWNRSQUARE):   rename COL2 = RSqWithOwnClusComp;
MPRINT(MAKEOWNRSQUARE):   *label COL2 = "R-Square With Own Cluster Component";
MPRINT(MAKEOWNRSQUARE):   label COL2 = "R-Square With Own Cluster Component" ;
MPRINT(MAKEOWNRSQUARE):   run;
 
NOTE: Numeric values have been converted to character values at the places given by: (Line):(Column).
      101:25
NOTE: Variable GCluster is uninitialized.
NOTE: There were 24 observations read from the data set WORK._OWNRSQ.
NOTE: The data set WORK._OWNRSQ has 24 observations and 4 variables.
NOTE: DATA statement used (Total process time):
      real time           0.01 seconds
      cpu time            0.01 seconds
 
 
MPRINT(MAKEOWNRSQUARE):   proc sort data =_ownRsq;
MPRINT(MAKEOWNRSQUARE):   by Cluster RSqWithOwnClusComp;
MPRINT(MAKEOWNRSQUARE):   run;
 
NOTE: There were 24 observations read from the data set WORK._OWNRSQ.
NOTE: The data set WORK._OWNRSQ has 24 observations and 4 variables.
NOTE: PROCEDURE SORT used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
 
 
MPRINT(MAKEOWNRSQUARE):   proc datasets lib = work nolist;
MPRINT(MAKEOWNRSQUARE):   delete _tmpds;
MPRINT(MAKEOWNRSQUARE):   run;
 
NOTE: Deleting WORK._TMPDS (memtype=DATA).
MPRINT(MAKEOWNRSQUARE):   quit;
 
NOTE: PROCEDURE DATASETS used (Total process time):
      real time           0.01 seconds
      cpu time            0.01 seconds
 
 
MPRINT(TRAIN1):  ;
MPRINT(MAKECLUSSTRUCTCORRDATA):   data EMWS8.VarClus_OUTCLUSSTRUCT(drop= _NCL_ _TYPE_);
MPRINT(MAKECLUSSTRUCTCORRDATA):   set EMWS8.VarClus_OUTSTAT;
MPRINT(MAKECLUSSTRUCTCORRDATA):   if ^(strip(_NCL_) eq 8 and strip(_TYPE_) eq 'STRUCTUR') then delete;
MPRINT(MAKECLUSSTRUCTCORRDATA):   _NAME_ = upcase(_NAME_);
MPRINT(MAKECLUSSTRUCTCORRDATA):   rename _NAME_ = Cluster;
MPRINT(MAKECLUSSTRUCTCORRDATA):   label _NAME_ = "Cluster" ;
MPRINT(MAKECLUSSTRUCTCORRDATA):   label GCluster = "Global Cluster" ;
MPRINT(MAKECLUSSTRUCTCORRDATA):   run;
 
NOTE: Numeric values have been converted to character values at the places given by: (Line):(Column).
      12:12
NOTE: Character values have been converted to numeric values at the places given by: (Line):(Column).
      12:6
NOTE: Variable GCluster is uninitialized.
NOTE: There were 175 observations read from the data set EMWS8.VARCLUS_OUTSTAT.
NOTE: The data set EMWS8.VARCLUS_OUTCLUSSTRUCT has 8 observations and 25 variables.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
 
 
MPRINT(MAKECLUSSTRUCTCORRDATA):   data corr_tmp;
MPRINT(MAKECLUSSTRUCTCORRDATA):   set EMWS8.VarClus_OUTCLUSSTRUCT;
MPRINT(MAKECLUSSTRUCTCORRDATA):   run;
 
NOTE: There were 8 observations read from the data set EMWS8.VARCLUS_OUTCLUSSTRUCT.
NOTE: The data set WORK.CORR_TMP has 8 observations and 25 variables.
NOTE: DATA statement used (Total process time):
      real time           0.01 seconds
      cpu time            0.01 seconds
 
 
MPRINT(MAKECLUSSTRUCTCORRDATA):   data EMWS8.VarClus_OUTCLUSSTRUCT;
MPRINT(MAKECLUSSTRUCTCORRDATA):   set EMWS8.VarClus_OUTCLUSSTRUCT;
MPRINT(MAKECLUSSTRUCTCORRDATA):   AcceptedCmpTotal = AcceptedCmpTotal**2;
MPRINT(MAKECLUSSTRUCTCORRDATA):   Age = Age**2;
MPRINT(MAKECLUSSTRUCTCORRDATA):   Frq = Frq**2;
MPRINT(MAKECLUSSTRUCTCORRDATA):   Income = Income**2;
MPRINT(MAKECLUSSTRUCTCORRDATA):   Kidhome = Kidhome**2;
MPRINT(MAKECLUSSTRUCTCORRDATA):   Mnt = Mnt**2;
MPRINT(MAKECLUSSTRUCTCORRDATA):   MntFishProducts = MntFishProducts**2;
MPRINT(MAKECLUSSTRUCTCORRDATA):   MntFruits = MntFruits**2;
MPRINT(MAKECLUSSTRUCTCORRDATA):   MntGoldProds = MntGoldProds**2;
MPRINT(MAKECLUSSTRUCTCORRDATA):   MntMeatProducts = MntMeatProducts**2;
MPRINT(MAKECLUSSTRUCTCORRDATA):   MntSweetProducts = MntSweetProducts**2;
MPRINT(MAKECLUSSTRUCTCORRDATA):   MntWines = MntWines**2;
MPRINT(MAKECLUSSTRUCTCORRDATA):   MonthsAsCustomer = MonthsAsCustomer**2;
MPRINT(MAKECLUSSTRUCTCORRDATA):   NumCatalogPurchases = NumCatalogPurchases**2;
MPRINT(MAKECLUSSTRUCTCORRDATA):   NumDealsPurchases = NumDealsPurchases**2;
MPRINT(MAKECLUSSTRUCTCORRDATA):   NumDistPurchases = NumDistPurchases**2;
MPRINT(MAKECLUSSTRUCTCORRDATA):   NumStorePurchases = NumStorePurchases**2;
MPRINT(MAKECLUSSTRUCTCORRDATA):   NumWebPurchases = NumWebPurchases**2;
MPRINT(MAKECLUSSTRUCTCORRDATA):   NumWebVisitsMonth = NumWebVisitsMonth**2;
MPRINT(MAKECLUSSTRUCTCORRDATA):   RFMstat = RFMstat**2;
MPRINT(MAKECLUSSTRUCTCORRDATA):   RMntFrq = RMntFrq**2;
MPRINT(MAKECLUSSTRUCTCORRDATA):   Recency = Recency**2;
MPRINT(MAKECLUSSTRUCTCORRDATA):   Teenhome = Teenhome**2;
MPRINT(MAKECLUSSTRUCTCORRDATA):   Year_Birth = Year_Birth**2;
MPRINT(MAKECLUSSTRUCTCORRDATA):   run;
 
NOTE: There were 8 observations read from the data set EMWS8.VARCLUS_OUTCLUSSTRUCT.
NOTE: The data set EMWS8.VARCLUS_OUTCLUSSTRUCT has 8 observations and 25 variables.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
 
 
MPRINT(MAKECLUSSTRUCTCORRDATA):   proc datasets lib = work nolist;
MPRINT(MAKECLUSSTRUCTCORRDATA):   delete corr_tmp;
MPRINT(MAKECLUSSTRUCTCORRDATA):   run;
 
NOTE: Deleting WORK.CORR_TMP (memtype=DATA).
MPRINT(MAKECLUSSTRUCTCORRDATA):   quit;
 
NOTE: PROCEDURE DATASETS used (Total process time):
      real time           0.01 seconds
      cpu time            0.01 seconds
 
 
MPRINT(TRAIN1):  ;
MPRINT(FINDNEXTCLOSESTCLUSBYVAR):   proc sort data =EMWS8.VarClus_OUTCLUSSTRUCT out=_tmpclusRsq;
MPRINT(FINDNEXTCLOSESTCLUSBYVAR):   by cluster;
MPRINT(FINDNEXTCLOSESTCLUSBYVAR):   run;
 
NOTE: There were 8 observations read from the data set EMWS8.VARCLUS_OUTCLUSSTRUCT.
NOTE: The data set WORK._TMPCLUSRSQ has 8 observations and 25 variables.
NOTE: PROCEDURE SORT used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
 
 
MPRINT(FINDNEXTCLOSESTCLUSBYVAR):   proc transpose data =_tmpclusRsq out=_tmpclusRsq;
MPRINT(FINDNEXTCLOSESTCLUSBYVAR):   by cluster;
MPRINT(FINDNEXTCLOSESTCLUSBYVAR):   run;
 
NOTE: There were 8 observations read from the data set WORK._TMPCLUSRSQ.
NOTE: The data set WORK._TMPCLUSRSQ has 192 observations and 4 variables.
NOTE: PROCEDURE TRANSPOSE used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
 
 
MPRINT(FINDNEXTCLOSESTCLUSBYVAR):   proc sort data=_tmpclusRsq;
MPRINT(FINDNEXTCLOSESTCLUSBYVAR):   by _NAME_ COL1;
MPRINT(FINDNEXTCLOSESTCLUSBYVAR):   run;
 
NOTE: There were 192 observations read from the data set WORK._TMPCLUSRSQ.
NOTE: The data set WORK._TMPCLUSRSQ has 192 observations and 4 variables.
NOTE: PROCEDURE SORT used (Total process time):
      real time           0.01 seconds
      cpu time            0.00 seconds
 
 
MPRINT(FINDNEXTCLOSESTCLUSBYVAR):   data _tmpclusRsq;
MPRINT(FINDNEXTCLOSESTCLUSBYVAR):   length _NAME_ $32;
MPRINT(FINDNEXTCLOSESTCLUSBYVAR):   set _tmpclusRsq;
MPRINT(FINDNEXTCLOSESTCLUSBYVAR):   by _NAME_;
MPRINT(FINDNEXTCLOSESTCLUSBYVAR):   _NAME_ = upcase(_NAME_);
MPRINT(FINDNEXTCLOSESTCLUSBYVAR):   if last._NAME_ then delete;
MPRINT(FINDNEXTCLOSESTCLUSBYVAR):   run;
 
NOTE: There were 192 observations read from the data set WORK._TMPCLUSRSQ.
NOTE: The data set WORK._TMPCLUSRSQ has 168 observations and 4 variables.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
 
 
MPRINT(FINDNEXTCLOSESTCLUSBYVAR):   proc sort data=_tmpclusRsq;
MPRINT(FINDNEXTCLOSESTCLUSBYVAR):   by _NAME_ COL1;
MPRINT(FINDNEXTCLOSESTCLUSBYVAR):   run;
 
NOTE: There were 168 observations read from the data set WORK._TMPCLUSRSQ.
NOTE: The data set WORK._TMPCLUSRSQ has 168 observations and 4 variables.
NOTE: PROCEDURE SORT used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
 
 
MPRINT(FINDNEXTCLOSESTCLUSBYVAR):   data _nextVarRSq;
MPRINT(FINDNEXTCLOSESTCLUSBYVAR):   set _tmpclusRsq;
MPRINT(FINDNEXTCLOSESTCLUSBYVAR):   by _NAME_;
MPRINT(FINDNEXTCLOSESTCLUSBYVAR):   Cluster = upcase(Cluster);
MPRINT(FINDNEXTCLOSESTCLUSBYVAR):   if last._NAME_ then output;
MPRINT(FINDNEXTCLOSESTCLUSBYVAR):   *label COL1 = 'R-Sqaure with Next Cluster Component';
MPRINT(FINDNEXTCLOSESTCLUSBYVAR):   label COL1 = "R-Square with Next Cluster Component" ;
MPRINT(FINDNEXTCLOSESTCLUSBYVAR):   rename COL1 = RSqWithNextClusComp;
MPRINT(FINDNEXTCLOSESTCLUSBYVAR):   Cluster = upcase(Cluster);
MPRINT(FINDNEXTCLOSESTCLUSBYVAR):   rename Cluster = ClosestCluster;
MPRINT(FINDNEXTCLOSESTCLUSBYVAR):   *label Cluster = "Next Closest Cluster";
MPRINT(FINDNEXTCLOSESTCLUSBYVAR):   label Cluster = "Next Closest Cluster" ;
MPRINT(FINDNEXTCLOSESTCLUSBYVAR):   rename _NAME_ = Variable;
MPRINT(FINDNEXTCLOSESTCLUSBYVAR):   label _NAME_ = "Variable" ;
MPRINT(FINDNEXTCLOSESTCLUSBYVAR):   run;
 
NOTE: There were 168 observations read from the data set WORK._TMPCLUSRSQ.
NOTE: The data set WORK._NEXTVARRSQ has 24 observations and 4 variables.
NOTE: DATA statement used (Total process time):
      real time           0.01 seconds
      cpu time            0.00 seconds
 
 
MPRINT(FINDNEXTCLOSESTCLUSBYVAR):   proc datasets lib = work nolist;
MPRINT(FINDNEXTCLOSESTCLUSBYVAR):   delete _tmpclusRsq;
MPRINT(FINDNEXTCLOSESTCLUSBYVAR):   run;
 
NOTE: Deleting WORK._TMPCLUSRSQ (memtype=DATA).
MPRINT(FINDNEXTCLOSESTCLUSBYVAR):   quit;
 
NOTE: PROCEDURE DATASETS used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
 
 
MPRINT(TRAIN1):  ;
MPRINT(MAKEVARCLUSRESULTTABLE):   proc sort data =_ownRsq;
MPRINT(MAKEVARCLUSRESULTTABLE):   by Variable;
MPRINT(MAKEVARCLUSRESULTTABLE):   run;
 
NOTE: There were 24 observations read from the data set WORK._OWNRSQ.
NOTE: The data set WORK._OWNRSQ has 24 observations and 4 variables.
NOTE: PROCEDURE SORT used (Total process time):
      real time           0.01 seconds
      cpu time            0.01 seconds
 
 
MPRINT(MAKEVARCLUSRESULTTABLE):   proc sort data =_nextVarRsq;
MPRINT(MAKEVARCLUSRESULTTABLE):   by Variable;
MPRINT(MAKEVARCLUSRESULTTABLE):   run;
 
NOTE: There were 24 observations read from the data set WORK._NEXTVARRSQ.
NOTE: The data set WORK._NEXTVARRSQ has 24 observations and 4 variables.
NOTE: PROCEDURE SORT used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
 
 
MPRINT(MAKEVARCLUSRESULTTABLE):   data EMWS8.VarClus_OUTRSQUARE;
MPRINT(MAKEVARCLUSRESULTTABLE):   merge _ownRsq _nextVarRsq;
MPRINT(MAKEVARCLUSRESULTTABLE):   by Variable;
MPRINT(MAKEVARCLUSRESULTTABLE):   length Type $16;
MPRINT(MAKEVARCLUSRESULTTABLE):   Type = 'Variable';
MPRINT(MAKEVARCLUSRESULTTABLE):   *label Type ='Type';
MPRINT(MAKEVARCLUSRESULTTABLE):   label Type = "Type" ;
MPRINT(MAKEVARCLUSRESULTTABLE):   run;
 
NOTE: There were 24 observations read from the data set WORK._OWNRSQ.
NOTE: There were 24 observations read from the data set WORK._NEXTVARRSQ.
NOTE: The data set EMWS8.VARCLUS_OUTRSQUARE has 24 observations and 7 variables.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
 
 
MPRINT(MAKEVARCLUSRESULTTABLE):   data _nextClusRSq;
MPRINT(MAKEVARCLUSRESULTTABLE):   set _nextClusRSq ;
MPRINT(MAKEVARCLUSRESULTTABLE):   length RSqWithOwnClusComp 8.;
MPRINT(MAKEVARCLUSRESULTTABLE):   Cluster = Variable;
MPRINT(MAKEVARCLUSRESULTTABLE):   RSqWithOwnClusComp = 1;
MPRINT(MAKEVARCLUSRESULTTABLE):   *label RSqWithOwnClusComp = "R-Square With Own Cluster Component";
MPRINT(MAKEVARCLUSRESULTTABLE):   label RSqWithOwnClusComp = "R-Square With Own Cluster Component" ;
MPRINT(MAKEVARCLUSRESULTTABLE):   length Type $16;
MPRINT(MAKEVARCLUSRESULTTABLE):   Type = 'ClusterComp';
MPRINT(MAKEVARCLUSRESULTTABLE):   label Type = "Type" ;
MPRINT(MAKEVARCLUSRESULTTABLE):   ;
MPRINT(MAKEVARCLUSRESULTTABLE):   run;
 
NOTE: There were 8 observations read from the data set WORK._NEXTCLUSRSQ.
NOTE: The data set WORK._NEXTCLUSRSQ has 8 observations and 7 variables.
NOTE: DATA statement used (Total process time):
      real time           0.01 seconds
      cpu time            0.00 seconds
 
 
MPRINT(MAKEVARCLUSRESULTTABLE):   proc sort data=EMWS8.VarClus_OUTRSQUARE;
MPRINT(MAKEVARCLUSRESULTTABLE):   by Cluster;
MPRINT(MAKEVARCLUSRESULTTABLE):   run;
 
NOTE: There were 24 observations read from the data set EMWS8.VARCLUS_OUTRSQUARE.
NOTE: The data set EMWS8.VARCLUS_OUTRSQUARE has 24 observations and 7 variables.
NOTE: PROCEDURE SORT used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
 
 
MPRINT(MAKEVARCLUSRESULTTABLE):   proc sort data =_nextClusRSq;
MPRINT(MAKEVARCLUSRESULTTABLE):   by Cluster;
MPRINT(MAKEVARCLUSRESULTTABLE):   run;
 
NOTE: There were 8 observations read from the data set WORK._NEXTCLUSRSQ.
NOTE: The data set WORK._NEXTCLUSRSQ has 8 observations and 7 variables.
NOTE: PROCEDURE SORT used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
 
 
MPRINT(MAKEVARCLUSRESULTTABLE):   data EMWS8.VarClus_OUTRSQUARE;
MPRINT(MAKEVARCLUSRESULTTABLE):   set EMWS8.VarClus_OUTRSQUARE _nextClusRSq;
MPRINT(MAKEVARCLUSRESULTTABLE):   by Cluster;
MPRINT(MAKEVARCLUSRESULTTABLE):   run;
 
NOTE: There were 24 observations read from the data set EMWS8.VARCLUS_OUTRSQUARE.
NOTE: There were 8 observations read from the data set WORK._NEXTCLUSRSQ.
NOTE: The data set EMWS8.VARCLUS_OUTRSQUARE has 32 observations and 7 variables.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
 
 
MPRINT(MAKEVARCLUSRESULTTABLE):   data EMWS8.VarClus_OUTRSQUARE;
MPRINT(MAKEVARCLUSRESULTTABLE):   set EMWS8.VarClus_OUTRSQUARE;
MPRINT(MAKEVARCLUSRESULTTABLE):   length RsqRatio 8.;
MPRINT(MAKEVARCLUSRESULTTABLE):   length Selected $8;
MPRINT(MAKEVARCLUSRESULTTABLE):   *label RSqRatio = "1-R**2 Ratio";
MPRINT(MAKEVARCLUSRESULTTABLE):   label RSqRatio = "1-R2 Ratio" ;
MPRINT(MAKEVARCLUSRESULTTABLE):   *label Selected = "Variable Selected";
MPRINT(MAKEVARCLUSRESULTTABLE):   label Selected = "Variable Selected" ;
MPRINT(MAKEVARCLUSRESULTTABLE):   RsqRatio = (1-RSqWithOwnClusComp)/(1-RSqWithNextClusComp);
MPRINT(MAKEVARCLUSRESULTTABLE):   Selected ='YES';
MPRINT(MAKEVARCLUSRESULTTABLE):   rename _LABEL_ = Label;
MPRINT(MAKEVARCLUSRESULTTABLE):   label _LABEL_ = "Label" ;
MPRINT(MAKEVARCLUSRESULTTABLE):   run;
 
NOTE: There were 32 observations read from the data set EMWS8.VARCLUS_OUTRSQUARE.
NOTE: The data set EMWS8.VARCLUS_OUTRSQUARE has 32 observations and 9 variables.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
 
 
MPRINT(MAKEVARCLUSRESULTTABLE):   quit;
MPRINT(TRAIN1):  ;
MPRINT(MAKEINTERCLUSCORRDATA):   data EMWS8.VarClus_OUTCLUSCORRPLOT(drop= _NCL_ _TYPE_);
MPRINT(MAKEINTERCLUSCORRDATA):   set EMWS8.VarClus_OUTSTAT;
MPRINT(MAKEINTERCLUSCORRDATA):   if ^(strip(_NCL_) eq 8 and strip(_TYPE_) eq 'CCORR') then delete;
MPRINT(MAKEINTERCLUSCORRDATA):   _NAME_ = upcase(_NAME_);
MPRINT(MAKEINTERCLUSCORRDATA):   rename _NAME_ = Cluster;
MPRINT(MAKEINTERCLUSCORRDATA):   label _NAME_ = "Cluster Name";
MPRINT(MAKEINTERCLUSCORRDATA):   run;
 
NOTE: Numeric values have been converted to character values at the places given by: (Line):(Column).
      18:12
NOTE: Character values have been converted to numeric values at the places given by: (Line):(Column).
      18:6
NOTE: There were 175 observations read from the data set EMWS8.VARCLUS_OUTSTAT.
NOTE: The data set EMWS8.VARCLUS_OUTCLUSCORRPLOT has 8 observations and 25 variables.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
 
 
MPRINT(MAKEINTERCLUSCORRDATA):   data corr_tmp;
MPRINT(MAKEINTERCLUSCORRDATA):   set EMWS8.VarClus_OUTCLUSCORRPLOT;
MPRINT(MAKEINTERCLUSCORRDATA):   run;
 
NOTE: There were 8 observations read from the data set EMWS8.VARCLUS_OUTCLUSCORRPLOT.
NOTE: The data set WORK.CORR_TMP has 8 observations and 25 variables.
NOTE: DATA statement used (Total process time):
      real time           0.01 seconds
      cpu time            0.00 seconds
 
 
MPRINT(MAKEINTERCLUSCORRDATA):   data EMWS8.VarClus_OUTCLUSCORRPLOT;
MPRINT(MAKEINTERCLUSCORRDATA):   set EMWS8.VarClus_OUTCLUSCORRPLOT;
MPRINT(MAKEINTERCLUSCORRDATA):   rename AcceptedCmpTotal = CLUS1;
MPRINT(MAKEINTERCLUSCORRDATA):   *label &_name ="Cluster &i_1";
MPRINT(MAKEINTERCLUSCORRDATA):   label AcceptedCmpTotal = "Cluster 1";
MPRINT(MAKEINTERCLUSCORRDATA):   rename Age = CLUS2;
MPRINT(MAKEINTERCLUSCORRDATA):   *label &_name ="Cluster &i_1";
MPRINT(MAKEINTERCLUSCORRDATA):   label Age = "Cluster 2";
MPRINT(MAKEINTERCLUSCORRDATA):   rename Frq = CLUS3;
MPRINT(MAKEINTERCLUSCORRDATA):   *label &_name ="Cluster &i_1";
MPRINT(MAKEINTERCLUSCORRDATA):   label Frq = "Cluster 3";
MPRINT(MAKEINTERCLUSCORRDATA):   rename Income = CLUS4;
MPRINT(MAKEINTERCLUSCORRDATA):   *label &_name ="Cluster &i_1";
MPRINT(MAKEINTERCLUSCORRDATA):   label Income = "Cluster 4";
MPRINT(MAKEINTERCLUSCORRDATA):   rename Kidhome = CLUS5;
MPRINT(MAKEINTERCLUSCORRDATA):   *label &_name ="Cluster &i_1";
MPRINT(MAKEINTERCLUSCORRDATA):   label Kidhome = "Cluster 5";
MPRINT(MAKEINTERCLUSCORRDATA):   rename Mnt = CLUS6;
MPRINT(MAKEINTERCLUSCORRDATA):   *label &_name ="Cluster &i_1";
MPRINT(MAKEINTERCLUSCORRDATA):   label Mnt = "Cluster 6";
MPRINT(MAKEINTERCLUSCORRDATA):   rename MntFishProducts = CLUS7;
MPRINT(MAKEINTERCLUSCORRDATA):   *label &_name ="Cluster &i_1";
MPRINT(MAKEINTERCLUSCORRDATA):   label MntFishProducts = "Cluster 7";
MPRINT(MAKEINTERCLUSCORRDATA):   rename MntFruits = CLUS8;
MPRINT(MAKEINTERCLUSCORRDATA):   *label &_name ="Cluster &i_1";
MPRINT(MAKEINTERCLUSCORRDATA):   label MntFruits = "Cluster 8";
MPRINT(MAKEINTERCLUSCORRDATA):   keep Cluster AcceptedCmpTotal Age Frq Income Kidhome Mnt MntFishProducts MntFruits ;
MPRINT(MAKEINTERCLUSCORRDATA):   run;
 
NOTE: There were 8 observations read from the data set EMWS8.VARCLUS_OUTCLUSCORRPLOT.
NOTE: The data set EMWS8.VARCLUS_OUTCLUSCORRPLOT has 8 observations and 9 variables.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
 
 
MPRINT(MAKEINTERCLUSCORRDATA):   quit;
MPRINT(MAKEINTERCLUSCORRDATA):   proc datasets lib = work nolist;
MPRINT(MAKEINTERCLUSCORRDATA):   delete corr_tmp;
MPRINT(MAKEINTERCLUSCORRDATA):   run;
 
NOTE: Deleting WORK.CORR_TMP (memtype=DATA).
MPRINT(MAKEINTERCLUSCORRDATA):   quit;
 
NOTE: PROCEDURE DATASETS used (Total process time):
      real time           0.01 seconds
      cpu time            0.01 seconds
 
 
MPRINT(TRAIN1):  ;
MPRINT(MAKEPLOTDATAFROMCORRTABLE):   proc sort data =EMWS8.VarClus_OUTCLUSCORRPLOT;
MPRINT(MAKEPLOTDATAFROMCORRTABLE):   by cluster;
MPRINT(MAKEPLOTDATAFROMCORRTABLE):   run;
 
NOTE: There were 8 observations read from the data set EMWS8.VARCLUS_OUTCLUSCORRPLOT.
NOTE: The data set EMWS8.VARCLUS_OUTCLUSCORRPLOT has 8 observations and 9 variables.
NOTE: PROCEDURE SORT used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
 
 
MPRINT(MAKEPLOTDATAFROMCORRTABLE):   proc transpose data =EMWS8.VarClus_OUTCLUSCORRPLOT out=EMWS8.VarClus_OUTCLUSCORRPLOT(drop=_LABEL_ rename=(_NAME_ = Y Cluster=X Col1= Correlation));
MPRINT(MAKEPLOTDATAFROMCORRTABLE):   by cluster;
MPRINT(MAKEPLOTDATAFROMCORRTABLE):   run;
 
NOTE: There were 8 observations read from the data set EMWS8.VARCLUS_OUTCLUSCORRPLOT.
NOTE: The data set EMWS8.VARCLUS_OUTCLUSCORRPLOT has 64 observations and 3 variables.
NOTE: PROCEDURE TRANSPOSE used (Total process time):
      real time           0.01 seconds
      cpu time            0.01 seconds
 
 
MPRINT(MAKEPLOTDATAFROMCORRTABLE):   data EMWS8.VarClus_OUTCLUSCORRPLOT;
MPRINT(MAKEPLOTDATAFROMCORRTABLE):   set EMWS8.VarClus_OUTCLUSCORRPLOT;
MPRINT(MAKEPLOTDATAFROMCORRTABLE):   label x= "Cluster" ;
MPRINT(MAKEPLOTDATAFROMCORRTABLE):   label Y= "Cluster" ;
MPRINT(MAKEPLOTDATAFROMCORRTABLE):   label Correlation = "Correlation" ;
MPRINT(MAKEPLOTDATAFROMCORRTABLE):   run;
 
NOTE: There were 64 observations read from the data set EMWS8.VARCLUS_OUTCLUSCORRPLOT.
NOTE: The data set EMWS8.VARCLUS_OUTCLUSCORRPLOT has 64 observations and 3 variables.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
 
 
MPRINT(TRAIN1):  ;
MPRINT(MAKESTATPLOTDATA):   data varclus_tmp(drop=_NAME_ _NCL_) ;
MPRINT(MAKESTATPLOTDATA):   set EMWS8.VarClus_OUTSTAT;
MPRINT(MAKESTATPLOTDATA):   where _type_ in('MEAN', 'STD', 'N');
MPRINT(MAKESTATPLOTDATA):   run ;
 
NOTE: There were 3 observations read from the data set EMWS8.VARCLUS_OUTSTAT.
      WHERE _type_ in ('MEAN', 'N', 'STD');
NOTE: The data set WORK.VARCLUS_TMP has 3 observations and 25 variables.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
 
 
MPRINT(MAKESTATPLOTDATA):   proc transpose data=varclus_tmp out=EMWS8.VarClus_OUTSTATPLOT;
MPRINT(MAKESTATPLOTDATA):   id _TYPE_ ;
MPRINT(MAKESTATPLOTDATA):   run ;
 
NOTE: There were 3 observations read from the data set WORK.VARCLUS_TMP.
NOTE: The data set EMWS8.VARCLUS_OUTSTATPLOT has 24 observations and 5 variables.
NOTE: PROCEDURE TRANSPOSE used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
 
 
MPRINT(MAKESTATPLOTDATA):   data EMWS8.VarClus_OUTSTATPLOT;
MPRINT(MAKESTATPLOTDATA):   set EMWS8.VarClus_OUTSTATPLOT(obs=1000);
MPRINT(MAKESTATPLOTDATA):   label _name_= "Name";
MPRINT(MAKESTATPLOTDATA):   label _label_= "Label" ;
MPRINT(MAKESTATPLOTDATA):   if MEAN ne 0 then SCALEDSTD= STD / MEAN ;
MPRINT(MAKESTATPLOTDATA):   else SCALEDSTD= STD ;
MPRINT(MAKESTATPLOTDATA):   label SCALEDSTD = "Scaled STD";
MPRINT(MAKESTATPLOTDATA):   run ;
 
NOTE: There were 24 observations read from the data set EMWS8.VARCLUS_OUTSTATPLOT.
NOTE: The data set EMWS8.VARCLUS_OUTSTATPLOT has 24 observations and 6 variables.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
 
 
MPRINT(MAKESTATPLOTDATA):   proc sort data=EMWS8.VarClus_OUTSTATPLOT;
MPRINT(MAKESTATPLOTDATA):   by descending SCALEDSTD ;
MPRINT(MAKESTATPLOTDATA):   run ;
 
NOTE: There were 24 observations read from the data set EMWS8.VARCLUS_OUTSTATPLOT.
NOTE: The data set EMWS8.VARCLUS_OUTSTATPLOT has 24 observations and 6 variables.
NOTE: PROCEDURE SORT used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
 
 
MPRINT(MAKESTATPLOTDATA):   proc datasets lib=work nolist mt=(DATA VIEW);
MPRINT(MAKESTATPLOTDATA):   delete varclus_tmp;
MPRINT(MAKESTATPLOTDATA):   run;
 
NOTE: Deleting WORK.VARCLUS_TMP (memtype=DATA).
MPRINT(MAKESTATPLOTDATA):   quit;
 
NOTE: PROCEDURE DATASETS used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
 
 
MPRINT(TRAIN1):  ;
MPRINT(MAKEVARCLUSCORRDATA):   data EMWS8.VarClus_OUTCORR(drop=_TYPE_ _NCL_) ;
MPRINT(MAKEVARCLUSCORRDATA):   set EMWS8.VarClus_OUTSTAT;
MPRINT(MAKEVARCLUSCORRDATA):   where _type_ eq 'CORR' ;
MPRINT(MAKEVARCLUSCORRDATA):   run ;
 
NOTE: There were 24 observations read from the data set EMWS8.VARCLUS_OUTSTAT.
      WHERE _type_='CORR';
NOTE: The data set EMWS8.VARCLUS_OUTCORR has 24 observations and 25 variables.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
 
 
MPRINT(MAKEVARCLUSCORRDATA):   proc sort data=EMWS8.VarClus_OUTCORR;
MPRINT(MAKEVARCLUSCORRDATA):   by _NAME_ ;
MPRINT(MAKEVARCLUSCORRDATA):   run ;
 
NOTE: There were 24 observations read from the data set EMWS8.VARCLUS_OUTCORR.
NOTE: The data set EMWS8.VARCLUS_OUTCORR has 24 observations and 25 variables.
NOTE: PROCEDURE SORT used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
 
 
MPRINT(MAKEVARCLUSCORRDATA):   proc transpose data=EMWS8.VarClus_OUTCORR out=EMWS8.VarClus_OUTCORRPLOT name=_TMP_;
MPRINT(MAKEVARCLUSCORRDATA):   BY _NAME_ ;
MPRINT(MAKEVARCLUSCORRDATA):   run ;
 
NOTE: There were 24 observations read from the data set EMWS8.VARCLUS_OUTCORR.
NOTE: The data set EMWS8.VARCLUS_OUTCORRPLOT has 576 observations and 4 variables.
NOTE: PROCEDURE TRANSPOSE used (Total process time):
      real time           0.01 seconds
      cpu time            0.01 seconds
 
 
MPRINT(MAKEVARCLUSCORRDATA):   data EMWS8.VarClus_OUTCORRPLOT;
MPRINT(MAKEVARCLUSCORRDATA):   length _Y_ $100;
MPRINT(MAKEVARCLUSCORRDATA):   set EMWS8.VarClus_OUTCORRPLOT;
MPRINT(MAKEVARCLUSCORRDATA):   if _LABEL_ ne '' then _Y_=_LABEL_ ;
MPRINT(MAKEVARCLUSCORRDATA):   else _Y_=_TMP_ ;
MPRINT(MAKEVARCLUSCORRDATA):   run ;
 
NOTE: There were 576 observations read from the data set EMWS8.VARCLUS_OUTCORRPLOT.
NOTE: The data set EMWS8.VARCLUS_OUTCORRPLOT has 576 observations and 5 variables.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
 
 
MPRINT(MAKEVARCLUSCORRDATA):   data varclus_match(rename=(_TMP_= _NAME_ _LABEL_=_X_));
MPRINT(MAKEVARCLUSCORRDATA):   set EMWS8.VarClus_OUTCORRPLOT;
MPRINT(MAKEVARCLUSCORRDATA):   where _LABEL_ ne '' ;
MPRINT(MAKEVARCLUSCORRDATA):   keep _TMP_ _LABEL_ ;
MPRINT(MAKEVARCLUSCORRDATA):   run ;
 
NOTE: There were 384 observations read from the data set EMWS8.VARCLUS_OUTCORRPLOT.
      WHERE _LABEL_ not = ' ';
NOTE: The data set WORK.VARCLUS_MATCH has 384 observations and 2 variables.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
 
 
MPRINT(MAKEVARCLUSCORRDATA):   data _null_;
MPRINT(MAKEVARCLUSCORRDATA):   nobs=0;
MPRINT(MAKEVARCLUSCORRDATA):   dsid = open('varclus_match');
MPRINT(MAKEVARCLUSCORRDATA):   if dsid then do;
MPRINT(MAKEVARCLUSCORRDATA):   nobs = attrn(dsid, 'NOBS');
MPRINT(MAKEVARCLUSCORRDATA):   dsid = close(dsid);
MPRINT(MAKEVARCLUSCORRDATA):   end;
MPRINT(MAKEVARCLUSCORRDATA):   call symput ('CORR_NOBS', nobs);
MPRINT(MAKEVARCLUSCORRDATA):   run;
 
NOTE: Numeric values have been converted to character values at the places given by: (Line):(Column).
      137:27
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
 
 
MPRINT(MAKEVARCLUSCORRDATA):   proc sort data=varclus_match;
MPRINT(MAKEVARCLUSCORRDATA):   by _name_;
MPRINT(MAKEVARCLUSCORRDATA):   run ;
 
NOTE: There were 384 observations read from the data set WORK.VARCLUS_MATCH.
NOTE: The data set WORK.VARCLUS_MATCH has 384 observations and 2 variables.
NOTE: PROCEDURE SORT used (Total process time):
      real time           0.01 seconds
      cpu time            0.01 seconds
 
 
MPRINT(MAKEVARCLUSCORRDATA):   proc sort data=EMWS8.VarClus_OUTCORRPLOT;
MPRINT(MAKEVARCLUSCORRDATA):   by _name_;
MPRINT(MAKEVARCLUSCORRDATA):   run ;
 
NOTE: There were 576 observations read from the data set EMWS8.VARCLUS_OUTCORRPLOT.
NOTE: The data set EMWS8.VARCLUS_OUTCORRPLOT has 576 observations and 5 variables.
NOTE: PROCEDURE SORT used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
 
 
MPRINT(MAKEVARCLUSCORRDATA):   data EMWS8.VarClus_OUTCORRPLOT(keep= _X_ _Y_ col1 rename=(col1=Correlation)) ;
MPRINT(MAKEVARCLUSCORRDATA):   merge varclus_match EMWS8.VarClus_OUTCORRPLOT;
MPRINT(MAKEVARCLUSCORRDATA):   by _NAME_ ;
MPRINT(MAKEVARCLUSCORRDATA):   if _X_ eq '' then _X_=_NAME_ ;
MPRINT(MAKEVARCLUSCORRDATA):   label _X_ = "Variable";
MPRINT(MAKEVARCLUSCORRDATA):   label _Y_ = "Variable";
MPRINT(MAKEVARCLUSCORRDATA):   label col1 = "Correlation";
MPRINT(MAKEVARCLUSCORRDATA):   run ;
 
WARNING: Multiple lengths were specified for the BY variable _NAME_ by input data sets. This may cause unexpected results.
NOTE: MERGE statement has more than one data set with repeats of BY values.
NOTE: There were 384 observations read from the data set WORK.VARCLUS_MATCH.
NOTE: There were 576 observations read from the data set EMWS8.VARCLUS_OUTCORRPLOT.
NOTE: The data set EMWS8.VARCLUS_OUTCORRPLOT has 576 observations and 3 variables.
NOTE: DATA statement used (Total process time):
      real time           0.01 seconds
      cpu time            0.00 seconds
 
 
MPRINT(MAKEVARCLUSCORRDATA):   proc sort data=EMWS8.VarClus_OUTCORRPLOT;
MPRINT(MAKEVARCLUSCORRDATA):   by _X_ _Y_;
MPRINT(MAKEVARCLUSCORRDATA):   run ;
 
NOTE: There were 576 observations read from the data set EMWS8.VARCLUS_OUTCORRPLOT.
NOTE: The data set EMWS8.VARCLUS_OUTCORRPLOT has 576 observations and 3 variables.
NOTE: PROCEDURE SORT used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
 
 
MPRINT(MAKEVARCLUSCORRDATA):   proc datasets lib=work nolist mt=(DATA VIEW);
MPRINT(MAKEVARCLUSCORRDATA):   delete varclus_match;
MPRINT(MAKEVARCLUSCORRDATA):   run;
 
NOTE: Deleting WORK.VARCLUS_MATCH (memtype=DATA).
MPRINT(MAKEVARCLUSCORRDATA):   quit;
 
NOTE: PROCEDURE DATASETS used (Total process time):
      real time           0.01 seconds
      cpu time            0.01 seconds
 
 
MPRINT(TRAIN1):  ;
MPRINT(MAKECLUSCONSTELLDATA):   data EMWS8.VarClus_OUTLINK(drop = Selected);
MPRINT(MAKECLUSCONSTELLDATA):   set EMWS8.VarClus_OUTRSQUARE;
MPRINT(MAKECLUSCONSTELLDATA):   LINKID = _N_;
MPRINT(MAKECLUSCONSTELLDATA):   label LINKID = "Link ID";
MPRINT(MAKECLUSCONSTELLDATA):   if strip(upcase(Cluster)) eq strip(upcase(Variable)) then Variable = ClosestCluster;
MPRINT(MAKECLUSCONSTELLDATA):   run;
 
NOTE: There were 32 observations read from the data set EMWS8.VARCLUS_OUTRSQUARE.
NOTE: The data set EMWS8.VARCLUS_OUTLINK has 32 observations and 9 variables.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.01 seconds
 
 
MPRINT(MAKECLUSCONSTELLDATA):   data EMWS8.VarClus_OUTNODE(keep=NODEID TYPE LABEL);
MPRINT(MAKECLUSCONSTELLDATA):   set EMWS8.VarClus_OUTRSQUARE;
MPRINT(MAKECLUSCONSTELLDATA):   length TYPE $16;
MPRINT(MAKECLUSCONSTELLDATA):   rename Variable = NODEID;
MPRINT(MAKECLUSCONSTELLDATA):   label Variable= "Node ID";
MPRINT(MAKECLUSCONSTELLDATA):   if strip(upcase(Cluster)) eq strip(upcase(Variable)) then TYPE = "CLUSTER";
MPRINT(MAKECLUSCONSTELLDATA):   else TYPE="VARIABLE";
MPRINT(MAKECLUSCONSTELLDATA):   label TYPE = "Node Type";
MPRINT(MAKECLUSCONSTELLDATA):   run;
 
NOTE: There were 32 observations read from the data set EMWS8.VARCLUS_OUTRSQUARE.
NOTE: The data set EMWS8.VARCLUS_OUTNODE has 32 observations and 3 variables.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
 
 
MPRINT(MAKECLUSCONSTELLDATA):   quit;
MPRINT(TRAIN1):  ;
MPRINT(CREATESCORECODE):  ;
MPRINT(CREATESCORECODE):   data EMWS8.VarClus_OUTSTATSCORE;
MPRINT(CREATESCORECODE):   set EMWS8.VarClus_OUTSTAT;
MPRINT(CREATESCORECODE):   if (_TYPE_ in ('SCORE' 'MEAN' 'STD') and _NCL_ = 8 ) or (_TYPE_ in ('MEAN' 'STD'));
MPRINT(CREATESCORECODE):   if _TYPE_ = 'MEAN' then _NAME_='MEAN';
MPRINT(CREATESCORECODE):   if _TYPE_ = 'STD' then _NAME_='STD';
MPRINT(CREATESCORECODE):   DROP _TYPE_ _NCL_;
MPRINT(CREATESCORECODE):   run;
 
NOTE: There were 175 observations read from the data set EMWS8.VARCLUS_OUTSTAT.
NOTE: The data set EMWS8.VARCLUS_OUTSTATSCORE has 10 observations and 25 variables.
NOTE: DATA statement used (Total process time):
      real time           0.01 seconds
      cpu time            0.00 seconds
 
 
MPRINT(CREATESCORECODE):   filename _file_ "C:\\predictive-models-project\Workspaces\EMWS8\VarClus\EMFLOWSCORE.sas";
MPRINT(CREATESCORECODE):   data _null_;
MPRINT(CREATESCORECODE):   FILE _file_ MOD;
MPRINT(CREATESCORECODE):   put ' ';
MPRINT(CREATESCORECODE):   put '/*-------------------------------------------------*/';
MPRINT(CREATESCORECODE):   put '/* ' "Varclus Score Code Begins" '*/';
MPRINT(CREATESCORECODE):   put '/*-------------------------------------------------*/';
MPRINT(CREATESCORECODE):   put ' ';
MPRINT(CREATESCORECODE):   put "Clus1 = 0 ; /*---" "Cluster Component 1" "------ */";
MPRINT(CREATESCORECODE):   put "Clus2 = 0 ; /*---" "Cluster Component 2" "------ */";
MPRINT(CREATESCORECODE):   put "Clus3 = 0 ; /*---" "Cluster Component 3" "------ */";
MPRINT(CREATESCORECODE):   put "Clus4 = 0 ; /*---" "Cluster Component 4" "------ */";
MPRINT(CREATESCORECODE):   put "Clus5 = 0 ; /*---" "Cluster Component 5" "------ */";
MPRINT(CREATESCORECODE):   put "Clus6 = 0 ; /*---" "Cluster Component 6" "------ */";
MPRINT(CREATESCORECODE):   put "Clus7 = 0 ; /*---" "Cluster Component 7" "------ */";
MPRINT(CREATESCORECODE):   put "Clus8 = 0 ; /*---" "Cluster Component 8" "------ */";
MPRINT(CREATESCORECODE):   put "Clus8 = Clus8+1 * (AcceptedCmpTotal - 0.31255265374894)/0.66837726102124;";
MPRINT(CREATESCORECODE):   put "Clus2 = Clus2+0.5 * (Age - 47.2059814658803)/12.0632948493559;";
MPRINT(CREATESCORECODE):   put "Clus4 = Clus4+0.19973986384379 * (Frq - 12.6545914069081)/7.1598086029145;";
MPRINT(CREATESCORECODE):   put "Clus1 = Clus1+0.15242317288807 * (Income - 51962.545914069)/20878.2658128313;";
MPRINT(CREATESCORECODE):   put "Clus1 = Clus1+-0.11326525887946 * (Kidhome - 0.43555181128896)/0.53438033047728;";
MPRINT(CREATESCORECODE):   put "Clus1 = Clus1+0.16405768583044 * (Mnt - 615.68197135636)/604.537497355942;";
MPRINT(CREATESCORECODE):   put "Clus1 = Clus1+0.12820704015091 * (MntFishProducts - 36.4945240101095)/52.2208809602509;";
MPRINT(CREATESCORECODE):   put "Clus1 = Clus1+0.13003723528825 * (MntFruits - 27.153748946925)/39.7289323595324;";
MPRINT(CREATESCORECODE):   put "Clus4 = Clus4+0.12026967394981 * (MntGoldProds - 44.0589721988205)/51.1646481009475;";
MPRINT(CREATESCORECODE):   put "Clus1 = Clus1+0.15378172897501 * (MntMeatProducts - 169.965037910699)/216.176716057929;";
MPRINT(CREATESCORECODE):   put "Clus1 = Clus1+0.12839407773078 * (MntSweetProducts - 27.0804549283909)/39.2356363442449;";
MPRINT(CREATESCORECODE):   put "Clus4 = Clus4+0.16875412248328 * (MntWines - 310.929233361415)/341.695699656276;";
MPRINT(CREATESCORECODE):   put "Clus3 = Clus3+1 * (MonthsAsCustomer - 83.4953664700926)/16.9441392661404;";
MPRINT(CREATESCORECODE):   put "Clus4 = Clus4+0.17191033798819 * (NumCatalogPurchases - 2.64448188711036)/2.77214051734809;";
MPRINT(CREATESCORECODE):   put "Clus5 = Clus5+0.59365846567538 * (NumDealsPurchases - 2.25526537489469)/1.67318269219337;";
MPRINT(CREATESCORECODE):   put "Clus4 = Clus4+0.19568478317119 * (NumDistPurchases - 6.73504633529907)/4.60209117827878;";
MPRINT(CREATESCORECODE):   put "Clus4 = Clus4+0.16265391840825 * (NumStorePurchases - 5.91954507160909)/3.25562388118508;";
MPRINT(CREATESCORECODE):   put "Clus4 = Clus4+0.16220922357079 * (NumWebPurchases - 4.09056444818871)/2.61390561975288;";
MPRINT(CREATESCORECODE):   put "Clus1 = Clus1+-0.12106102877754 * (NumWebVisitsMonth - 5.24220724515585)/2.33225525940929;";
MPRINT(CREATESCORECODE):   put "Clus7 = Clus7+1 * (RFMstat - 531.396946202506)/1565.49314871989;";
MPRINT(CREATESCORECODE):   put "Clus1 = Clus1+0.15685430945271 * (RMntFrq - 37.80392418146)/30.0642993170191;";
MPRINT(CREATESCORECODE):   put "Clus6 = Clus6+1 * (Recency - 48.7742207245156)/28.8224799181808;";
MPRINT(CREATESCORECODE):   put "Clus5 = Clus5+0.59365846567538 * (Teenhome - 0.48652064026958)/0.55047336656954;";
MPRINT(CREATESCORECODE):   put "Clus2 = Clus2+-0.5 * (Year_Birth - 1968.79401853412)/12.0632948493559;";
MPRINT(CREATESCORECODE):   run;
 
NOTE: The file _FILE_ is:
      Filename=C:\\predictive-models-project\Workspaces\EMWS8\VarClus\EMFLOWSCORE.sas,
      RECFM=V,LRECL=256,File Size (bytes)=0,
      Last Modified=19. April 2016 17.21 Uhr,
      Create Time=03. April 2016 17.12 Uhr
 
NOTE: 37 records were written to the file _FILE_.
      The minimum record length was 1.
      The maximum record length was 91.
NOTE: DATA statement used (Total process time):
      real time           0.03 seconds
      cpu time            0.03 seconds
 
 
MPRINT(TRAIN1):  ;
MPRINT(TRAIN):  ;
MPRINT(TRAIN):   filename _in "C:\\predictive-models-project\Workspaces\EMWS8\VarClus\EMFLOWSCORE.sas";
MPRINT(TRAIN):   filename _out "C:\\predictive-models-project\Workspaces\EMWS8\VarClus\EMPUBLISHSCORE.sas";
MPRINT(EM_COPYFILE):   data _null_;
MPRINT(EM_COPYFILE):   length line $20000;
MPRINT(EM_COPYFILE):   file _out lrecl=20000;
MPRINT(EM_COPYFILE):   fid=fopen("_in",'i',20000,'v');
MPRINT(EM_COPYFILE):   if fid > 0 then do;
MPRINT(EM_COPYFILE):   do while(^fread(fid));
MPRINT(EM_COPYFILE):   rlen = frlen(fid);
MPRINT(EM_COPYFILE):   rc= fget(fid,line,20000);
MPRINT(EM_COPYFILE):   start = length(line)-length(left(line))+1;
MPRINT(EM_COPYFILE):   line=strip(line);
MPRINT(EM_COPYFILE):   put @start line;
MPRINT(EM_COPYFILE):   end;
MPRINT(EM_COPYFILE):   if fid > 0 then rc=fclose(fid);
MPRINT(EM_COPYFILE):   end;
MPRINT(EM_COPYFILE):   run;
 
NOTE: The file _OUT is:
      Filename=C:\\predictive-models-project\Workspaces\EMWS8\VarClus\EMPUBLISHSCORE.sas,
      RECFM=V,LRECL=20000,File Size (bytes)=0,
      Last Modified=19. April 2016 17.21 Uhr,
      Create Time=03. April 2016 17.12 Uhr
 
NOTE: 37 records were written to the file _OUT.
      The minimum record length was 1.
      The maximum record length was 91.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
 
 
MPRINT(TRAIN):  ;
MPRINT(TRAIN):   filename _in;
NOTE: Fileref _IN has been deassigned.
MPRINT(TRAIN):   filename _out;
NOTE: Fileref _OUT has been deassigned.
MPRINT(MAIN):  ;
MPRINT(EM_DIAGRAM):  ;
MPRINT(EM_DIAGRAM):   *------------------------------------------------------------*;
MPRINT(EM_DIAGRAM):   * End TRAIN: VarClus;
MPRINT(EM_DIAGRAM):   *------------------------------------------------------------*;
99228
99229      *------------------------------------------------------------*;
99230      * End TRAIN: VarClus;
99231      *------------------------------------------------------------*;
 
99232      *------------------------------------------------------------*;
MPRINT(EM_DIAGRAM):    *------------------------------------------------------------*;
99233      * Close any missing semi colons;
MPRINT(EM_DIAGRAM):   * Close any missing semi colons;
99234      *------------------------------------------------------------*;
MPRINT(EM_DIAGRAM):   *------------------------------------------------------------*;
99235      ;
MPRINT(EM_DIAGRAM):   ;
99236      ;
MPRINT(EM_DIAGRAM):   ;
99237      ;
MPRINT(EM_DIAGRAM):   ;
99238      ;
MPRINT(EM_DIAGRAM):   ;
99239      quit;
MPRINT(EM_DIAGRAM):   quit;
99240      *------------------------------------------------------------*;
MPRINT(EM_DIAGRAM):   *------------------------------------------------------------*;
99241      * Close any unbalanced quotes;
MPRINT(EM_DIAGRAM):   * Close any unbalanced quotes;
99242      *------------------------------------------------------------*;
MPRINT(EM_DIAGRAM):   *------------------------------------------------------------*;
99243      /*; *"; *'; */
99244      ;
MPRINT(EM_DIAGRAM):   ;
99245      run;
MPRINT(EM_DIAGRAM):   run;
99246      quit;
MPRINT(EM_DIAGRAM):   quit;
99247      /* Reset EM Options */
99248      options formchar="|----|+|---+=|-/\<>*";
MPRINT(EM_DIAGRAM):   options formchar="|----|+|---+=|-/\<>*";
99249      options nocenter ls=256 ps=10000;
MPRINT(EM_DIAGRAM):   options nocenter ls=256 ps=10000;
99250      goptions reset=all device=WMF NODISPLAY;
MPRINT(EM_DIAGRAM):   goptions reset=all device=WMF NODISPLAY;
MPRINT(EM_DIAGRAM):    proc printto;
MPRINT(EM_DIAGRAM):   run;
MPRINT(EM_DIAGRAM):    data _null_;
MPRINT(EM_DIAGRAM):   call symput('NLDATE', strip(put(date(), NLDATE.)));
MPRINT(EM_DIAGRAM):   call symput('NLTIME', strip(put(datetime(), NLTIME.)));
MPRINT(EM_DIAGRAM):   run;
MPRINT(EM_DIAGRAM):   data _null_;
MPRINT(EM_DIAGRAM):   nldate= sasmsg("sashelp.dmine", "log_date_note", 'N', "19. April 2016" );
MPRINT(EM_DIAGRAM):   nltime= sasmsg("sashelp.dmine", "log_time_note", 'N', "17.21 Uhr" );
MPRINT(EM_DIAGRAM):   put "*------------------------------------------------------------*";
MPRINT(EM_DIAGRAM):   put "* Score Log";
MPRINT(EM_DIAGRAM):   put nldate;
MPRINT(EM_DIAGRAM):   put nltime;
MPRINT(EM_DIAGRAM):   put "*------------------------------------------------------------*";
MPRINT(EM_DIAGRAM):   run;
*------------------------------------------------------------*
* Score Log
Date:                19. April 2016
Time:                17.21 Uhr
*------------------------------------------------------------*
MPRINT(EM_DIAGRAM):    filename O3NN49FD "C:\\predictive-models-project\Workspaces\EMWS8\VarClus\EMSCORE.out" encoding="UTF-8" NOBOM;
MPRINT(EM_DIAGRAM):   proc printto print=O3NN49FD new;
MPRINT(EM_DIAGRAM):   run;
99352      %let EMEXCEPTIONSTRING=;
99353      *------------------------------------------------------------*;
MPRINT(EM_DIAGRAM):    *------------------------------------------------------------*;
99354      * SCORE: VarClus;
MPRINT(EM_DIAGRAM):   * SCORE: VarClus;
99355      *------------------------------------------------------------*;
MPRINT(EM_DIAGRAM):   *------------------------------------------------------------*;
99356      %let EM_ACTION = SCORE;
99357      %let syscc = 0;
99358
99359      %macro main;
99360
99361         filename temp catalog 'sashelp.emexpl.variableclustering_macros.source';
99362         %include temp;
99363         filename temp catalog 'sashelp.emexpl.variableclustering_macros2.source';
99364         %include temp;
99365         filename temp;
99366
99367        %SetProperties;
99368
99369         %if %upcase(&EM_ACTION) = CREATE %then %do;
99370             filename temp catalog 'sashelp.emexpl.variableclustering_create.source';
99371             %include temp;
99372             filename temp;
99373             %create;
99374         %end;
99375         %else
99376         %if %upcase(&EM_ACTION) = TRAIN %then %do;
99377              filename temp catalog 'sashelp.emexpl.variableclustering_train.source';
99378                 %include temp;
99379                 filename temp;
99380                 %train;
99381         %end;
99382         %else
99383         %if %upcase(&EM_ACTION) = SCORE %then %do;
99384                 filename temp catalog 'sashelp.emexpl.variableclustering_score.source';
99385                 %include temp;
99386                 filename temp;
99387                 %score;
99388         %end;
99389         %else
99390         %if %upcase(&EM_ACTION) = REPORT %then %do;
99391                 filename temp catalog 'sashelp.emexpl.variableclustering_report.source';
99392                 %include temp;
99393                 filename temp;
99394                 %report;
99395         %end;
99396         /*
99397         %if %upcase(&EM_ACTION) = OPENTESTTABLE %then %do;
99398             %put 'OPENING TABLE';
99399         %end;
99400         %if %upcase(&EM_ACTION) = CLOSETESTTABLE %then %do;
99401             %put 'CLOSE TABLE';
99402         %end;
99403         */
99404      %mend main;
99405      %main;
MPRINT(EM_DIAGRAM):
MPRINT(MAIN):   filename temp catalog 'sashelp.emexpl.variableclustering_macros.source';
NOTE: %INCLUDE (level 1) file TEMP is file SASHELP.EMEXPL.VARIABLECLUSTERING_MACROS.SOURCE.
99407     +/* Initialize property macro variables */
99408     +%macro SetProperties;
99409     +   %em_checkmacro(name=EM_PROPERTY_MAXCLUS,       global=Y, value=DEFAULT);
99410     +   %em_checkmacro(name=EM_PROPERTY_HIDEVARIABLE,  global=Y, value=Y);
99411     +   %em_checkmacro(name=EM_PROPERTY_PRINTOPTION,   global=Y, value=SHORT);
99412     +   %em_checkmacro(name=EM_PROPERTY_CLUSSOURCE,    global=Y, value=CORR);
99413     +   %em_checkmacro(name=EM_PROPERTY_CLUSCOMP,      global=Y, value=PRINCIPAL);
99414     +   %em_checkmacro(name=EM_PROPERTY_CLUSHIERACHY,      global=Y, value=Y);
99415     +   %em_checkmacro(name=EM_PROPERTY_INCLUDECLASSVAR,      global=Y, value=N);
99416     +   %em_checkmacro(name=EM_PROPERTY_EXPORTEDCOMP,      global=Y, value=CLUSTERCOMP);
99417     +   %em_checkmacro(name=EM_PROPERTY_MAXEIGEN,         global=Y, value=DEFAULT);
99418     +   %em_checkmacro(name=EM_PROPERTY_PROPORTION,      global=Y, value=DEFAULT);
99419     +   %em_checkmacro(name=EM_PROPERTY_PRINTOPTION,      global=Y, value=SHORT);
99420     +   %em_checkmacro(name=EM_PROPERTY_TWOSTAGECLUS,      global=Y, value=AUTO);
99421     +   %em_checkmacro(name=EM_PROPERTY_SUPPRESSSAMPWARN,      global=Y, value=N);
99423     +%mend SetProperties;
99425     +%Macro MakeDummyVariables(indata=,
99426     +                          outvar=,
99427     +                          outdata=,
99428     +                          fileref=,
99429     +                          recreatecmeta=N, /* optional */
99430     +                          incmeta=,     /* optional */
99431     +                          outcmeta=,    /* optional */
99432     +                          ndummyvars=_ndummyvars
99433     +                          );
99434     +    %global &ndummyvars;
99436     +    proc dmdb batch data=&indata out=_dmdbdat dmdbcat=_dmdbcat classout=_classout;;
99437     +       class
99438     +       %EM_BINARY_INPUT %EM_NOMINAL_INPUT %EM_ORDINAL_INPUT
99439     +       %EM_BINARY_REJECTED %EM_NOMINAL_REJECTED %EM_ORDINAL_REJECTED
99440     +    ;
99441     +    run;
99442     +    %let &ndummyvars = 0;
99443     +    data _null_;
99444     +    %let dsid = %sysfunc(open(work._classout));
99445     +      %let &ndummyvars = %sysfunc(attrn(&dsid, NOBS));
99446     +    %let dsid = %sysfunc(close(&dsid));
99447     +    run;
99449     +    proc dmzip data=_dmdbdat dmdbcat=_dmdbcat;
99450     +       input
99451     +       %EM_BINARY_INPUT %EM_NOMINAL_INPUT %EM_ORDINAL_INPUT
99452     +       %EM_BINARY_REJECTED %EM_NOMINAL_REJECTED %EM_ORDINAL_REJECTED
99453     +        / level=nominal stdize=no;
99454     +       make outvar = &outvar;
99455     +       score data = &indata out =&outdata;
99456     +       code  file=  "&fileref";
99457     +    run;
99458     +    %if &recreatecmeta eq Y %then %do;
99459     +    proc contents data =&outvar out=_tmpds(keep=NAME LABEL);
99460     +    data _tmpds;
99461     +        set _tmpds;
99462     +           ROLE = 'INPUT';
99463     +           LEVEL = 'INTERVAL';
99464     +           CREATOR='DMZIP';
99465     +           if NAME = '_TYPE_' then delete;
99466     +    run;
99467     +    data &outcmeta;
99468     +         set &incmeta _tmpds;
99469     +    run;
99470     +    %end;
99471     +    proc datasets lib=work nolist;
99472     +      delete  _dmdbdat _dmdbcat _classout
99473     +    %if &recreatecmeta eq Y %then %do;
99474     +    _tmpds
99475     +    %end;
99476     +    ;
99477     +    quit;
99478     +%Mend MakeDummyVariables;
99480     +/*--- Determine Optimal Number of Cluster ----
99481     +%macro FindClusNum(statds=, groupds=, minvariation=);
99482     +   %global optnclus;
99483     +   data varclus_tmp(drop=_NAME_);
99484     +      set &statDs;
99485     +      where _type_ ='PROPOR';
99486     +   run;
99487     +   proc sort data=varclus_tmp;
99488     +      by _NCL_;
99489     +   run;
99490     +   proc transpose data=varclus_tmp out=varclus_tmp;
99491     +      by _NCL_;
99492     +      var %EM_INTERVAL_INPUT
99493     +      %if &EM_PROPERTY_INCLUDECLASSVAR eq Y %then %do;
99494     +      %let dsid = %sysfunc(open(&EM_USER_OUTDUMMY));
99495     +      %let nvar = %sysfunc(attrn(&dsid, NVAR));
99496     +          %do i = 2 %to &nvar;
99497     +          %let varname = %sysfunc(varname(&dsid, &i));
99498     +          &varname
99499     +          %end;
99500     +      %end;
99501     +   ;
99502     +   run;
99504     +   %if &minVariation eq %then %do;
99505     +       %let minVariation = &EM_PROPERTY_MINVARIATION;
99506     +   %end;
99507     +   %if ^(0<&minVariation<100) %then %do;
99508     +       %let minVariation = 90;
99509     +   %end;
99511     +   data _null_;
99512     +      set varclus_tmp end=eof;
99513     +      by _NCL_;
99514     +      retain flag 0;
99515     +      if first._ncl_ then flag=0;
99516     +      if .<col1 < &minVariation then flag=1;
99517     +      if last._ncl_ and ^flag then do;
99518     +         call symput('OPTNCL', _ncl_);
99519     +         stop;
99520     +      end;
99521     +     if eof then call symput('OPTNCL', _ncl_);
99522     +   run;
99524     +   %let optnclus = &OPTNCL;
99526     +   data varclus_tmp(drop=_NCL_ _NAME_);
99527     +      set &statDs;
99528     +      where _type_ in('RSQUARED' 'GROUP') and _NCL_=&OPTNCL;
99529     +   run;
99530     +   proc sort data=varclus_tmp;
99531     +      by _TYPE_;
99532     +   run;
99533     +   proc transpose data=varclus_tmp out=varclus_tmp;
99534     +      by _TYPE_;
99535     +   run;
99536     +   proc sort data=varclus_tmp;
99537     +      by _name_ _type_;
99538     +   run;
99540     +  proc transpose data=varclus_tmp out=&groupds;
99541     +      by _NAME_;
99542     +   run;
99543     +   proc sort data=&groupDs(rename=(col1=Cluster col2=Rsquare _NAME_=VARIABLE));
99544     +      by Cluster descending Rsquare;
99545     +      where Cluster ne 0;
99546     +   run;
99547     +   proc datasets lib=work nolist mt=(DATA VIEW);
99548     +      delete varclus_tmp;
99549     +   run;
99550     +   quit;
99551     +%mend findClusNum;
99552     +*/
99554     +%macro getNclusfromTrain(inoutstat=, nc=);
99555     +%global &nc;
99556     +data _null_;
99557     +    set &inoutstat end=eof;
99558     +    if eof then do;
99559     +    call symput("&nc", _ncl_);
99560     +    end;
99561     +run;
99562     +%mend  getNclusfromTrain;
99564     +%macro MakeDeltaCode(groupds=, outstatscore=, deltacodefile=);
99566     +     *--- Build Code to Modify Metadata ---*;
99567     +     filename X "&deltacodefile";
99568     +     data _null_;
99569     +        FILE X;
99570     +        set &groupds end=eof;
99571     +        /*by Cluster;*/
99572     +         if _N_=1 then do;
99573     +           %if &EM_PROPERTY_INCLUDECLASSVAR eq Y %then %do;
99574     +            put "if upcase(strip(ROLE)) ='INPUT' and upcase(strip(LEVEL)) ^='INTERVAL' then ROLE ='REJECTED' ;";
99575     +           %end;
99576     +           put "if upcase(strip(ROLE))='INPUT' and upcase(strip(LEVEL))='INTERVAL' then do;";
99577     +           put "if upcase(strip(NAME)) in (";
99578     +        end;
99579     +        if Strip(upcase(Selected)) eq 'YES' then do;
99580     +           string = '"'!!trim(left(VARIABLE))!!'"';
99581     +           put string;
99582     +        end;
99583     +        if eof then do;
99584     +           put ') then ROLE="INPUT";';
99585     +           put 'else ROLE="REJECTED";';
99586     +           put 'end;';
99588     +           %if %upcase(&EM_PROPERTY_HIDEVARIABLE) eq Y %then %do;
99589     +             put 'if upcase(strip(ROLE)) = "REJECTED" then delete ;';
99590     +           %end;
99591     +        end;
99592     +     run;
99593     +     quit;
99595     +     filename X;
99597     +     quit;
99598     +%mend MakeDeltaCode;
99600     +%macro MakeVarClusCorrData(statds=, corrds=, corrplotds= );
99601     +    %if ^%sysfunc(exist(&statds)) %then %do;
99602     +         %goto doendc;
99603     +    %end;
99605     +    data &corrds(drop=_TYPE_ _NCL_) ;
99606     +       set &statds;
99607     +       where _type_ eq 'CORR' ;
99608     +    run ;
99609     +    proc sort data=&corrds;
99610     +       by _NAME_ ;
99611     +    run ;
99612     +    proc transpose data=&corrds out=&corrplotds name=_TMP_;
99613     +      BY _NAME_ ;
99614     +    run ;
99615     +    data &corrplotds;
99616     +       length _Y_ $100;
99617     +       set &corrplotDs;
99618     +       if _LABEL_ ne '' then _Y_=_LABEL_ ; else _Y_=_TMP_ ;
99619     +    run ;
99620     +    data varclus_match(rename=(_TMP_= _NAME_ _LABEL_=_X_));
99621     +       set &corrplotds;
99622     +       where _LABEL_ ne '' ;
99623     +       keep _TMP_ _LABEL_ ;
99624     +    run ;
99625     +    data _null_;
99626     +       nobs=0;
99627     +       dsid = open('varclus_match');
99628     +       if dsid then do;
99629     +          nobs = attrn(dsid, 'NOBS');
99630     +          dsid = close(dsid);
99631     +       end;
99632     +       call symput ('CORR_NOBS', nobs);
99633     +    run;
99634     +    %if &corr_nobs %then %do;
99635     +        proc sort data=varclus_match;
99636     +           by _name_;
99637     +        run ;
99638     +        proc sort data=&corrplotds;
99639     +           by _name_;
99640     +        run ;
99641     +        data &corrplotds(keep= _X_ _Y_ col1 rename=(col1=Correlation)) ;
99642     +           merge varclus_match &corrplotds;
99643     +           by _NAME_ ;
99644     +           if _X_ eq '' then _X_=_NAME_ ;
99645     +           label _X_ = "%sysfunc(sasmsg(sashelp.dmine, rpt_varclus_label_variable, noquote))";
99646     +           label _Y_ = "%sysfunc(sasmsg(sashelp.dmine, rpt_varclus_label_variable, noquote))";
99647     +           label col1 = "%sysfunc(sasmsg(sashelp.dmine, rpt_correlation_vlabel, noquote))";
99649     +       run ;
99650     +    %end;
99651     +    %else %do;
99652     +        proc sort data=&corrplotds;
99653     +           by _name_;
99654     +        run ;
99655     +        data &corrplotds(keep= _NAME_ _Y_ col1 rename=(_NAME_=_X_ col1=Correlation)) ;
99656     +           set &corrplotds;
99657     +           label _NAME_ = "%sysfunc(sasmsg(sashelp.dmine, rpt_varclus_label_variable, noquote))" ;
99658     +           label _Y_ = "%sysfunc(sasmsg(sashelp.dmine, rpt_varclus_label_variable, noquote))" ;
99659     +           label col1 = "%sysfunc(sasmsg(sashelp.dmine, rpt_correlation_vlabel, noquote))";
99661     +        run ;
99662     +    %end;
99663     +    proc sort data=&corrplotds;
99664     +       by _X_ _Y_;
99665     +    run ;
99666     +    proc datasets lib=work nolist mt=(DATA VIEW);
99667     +       delete varclus_match;
99668     +    run;
99669     +    quit;
99671     +%doendc:
99673     +%mend MakeVarClusCorrData;
99675     +%macro MakeStatPlotData(statds= , outstatplotds=);
99676     +   %if %sysfunc(exist(&statds)) %then %do;
99678     +       data varclus_tmp(drop=_NAME_ _NCL_) ;
99679     +          set &statDs;
99680     +          where _type_ in('MEAN', 'STD', 'N');
99681     +       run ;
99682     +       proc transpose data=varclus_tmp out=&outstatplotds;
99683     +          id _TYPE_ ;
99684     +       run ;
99685     +       data &outstatplotds;
99686     +          set &outstatplotds(obs=1000);
99687     +          label _name_= "%sysfunc(sasmsg(sashelp.dmine, rpt_varclus_label_name, noquote))";
99688     +          label _label_="%sysfunc(sasmsg(sashelp.dmine, rpt_varclus_label_label, noquote))" ;
99689     +          if MEAN ne 0 then SCALEDSTD= STD / MEAN ;
99690     +          else SCALEDSTD= STD ;
99691     +          label SCALEDSTD = "%sysfunc(sasmsg(sashelp.dmine, rpt_varclus_label_scaledstd, noquote))";
99692     +       run ;
99693     +       proc sort data=&outstatplotds;
99694     +          by descending SCALEDSTD ;
99695     +       run ;
99696     +       proc datasets lib=work nolist mt=(DATA VIEW);
99697     +          delete varclus_tmp;
99698     +       run;
99699     +       quit;
99700     +    %end;
99702     +%mend MakeStatPlotData;
99705     +%macro CreateScoreCode(indata=, ncluscomp=, fileref=);
99706     +     %EM_GETNAME(KEY=OUTSTATSCORE, type=DATA);
99707     +    data &EM_USER_OUTSTATSCORE;
99708     +          set &indata;
99709     +          if (_TYPE_ in ('SCORE' 'MEAN' 'STD') and _NCL_ = &ncluscomp ) or (_TYPE_ in ('MEAN' 'STD'));
99710     +          if _TYPE_ = 'MEAN' then _NAME_='MEAN';
99711     +          if _TYPE_ = 'STD' then _NAME_='STD';
99712     +          DROP _TYPE_ _NCL_;
99713     +     run;
99715     +     filename _file_  "&fileRef";
99717     +     data _null_;
99718     +        FILE _file_ MOD;
99719     +        put ' ';
99720     +        put '/*-------------------------------------------------*/';
99721     +        put '/* ' "%sysfunc(sasmsg(sashelp.dmine, rpt_varclus_score_title_begin , noquote))" '*/';
99722     +        put '/*-------------------------------------------------*/';
99723     +        put ' ';
99724     +        %let dsid = %sysfunc(open(&EM_USER_OUTSTATSCORE));
99726     +        %let nvar = %sysfunc(attrn(&dsid, NVAR));
99727     +        %let vn_name =%sysfunc(varnum(&dsid, _NAME_));
99729     +        %let k = 1;
99730     +        %do %while(^%sysfunc(fetch(&dsid)));
99731     +                %let _name = %sysfunc(getvarc(&dsid, &vn_name));
99732     +                %if &k > 2 %then %do;
99733     +                 %let cn = %eval(&k-2);
99734     +                 put "&_name = 0 ; /*---" "%sysfunc(sasmsg(sashelp.dmine, rpt_varclus_score_cluscompnum, noquote, &cn))"  "------ */";
99735     +                %end;
99736     +                %let k = %eval(&k+1);
99737     +        %end;
99739     +        %let rc = %sysfunc(rewind(&dsid));
99741     +        %do i= 2 %to &nvar;
99742     +            %let _varname =  %sysfunc(varname(&dsid, &i));
99743     +            %do %while(^%sysfunc(fetch(&dsid)));
99744     +                %let _name = %sysfunc(getvarc(&dsid, &vn_name));
99745     +                %if &_name = MEAN %then
99746     +                %let _mean = %sysfunc(getvarn(&dsid, &i));
99747     +                %else %if &_name = STD %then
99748     +                %let _std = %sysfunc(getvarn(&dsid, &i));
99749     +                %else %do;
99750     +                      %let coeff =  %sysfunc(getvarn(&dsid, &i));
99751     +                      %let abscoeff = %sysfunc(abs(&coeff));
99752     +                          %if &abscoeff >  0 %then %do;
99753     +                       put "&_name = &_name+&coeff * (&_varname - &_mean)/&_std;";
99754     +                           %end;
99755     +                 %end;
99756     +             %end;
99757     +             %let rc = %sysfunc(rewind(&dsid));
99758     +         %end;
99760     +        %let dsid= %sysfunc(close(&dsid));
99761     +       run;
99762     +%mend CreateScoreCode;
99766     +/*----------------------------------------------------------
99767     +    Instead of using %MakeRSquareData,
99768     +    %MakeVarClusResultTable at macro2.source is used
99769     + +----------------------------------------------------------*/
99772     +%macro MakeRSquareData(indata=, inClusRSquare=, outdata=, ncluster=);
99774     +/* modifying  from ods rsquare = data */
99776     +data &outdata(drop= ControlVar  NumberOfClusters CurrentCluster);
99777     +    Length Cluster $16;
99778     +    length Variable $32;
99779     +    Length VariableLabel $64;
99780     +    set &indata; retain CurrentCluster;
99781     +    if NumberOfClusters ^= &ncluster then delete;
99782     +    if strip(Cluster) eq '' then Cluster = CurrentCluster;
99783     +    CurrentCluster = Cluster;
99784     +   run;
99785     +proc sort data =&outdata ;
99786     +     by Cluster RsquareRatio;
99787     +run;
99788     +data _tmprsq(drop=index);
99789     +     set &outdata; by Cluster;
99790     +     if first.Cluster then do;
99791     +     index = strip(scan(Cluster,2 ));
99792     +     Variable = "Clus"||index;
99793     +     VariableLabel = "Cluster Component "||index;
99794     +     OwnCluster = 1;
99795     +     NextClosest = .;
99796     +     RsquareRatio = 0;
99797     +     output;
99798     +     end;
99799     +run;
99801     +proc sort data = _tmprsq ;
99802     +     by Cluster RsquareRatio;
99803     +run;
99804     +data &outdata;
99805     +     set &outdata _tmprsq;
99806     +by Cluster;
99807     +run;
99810     +/* Just create the Selected variable with all YES */
99812     +data &outdata;
99813     +    set &outdata; by cluster;
99814     +    length Selected $8;
99815     +    Selected = 'YES';
99816     +    label  OwnCluster = 'R-Sqaure with Cluster Component';
99817     +    label  NextClosest = 'R-Sqaure with Next Cluster Component';
99818     +    rename OwnCluster = RSqWithClusterComp;
99819     +    rename NextClosest = RSqWithNextClusComp;
99820     +run;
99823     +/* Selected = Y/N will be done %score section -----
99825     +%if &EM_PROPERTY_EXPORTEDCOMP ne CLUSTERCOMP %then %do;
99826     +data &outdata;
99827     +    set &outdata; by cluster;
99828     +    length Selected $8;
99829     +    if first.Cluster then Selected = 'YES';
99830     +    else Selected = 'NO';
99831     +    label  OwnCluster = 'R-Sqaure with Cluster Component';
99832     +    label  NextClosest = 'R-Sqaure with Next Cluster Component';
99833     +    rename OwnCluster = RSqWithClusterComp;
99834     +    rename NextClosest = RSqWithNextClusComp;
99835     +run;
99836     +%end;
99837     +%else %do;
99838     +data &outdata;
99839     +    set &outdata; by cluster;
99840     +    if last.Cluster then Selected = 'YES';
99841     +    else Selected = 'NO';
99842     +    label  OwnCluster = 'R-Sqaure with Cluster Component';
99843     +    label  NextClosest = 'R-Sqaure with Next Cluster Component';
99844     +    rename OwnCluster = RSqWithClusterComp;
99845     +    rename NextClosest = RSqWithNextClusComp;
99846     +run;
99847     +%end;
99848     +---------------------------------------------------------------*/
99850     +%if %sysfunc(exist(&inClusRSquare)) %then %do;
99851     +/* to calculate NextClosestClusRsq */
99852     +proc transpose data = &inClusRSquare  out=_clusRsq;
99853     +      by cluster;
99854     +      run;
99855     +data _clusRsq;
99856     +     set _clusRsq;
99857     +     if strip(upcase(Cluster)) eq strip(upcase(_NAME_)) then delete;
99858     +run;
99860     +proc sort data=_clusRsq;
99861     +    by cluster col1;
99862     +    run;
99863     +data _clusRsq(drop=_NAME_ _LABEL_);
99864     +     set _clusRsq; by cluster;
99865     +     if last.Cluster then output;
99866     +     label  COL1 = 'R-Sqaure with Next Cluster Component';
99867     +     rename COL1 = RSqWithNextClusComp;
99868     +     rename Cluster = Variable;
99869     +     label  Cluster = "Variable";
99870     +run;
99872     +proc sort data =&outdata;
99873     +     by Variable;
99874     +run;
99875     +data &outdata;
99876     +    merge &outdata _clusRsq;
99877     +    by Variable;
99878     +run;
99879     +proc sort data =&outdata;
99880     +by Cluster  RsquareRatio;
99881     +run;
99882     +quit;
99883     +%end;
99885     +proc datasets lib = work nolist;
99886     +     delete _tmprsq _clusRsq;
99887     +     run;
99888     +quit;
99890     +%mend MakeRSquareData;
99893     +/*-------------------------------------------------------------------------*/
99897     +%macro ModifyCorr(indata=,
99898     +                  outdata=,
99899     +                  rsquare = Y
99900     +                  );
99901     +    data corr_tmp;
99902     +        set &indata;
99903     +    run;
99904     +     proc sql;
99905     +           update &indata
99906     +           set
99907     +     %let dsid = %sysfunc(open(work.corr_tmp));
99908     +     %let nvar = %sysfunc(attrn(&dsid, NVAR));
99909     +          %do i = 4 %to &nvar;
99910     +          %let _name = %sysfunc(varname(&dsid, &i));
99911     +             %if &rsquare eq Y %then %let _name_md = &_name.**2;
99912     +            %else  %let _name_md = &_name;
99913     +            %if &i < &nvar %then %do;
99914     +               &_name = 1- &_name_md ,
99915     +            %end;
99916     +            %else %do;
99917     +               &_name = &_name_md where _TYPE_ contains 'CORR' ;
99918     +            %end;
99919     +          %end;
99920     +      %let dsid= %sysfunc(close(&dsid));
99922     +      select * from &indata;
99923     +      run;
99924     +      proc datasets lib = work nolist;
99925     +           delete corr_tmp;
99926     +      run;
99927     +      quit;
99929     + %mend ModifyCorr;
99931     + %macro MakeClusStructCorrData(indata=,outdata=, ncluster=, Rsquare=N);
99932     +    data &outdata(drop= _NCL_  _TYPE_);
99933     +       set &indata;
99934     +       if ^(strip(_NCL_) eq &ncluster and strip(_TYPE_) eq 'STRUCTUR') then delete;
99935     +       rename _NAME_ = Cluster;
99936     +       label _NAME_ = "%sysfunc(sasmsg(sashelp.dmine, rpt_varclus_label_clustername,  noquote))";
99937     +    run;
99938     +    %if &RSquare eq Y %then %do;
99939     +     data corr_tmp;
99940     +        set &outdata;
99941     +     run;
99943     +     data &outdata(drop=i);
99944     +          set &outdata;
99945     +          %let dsid = %sysfunc(open(work.corr_tmp));
99946     +          %let nvar = %sysfunc(attrn(&dsid, NVAR));
99947     +          %do i = 2 %to &nvar;
99948     +            %let _name = %sysfunc(varname(&dsid, &i));
99949     +            %let _name_md = &_name.**2;
99950     +                &_name = &_name_md;
99951     +          %end;
99952     +      %let dsid= %sysfunc(close(&dsid));
99953     +      run;
99954     +      proc datasets lib = work nolist;
99955     +           delete corr_tmp;
99956     +      run;
99958     +    %end;
99959     +     quit;
99960     +%mend MakeClusStructCorrData;
99962     +%macro MakeInterClusCorrData(indata=, outdata=, ncluster=, RSquare=N, makeplotds=N, plotds=);
99963     +    data &outdata(drop= _NCL_  _TYPE_);
99964     +       set &indata;
99965     +       if ^(strip(_NCL_) eq &ncluster and strip(_TYPE_) eq 'CCORR') then delete;
99966     +       rename _NAME_ = Cluster;
99967     +       label _NAME_ = "%sysfunc(sasmsg(sashelp.dmine, rpt_varclus_label_clustername,  noquote))";
99968     +    run;
99969     +    data corr_tmp;
99970     +        set &outdata;
99971     +    run;
99973     +    %let dsid = %sysfunc(open(work.corr_tmp));
99974     +    %let nclus2= %eval(&ncluster+1);
99975     +    data &outdata;
99976     +         set &outdata;
99977     +          %do i = 2 %to &nclus2;
99978     +          %let i_1 = %eval(&i-1);
99979     +            %let _name = %sysfunc(varname(&dsid, &i));
99980     +            %let _newName = Clus&i_1;
99981     +                rename &_name = &_newName; ;
99982     +                *label &_name ="Cluster &i_1";
99983     +                label &_name = "%sysfunc(sasmsg(sashelp.dmine, rpt_varclus_label_clusternum, noquote,  &i_1))";
99984     +          %end;
99985     +          keep Cluster
99986     +          %do i = 2 %to &nclus2;
99987     +                %let _name = %sysfunc(varname(&dsid, &i));
99988     +                &_name
99989     +          %end;
99990     +          ;
99991     +    %let dsid= %sysfunc(close(&dsid));
99992     +     run;
99993     +     quit;
99995     +    %if &RSquare eq Y %then %do;
99997     +       data corr_tmp;
99998     +        set &outdata;
99999     +     run;
100001    +     data &outdata(drop=i);
100002    +          set &outdata;
100003    +          %let dsid = %sysfunc(open(work.corr_tmp));
100004    +          %let nvar = %sysfunc(attrn(&dsid, NVAR));
100005    +          %do i = 2 %to &nvar;
100006    +            %let _name = %sysfunc(varname(&dsid, &i));
100007    +            %let _name_md = &_name.**2;
100008    +                &_name = &_name_md;
100009    +          %end;
100010    +      %let dsid= %sysfunc(close(&dsid));
100011    +      run;
100012    +    %end;
100014    +    %if &makeplotds eq Y %then %do;
100015    +     proc transpose data = &outdata
100016    +          out=&plotds(drop=_LABEL_ rename=(_NAME_ = Y Cluster=X Col1= Correlation));
100017    +          by cluster;
100018    +     run;
100019    +     data &plotds;
100020    +          set  &plotds;
100021    +          label x="%sysfunc(sasmsg(sashelp.dmine, rpt_varclus_label_cluster, noquote))";
100022    +          label Y="%sysfunc(sasmsg(sashelp.dmine, rpt_varclus_label_cluster, noquote))";
100023    +     run;
100024    +     %end;
100025    +     proc datasets lib = work nolist;
100026    +           delete corr_tmp;
100027    +     run;
100028    +     quit;
100029    +%mend MakeInterClusCorrData;
100032    +%macro MakeClusConstellData(indata=, outlink=, outnode=);
100034    +data &outlink(drop = Selected);
100035    +     set &indata;
100036    +     LINKID = _N_;
100037    +     label LINKID = "%sysfunc(sasmsg(sashelp.dmine, rpt_varclus_label_linkid,  noquote))";
100038    +     if strip(upcase(Cluster)) eq strip(upcase(Variable)) then Variable = ClosestCluster;
100039    +run;
100040    +data &outnode(keep=NODEID TYPE LABEL);
100041    +    set &indata;
100042    +    length TYPE $16;
100043    +    rename Variable = NODEID;
100044    +    label  Variable= "%sysfunc(sasmsg(sashelp.dmine, rpt_varclus_label_nodeidvar, noquote))";
100045    +    if strip(upcase(Cluster)) eq strip(upcase(Variable))
100046    +    then  TYPE = "CLUSTER";
100047    +    else  TYPE="VARIABLE";
100048    +    label TYPE = "%sysfunc(sasmsg(sashelp.dmine, rpt_varclus_label_nodetype, noquote))";
100049    +run;
100050    +quit;
100051    +%mend MakeClusConstellData;
100055    +%macro MakeClusConstellData(indata=, outlink=, outnode=);
100057    +data &outlink(drop = Selected);
100058    +     set &indata;
100059    +     LINKID = _N_;
100060    +     label LINKID = "%sysfunc(sasmsg(sashelp.dmine, rpt_varclus_label_linkid,  noquote))";
100061    +     if strip(upcase(Cluster)) eq strip(upcase(Variable)) then Variable = ClosestCluster;
100062    +run;
100063    +data &outnode(keep=NODEID TYPE LABEL);
100064    +    set &indata;
100065    +    length TYPE $16;
100066    +    rename Variable = NODEID;
100067    +    label  Variable= "%sysfunc(sasmsg(sashelp.dmine, rpt_varclus_label_nodeidvar, noquote))";
100068    +    if strip(upcase(Cluster)) eq strip(upcase(Variable))
100069    +    then  TYPE = "CLUSTER";
100070    +    else  TYPE="VARIABLE";
100071    +    label TYPE = "%sysfunc(sasmsg(sashelp.dmine, rpt_varclus_label_nodetype, noquote))";
100072    +run;
100073    +quit;
100074    +%mend MakeClusConstellData;
100077    +/*--- This will work only when inds is not a view data -------
100079    +%macro getNVarNObs(inds=, nvar=, nobs=);
100081    +    %global &nvar;
100082    +    %global &nobs;
100083    +    data _null_;
100084    +         dsid = open("&inds");
100085    +         nv = attrn(dsid, 'NVAR');
100086    +         no = attrn(dsid, 'NOBS');
100087    +         dsid = close(dsid);
100088    +         call symput("&nvar", nv);
100089    +         call symput("&nobs", no);
100090    +    run;
100091    +    quit;
100092    +%mend  getNVarNObs;
100094    ++---------------------------------------------------------------*/
100097    +%macro getNVar(inds=, nvar=);
100098    +    %global &nvar;
100099    +    data _null_;
100100    +         dsid = open("&inds");
100101    +         nv = attrn(dsid, 'NVAR');
100102    +         dsid = close(dsid);
100103    +         call symput("&nvar", nv);
100104    +    run;
100105    +    quit;
100106    +%mend  getNVar;
100110    +%macro getNObs(inds=, nobs=);
100111    +    %global &nobs;
100112    +    data _null_;
100113    +        set &inds end=eof;
100114    +        if eof then call symput("&nobs", _N_);
100115    +    run;
100116    +    quit;
100117    +%mend  getNObs;
100119    +%Macro CreateVarclusMeta(trainnum=);
100120    +   %EM_GETNAME(KEY=VARCLUSMETA, TYPE=DATA);
100121    +    data &EM_USER_VARCLUSMETA;
100122    +         length TrainNum 8.;
100123    +         length NewTrain $8;
100124    +         length NGCluster 8.;
100125    +         length ExportedComp $16;
100126    +         length HideVariable $8;
100127    +         TrainNum = &trainnum;
100128    +         NewTrain = "Y";
100129    +         ExportedComp = "&EM_PROPERTY_EXPORTEDCOMP";
100130    +         HideVariable = "&EM_PROPERTY_HIDEVARIABLE";
100131    +         NGCluster = 0; /* zero means no twostage */
100132    +   run;
100133    +   quit;
100134    +%mend CreateVarclusMeta;
NOTE: %INCLUDE (level 1) ending.
MPRINT(MAIN):   filename temp catalog 'sashelp.emexpl.variableclustering_macros2.source';
NOTE: %INCLUDE (level 1) file TEMP is file SASHELP.EMEXPL.VARIABLECLUSTERING_MACROS2.SOURCE.
100136    +%macro MakeInterClusCorrData(indata=, outdata=, ncluster=, globalclusid=, RSquare=N, makeplotds=N, plotds=);
100137    +    data &outdata(drop= _NCL_  _TYPE_);
100138    +       set &indata;
100139    +       if ^(strip(_NCL_) eq &ncluster and strip(_TYPE_) eq 'CCORR') then delete;
100140    +       %if &globalclusid ne %then %do;
100141    +       _NAME_ = "GC&globalclusid._"||upcase(_NAME_);
100142    +       rename _NAME_ = Cluster;
100143    +       %end;
100144    +       %else %do;
100145    +        _NAME_ = upcase(_NAME_);
100146    +       rename _NAME_ = Cluster;
100147    +       %end;
100148    +       label _NAME_ = "%sysfunc(sasmsg(sashelp.dmine, rpt_varclus_label_clustername,  noquote))";
100149    +    run;
100150    +    data corr_tmp;
100151    +        set &outdata;
100152    +    run;
100154    +    %let dsid = %sysfunc(open(work.corr_tmp));
100155    +    %let nclus2= %eval(&ncluster+1);
100156    +    data &outdata;
100157    +         set &outdata;
100158    +          %do i = 2 %to &nclus2;
100159    +          %let i_1 = %eval(&i-1);
100160    +            %let _name = %sysfunc(varname(&dsid, &i));
100161    +            %if &globalclusid ne %then
100162    +                %do; %let _newName = GC&globalclusid._CLUS&i_1;
100163    +                     rename &_name = &_newName;
100164    +                     *label &_name ="GC &globalclusid : Cluster &i_1";
100165    +                     label &_name = "%sysfunc(sasmsg(sashelp.dmine, rpt_varclus_label_gc_clusternum, noquote,  &globalclusid, &i_1))";
100166    +                %end;
100167    +            %else
100168    +                %do; %let _newName = CLUS&i_1;
100169    +                     rename &_name = &_newName;
100170    +                     *label &_name ="Cluster &i_1";
100171    +                     label &_name = "%sysfunc(sasmsg(sashelp.dmine, rpt_varclus_label_clusternum, noquote,  &i_1))";
100172    +                %end;
100173    +          %end;
100174    +          keep Cluster
100175    +          %do i = 2 %to &nclus2;
100176    +                %let _name = %sysfunc(varname(&dsid, &i));
100177    +                &_name
100178    +          %end;
100179    +          ;
100180    +    %let dsid= %sysfunc(close(&dsid));
100181    +     run;
100182    +     quit;
100184    +    %if &RSquare eq Y %then %do;
100186    +       data corr_tmp;
100187    +        set &outdata;
100188    +     run;
100190    +     data &outdata;
100191    +          set &outdata;
100192    +          %let dsid = %sysfunc(open(work.corr_tmp));
100193    +          %let nvar = %sysfunc(attrn(&dsid, NVAR));
100194    +          %do i = 2 %to &nvar;
100195    +            %let _name = %sysfunc(varname(&dsid, &i));
100196    +            %let _name_md = &_name.**2;
100197    +                &_name = &_name_md;
100198    +          %end;
100199    +      %let dsid= %sysfunc(close(&dsid));
100200    +      run;
100201    +    %end;
100203    +    %if &makeplotds eq Y %then %do;
100204    +     proc transpose data = &outdata
100205    +          out=&plotds(drop=_LABEL_ rename=(_NAME_ = Y Cluster=X Col1= Correlation));
100206    +          by cluster;
100207    +     run;
100208    +     data &plotds;
100209    +          set  &plotds;
100210    +          label x="%sysfunc(sasmsg(sashelp.dmine, rpt_varclus_label_cluster, noquote))";
100211    +          label Y="%sysfunc(sasmsg(sashelp.dmine, rpt_varclus_label_cluster, noquote))";
100212    +          label  Correlation="%sysfunc(sasmsg(sashelp.dmine, rpt_correlation_vlabel, noquote))";
100213    +     run;
100214    +     %end;
100215    +     proc datasets lib = work nolist;
100216    +           delete corr_tmp;
100217    +     run;
100218    +     quit;
100219    +%mend MakeInterClusCorrData;
100221    +%macro MakeOwnRSquare(indata=, outdata=, ncluster=, globalclusid=);
100222    +    data _tmpds(drop= _NCL_);
100223    +       set &indata;
100224    +       if ^(strip(_NCL_) eq &ncluster and strip(_TYPE_) in ('GROUP','RSQUARED')) then delete;
100225    +       %if &globalclusid ne %then %do;
100226    +           _NAME_ = "GC&globalclusid.";
100227    +       rename _NAME_ = Cluster;
100228    +       %end;
100229    +       %else %do;
100230    +        _NAME_ = "CLUS";
100231    +        rename _NAME_ = Cluster;
100232    +       %end;
100233    +       label _NAME_ = "%sysfunc(sasmsg(sashelp.dmine, rpt_varclus_label_clustername,  noquote))";
100234    +    run;
100235    +    proc transpose data =_tmpds out =&outdata;
100236    +    run;
100238    +    data &outdata(drop=COL1);
100239    +        %if &globalclusid ne %then %do;
100240    +        length GCluster $16;
100241    +        %end;
100242    +        length Cluster $32;
100243    +        length _NAME_ $32;
100244    +         set &outdata;
100245    +         _NAME_ = upcase(_NAME_);
100246    +         rename _NAME_=Variable;
100247    +         *label _NAME_="Variable";
100248    +         label _NAME_ = "%sysfunc(sasmsg(sashelp.dmine, rpt_varclus_label_variable, noquote))" ;
100249    +         label Cluster = "%sysfunc(sasmsg(sashelp.dmine, rpt_varclus_label_cluster, noquote))" ;
100250    +         label GCluster = "%sysfunc(sasmsg(sashelp.dmine, rpt_varclus_label_gcluster, noquote))" ;
100252    +         %if &globalclusid ne %then %do;
100253    +          GCluster = "GC&globalclusid";
100254    +          Cluster = "GC&globalclusid._CLUS"||strip(COL1);
100255    +         %end;
100256    +         %else %do;
100257    +         Cluster = "CLUS"||strip(COL1);
100258    +        %end;
100259    +         rename COL2 = RSqWithOwnClusComp;
100260    +         *label COL2 = "R-Square With Own Cluster Component";
100261    +         label COL2 = "%sysfunc(sasmsg(sashelp.dmine, rpt_varclus_label_ownrsq, noquote))" ;
100263    +   run;
100264    +   proc sort data =&outdata;
100265    +        by Cluster RSqWithOwnClusComp;
100266    +   run;
100267    +   proc datasets lib = work nolist;
100268    +           delete _tmpds;
100269    +   run;
100270    +   quit;
100271    +%mend MakeOwnRSquare;
100273    +%macro MakeClusStructCorrData(indata=, outdata=, globalclusid=, ncluster=, Rsquare=N);
100274    +    data &outdata(drop= _NCL_  _TYPE_);
100275    +       %if &globalclusid ne %then %do;
100276    +        length GCluster $16;
100277    +        %end;
100278    +       set &indata;
100279    +       if ^(strip(_NCL_) eq &ncluster and strip(_TYPE_) eq 'STRUCTUR') then delete;
100280    +       %if &globalclusid ne %then %do;
100281    +         GCluster = "GC&globalclusid";
100282    +         _NAME_ = "GC&globalclusid._"||upcase(_NAME_);
100283    +         rename _NAME_ = Cluster;
100284    +         label _NAME_ = "%sysfunc(sasmsg(sashelp.dmine, rpt_varclus_label_cluster, noquote))" ;
100285    +         label GCluster = "%sysfunc(sasmsg(sashelp.dmine, rpt_varclus_label_gcluster, noquote))" ;
100287    +       %end;
100288    +       %else %do;
100289    +         _NAME_ = upcase(_NAME_);
100290    +         rename _NAME_ = Cluster;
100291    +         label _NAME_ = "%sysfunc(sasmsg(sashelp.dmine, rpt_varclus_label_cluster, noquote))" ;
100292    +         label GCluster = "%sysfunc(sasmsg(sashelp.dmine, rpt_varclus_label_gcluster, noquote))" ;
100294    +       %end;
100295    +     run;
100296    +    %if &RSquare eq Y %then %do;
100297    +     data corr_tmp;
100298    +          set &outdata;
100299    +     run;
100300    +     %let istart = 2;
100301    +     %if &globalclusid ne %then %let istart = 3;
100302    +     data &outdata;
100303    +          set &outdata;
100304    +          %let dsid = %sysfunc(open(work.corr_tmp));
100305    +          %let nvar = %sysfunc(attrn(&dsid, NVAR));
100306    +          %do i =&istart %to &nvar;
100307    +            %let _name = %sysfunc(varname(&dsid, &i));
100308    +            %let _name_md = &_name.**2;
100309    +                &_name = &_name_md;
100310    +          %end;
100311    +      %let dsid= %sysfunc(close(&dsid));
100312    +      run;
100313    +      proc datasets lib = work nolist;
100314    +           delete corr_tmp;
100315    +      run;
100316    +    %end;
100317    +     quit;
100318    +%mend MakeClusStructCorrData;
100320    +/*
100321    +%MakeClusStructCorrData(indata=playpen._outstat, outdata=_structrsq , ncluster=7, Rsquare=Y);
100322    +*/
100324    +%macro FindNextClosestClusByVar(indata=, outdata=, globalclusid=, ncluster=);
100326    +     /* The indata should be the outdata
100327    +        from %MakeClusStructCorrData(indata=, outdata=, ); */
100329    +     proc sort data =&indata out=_tmpclusRsq;
100330    +     by cluster;
100331    +     run;
100333    +     proc transpose data =_tmpclusRsq out=_tmpclusRsq;
100334    +      by cluster;
100335    +     run;
100337    +     proc sort data=_tmpclusRsq;
100338    +        by _NAME_ COL1;
100339    +     run;
100341    +     data _tmpclusRsq;
100342    +         length _NAME_ $32;
100343    +         set _tmpclusRsq; by _NAME_;
100344    +          _NAME_ = upcase(_NAME_);
100345    +          %if &ncluster ne 1 %then %do;
100346    +             if last._NAME_ then delete;
100347    +          %end;
100348    +          %else %do;
100349    +             COL1 = 0;
100350    +          %end;
100351    +     run;
100352    +     /* need to sort again */
100353    +     proc sort data=_tmpclusRsq;
100354    +        by _NAME_ COL1;
100355    +     run;
100357    +     data &outdata;
100358    +         set _tmpclusRsq; by _NAME_;
100359    +         Cluster = upcase(Cluster);
100360    +         if last._NAME_ then output;
100361    +         *label  COL1 = 'R-Sqaure with Next Cluster Component';
100362    +         label COL1 = "%sysfunc(sasmsg(sashelp.dmine, rpt_varclus_label_nextrsq, noquote))" ;
100363    +         rename COL1 = RSqWithNextClusComp;
100364    +         Cluster = upcase(Cluster);
100365    +         rename Cluster = ClosestCluster;
100366    +         *label  Cluster = "Next Closest Cluster";
100367    +         label Cluster = "%sysfunc(sasmsg(sashelp.dmine, rpt_varclus_label_nextclus, noquote))" ;
100368    +         rename _NAME_ = Variable;
100369    +         label  _NAME_ = "%sysfunc(sasmsg(sashelp.dmine, rpt_varclus_label_variable, noquote))" ;
100370    +    run;
100373    +    %if &globalclusid ne %then %do;
100374    +    data &outdata;
100375    +       length GCluster $16;
100376    +       set &outdata;
100377    +       GCluster = "GC&globalclusid";
100378    +       run;
100379    +    %end;
100380    +    proc datasets lib = work nolist;
100381    +           delete _tmpclusRsq;
100382    +    run;
100383    +    quit;
100384    +%mend FindNextClosestClusByVar;
100387    +%macro FindNextClosestClusByCluster(indata=, outdata=, globalclusid=, ncluster=);
100388    +     /* The indata should be the outdata from %MakeInterClusCorrData(indata=, outdata=, ); */
100389    +     proc sort data =&indata out=_tmpclusRsq;
100390    +     by cluster;
100391    +     run;
100392    +     proc transpose data =_tmpclusRsq out=_tmpclusRsq;
100393    +     by cluster;
100394    +     run;
100395    +     proc sort data=_tmpclusRsq;
100396    +        by _NAME_ col1;
100397    +     run;
100398    +     data _tmpclusRsq;
100399    +         length _NAME_ $32;
100400    +         set _tmpclusRsq; by _NAME_;
100401    +          _NAME_ = upcase(_NAME_);
100402    +          %if &ncluster ne 1 %then %do;
100403    +             if last._NAME_ then delete;
100404    +          %end;
100405    +          %else %do;
100406    +             COL1 = 0;
100407    +          %end;
100408    +     run;
100409    +     data &outdata;
100410    +         set _tmpclusRsq; by _NAME_;
100411    +         Cluster = upcase(Cluster);
100412    +         if last._NAME_ then output;
100413    +         *label  COL1 = 'R-Sqaure with Next Cluster Component';
100414    +         label COL1 = "%sysfunc(sasmsg(sashelp.dmine, rpt_varclus_label_nextrsq, noquote))" ;
100415    +         rename COL1 = RSqWithNextClusComp;
100416    +         Cluster = upcase(Cluster);
100417    +         rename Cluster = ClosestCluster;
100418    +         *label  Cluster = "Next Closest Cluster";
100419    +         label Cluster = "%sysfunc(sasmsg(sashelp.dmine, rpt_varclus_label_nextclus, noquote))" ;
100420    +         rename _NAME_ = Variable;
100421    +         *label  _NAME_ = "Variable";
100422    +         label  _NAME_ = "%sysfunc(sasmsg(sashelp.dmine, rpt_varclus_label_variable, noquote))" ;
100424    +    run;
100425    +    %if &globalclusid ne %then %do;
100426    +    data &outdata;
100427    +       length GCluster $16;
100428    +       set &outdata;
100429    +       GCluster = "GC&globalclusid";
100430    +       run;
100431    +    %end;
100433    +    proc datasets lib = work nolist;
100434    +           delete _tmpclusRsq;
100435    +    run;
100437    +    quit;
100438    +%mend FindNextClosestClusByCluster;
100440    +%macro MakeVarClusResultTable(indata1=, indata2=, indata3=, outdata=, globalclusid=, ncluster=, selectedcomp=clustercomp);
100441    +/*----
100442    +  indata1=_ownRsq, indata2=_nextVarRsq, indata3=_nextClusRSq,
100443    +-----------*/
100445    +proc sort data =&indata1;
100446    +    by Variable;
100447    +run;
100448    +proc sort data =&indata2;
100449    +    by Variable;
100450    +run;
100451    +data &outdata;
100452    +    merge &indata1 &indata2;
100453    +    by Variable;
100454    +    length Type $16;
100455    +    Type = 'Variable';
100456    +    *label Type ='Type';
100457    +    label Type = "%sysfunc(sasmsg(sashelp.dmine, rpt_varclus_label_type, noquote))" ;
100458    +run;
100461    +data &indata3;
100462    +    set  &indata3 ;
100463    +    length RSqWithOwnClusComp 8.;
100464    +    Cluster = Variable;
100465    +    RSqWithOwnClusComp = 1;
100466    +    *label RSqWithOwnClusComp = "R-Square With Own Cluster Component";
100467    +    label RSqWithOwnClusComp = "%sysfunc(sasmsg(sashelp.dmine, rpt_varclus_label_ownrsq, noquote))" ;
100468    +    length Type $16;
100469    +    Type = 'ClusterComp';
100470    +    label Type = "%sysfunc(sasmsg(sashelp.dmine, rpt_varclus_label_type, noquote))" ;
100472    +;
100473    +run;
100475    +proc sort data=&outdata;
100476    +    by Cluster;
100477    +run;
100478    +proc sort data =&indata3;
100479    +    by Cluster;
100480    +run;
100482    +data &outdata;
100483    +     set &outdata &indata3;
100484    +     by Cluster;
100485    +run;
100488    +/* Create the Selected variable with all YES */
100490    +data &outdata;
100491    +     set &outdata;
100492    +     length RsqRatio 8.;
100493    +     length Selected $8;
100494    +     *label RSqRatio = "1-R**2 Ratio";
100495    +     label RSqRatio =  "%sysfunc(sasmsg(sashelp.dmine, rpt_varclus_label_oneminusrsq, noquote))" ;
100496    +     *label Selected = "Variable Selected";
100497    +     label Selected = "%sysfunc(sasmsg(sashelp.dmine, rpt_varclus_label_varselected, noquote))" ;
100498    +     RsqRatio = (1-RSqWithOwnClusComp)/(1-RSqWithNextClusComp);
100499    +     Selected ='YES';
100500    +     rename _LABEL_ = Label;
100501    +     label _LABEL_ =  "%sysfunc(sasmsg(sashelp.dmine, rpt_varclus_label_label, noquote))" ;
100502    +run;
100505    +/*----  Selected = Y/N will be assigened at the %score                   -------+
100506    +        Just create the Selected variable with all YES at the step above
100507    + +------------------------------------------------------------------------------+
100509    +proc sort data=&outdata;
100510    +    by Cluster RsqRatio;
100511    +run;
100513    +%if &selectedcomp eq CLUSTERCOMP %then %do;
100514    +data &outdata;
100515    +     set &outdata; by Cluster;
100516    +     length Selected $8;
100517    +     label Selected = "Variable Selected";
100518    +     if  first.Cluster then Selected ='Yes';
100519    +     else Selected = 'No';
100520    +    run;
100521    +%end;
100522    +%else %do;
100523    +data &outdata(drop = _var _varchange);
100524    +     set &outdata; retain _var 0; by Cluster;
100525    +     length Selected $8;
100526    +     label Selected = "Variable Selected";
100527    +     if first.Cluster then  _varchange = 0;
100528    +     else _varchange =1;
100529    +     if _var ne _varchange then  Selected  = 'Yes';
100530    +     else Selected = 'No';
100531    +     if last.cluster then  _var = 0;
100532    +     else _var = _varchange;
100533    +run;
100534    +%end;
100536    +--------------------------------------------------------------*/
100538    +quit;
100539    +%mend MakeVarClusResultTable;
100541    +%Macro MakePlotDataFromCorrTable(indata=, outdata=, globalclusid=);
100542    +     proc sort data =&indata;
100543    +        by cluster;
100544    +     run;
100545    +     proc transpose data =&indata
100546    +          out=&outdata(drop=_LABEL_ rename=(_NAME_ = Y Cluster=X Col1= Correlation));
100547    +          by cluster;
100548    +     run;
100549    +     data &outdata;
100550    +          set  &outdata;
100551    +          label x= "%sysfunc(sasmsg(sashelp.dmine, rpt_varclus_label_cluster, noquote))" ;
100552    +          label Y= "%sysfunc(sasmsg(sashelp.dmine, rpt_varclus_label_cluster, noquote))" ;
100553    +          label Correlation = "%sysfunc(sasmsg(sashelp.dmine, rpt_correlation_vlabel, noquote))" ;
100554    +     run;
100555    +     %if &globalclusid ne %then %do;
100556    +     data &outdata;
100557    +          Length GCluster $16;
100558    +          label GCluster = "%sysfunc(sasmsg(sashelp.dmine, rpt_varclus_label_gcluster, noquote))" ;
100559    +          set  &outdata;
100560    +          GCluster ="GC&globalclusid.";
100561    +          run;
100562    +     %end;
100564    +%Mend MakePlotDataFromCorrTable;
100567    +%macro MakeCorrelation(indata=,
100568    +                       outstat=_tmpoutstat,
100569    +                       corrmatrix=N,
100570    +                       outcorr=_tmpoutcorr,
100571    +                       includeclassvar=N,
100572    +                       target=,
100573    +                       freq=,
100574    +                       weight=);
100575    +   %if &target eq  %then %do;
100577    +       proc varclus data=&indata outstat=&outstat hi maxclusters=1 noprint;
100578    +            var %EM_INTERVAL_INPUT %EM_INTERVAL_REJECTED
100579    +       %if &includeclassvar eq Y %then %do;
100580    +          %let dsid = %sysfunc(open(&EM_USER_OUTDUMMY));
100581    +          %let nvar = %sysfunc(attrn(&dsid, NVAR));
100582    +          %do i = 2 %to &nvar;
100583    +          %let varname = %sysfunc(varname(&dsid, &i));
100584    +          &varname
100585    +          %end;
100586    +       %end;
100587    +       ;
100588    +      %if &freq ne  %then %do;
100589    +          freq &freq;
100590    +      %end;
100591    +      %if &weight ne  %then %do;
100592    +          weight &weight;
100593    +      %end;
100595    +      run;
100596    +      %if &corrmatrix eq Y %then %do;
100597    +      data  &outcorr (drop = _NCL_ _TYPE_);
100598    +           set  &outstat ;
100599    +           if _TYPE_ ='CORR' then output;
100600    +      run;
100601    +      %end;
100602    +    %end;
100603    +    %else %do;
100604    +       proc corr data=&indata outp=&outstat noprint;
100605    +            var
100606    +       %let dsid = %sysfunc(open(&indata));
100607    +       %let nvar = %sysfunc(attrn(&dsid, NVAR));
100608    +          %do i = 1 %to &nvar;
100609    +              %let _name = %sysfunc(varname(&dsid, &i));
100610    +              %if &_name ne &target %then;
100611    +              &_name
100612    +           %end;
100613    +        %let dsid= %sysfunc(close(&dsid));
100614    +        ;
100615    +        with &target;
100616    +        run;
100617    +    %end;
100618    +    quit;
100619    +%mend MakeCorrelation;
100622    +%macro MakeCorrelationDistance(indata=,
100623    +                               outdata=,
100624    +                               rsquare = N
100625    +                               );
100626    +    data corr_tmp;
100627    +        set &indata;
100628    +        if _N_ = 1 then do;
100629    +           output;
100630    +           stop;
100631    +         end;
100632    +    run;
100633    +    %if &outdata ne  %then %let  _outdata = &outdata;
100634    +    %else %let _outdata = &indata;
100636    +    data &_outdata;
100637    +         set &indata;
100639    +         %let dsid = %sysfunc(open(work.corr_tmp));
100640    +         %let nvar = %sysfunc(attrn(&dsid, NVAR));
100641    +          %do i = 2 %to &nvar;
100642    +              %let _name = %sysfunc(varname(&dsid, &i));
100643    +              %if &rsquare eq Y %then %let _name_md = &_name.**2;
100644    +              %else  %let _name_md = &_name;
100645    +              &_name = 1- &_name_md;
100646    +          %end;
100647    +      %let dsid= %sysfunc(close(&dsid));
100648    +      run;
100649    +      proc datasets lib = work nolist;
100650    +           delete corr_tmp;
100651    +      run;
100652    +      quit;
100653    +  %mend MakeCorrelationDistance;
100656    +%macro UpdateOutStatCorrToDistance(indata=, /* indata should be a outstat from proc varclus */
100657    +                                   rsquare = N
100658    +                                   );
100659    +    data corr_tmp;
100660    +        set &indata;
100661    +    run;
100662    +    proc sql noprint;
100663    +           update &indata
100664    +           set
100665    +     %let dsid = %sysfunc(open(work.corr_tmp));
100666    +     %let nvar = %sysfunc(attrn(&dsid, NVAR));
100667    +          %do i = 4 %to &nvar;
100668    +          %let _name = %sysfunc(varname(&dsid, &i));
100669    +             %if &rsquare eq Y %then %let _name_md = &_name.**2;
100670    +            %else  %let _name_md = &_name;
100671    +            %if &i < &nvar %then %do;
100672    +               &_name = 1- &_name_md ,
100673    +            %end;
100674    +            %else %do;
100675    +               &_name = &_name_md where _TYPE_ eq 'CORR' ;
100676    +            %end;
100677    +          %end;
100678    +      %let dsid= %sysfunc(close(&dsid));
100680    +      select * from &indata;
100681    +      run;
100682    +     data &indata( drop = _NCL_);
100683    +           set &indata;
100684    +           if _TYPE_ not in ('CORR', 'STD', 'N', 'MEAN') then delete;
100685    +           if _TYPE_ ='CORR' then _TYPE_ ='DISTANCE';
100686    +     run;
100687    +     data &indata(DROP = _NCL_);
100688    +           set &indata;
100689    +           if _TYPE_ = 'CORR' then _TYPE_ ='DISTANCE';
100690    +           if _TYPE_ not in ('DISTANCE', 'N', 'STD', 'MEAN') then delete;
100691    +           rename _NAME_ = _VAR_;
100692    +     run;
100693    +     proc datasets lib = work nolist;
100694    +           delete corr_tmp;
100695    +     run;
100696    +     quit;
100697    + %mend UpdateOutStatCorrToDistance;
100700    +%macro HierClusWithCorr(indata= ,
100701    +                        ncluster=,
100702    +                        method = Ward,
100703    +                        outtree = _outtree,
100704    +                        idvar =_VAR_,
100705    +                        outdata=,
100706    +                        rescore = N,
100707    +                        newncluster=
100708    +                        );
100709    +      %global &newncluster;
100710    +      %if &rescore ne Y %then %do;
100711    +      proc cluster data=&indata(type=Distance where=(upcase(strip(_TYPE_)) = "DISTANCE"))
100712    +                   method=&method outtree=&outtree noprint;
100713    +           id &idvar;
100714    +      run;
100715    +      %end;
100716    +      proc tree data=&outtree nclusters = &ncluster out=&outdata noprint;
100717    +      run;
100718    +      /* ----- Check some variables like CL1, CL5..., remove them ----*/
100719    +      proc contents data =&indata out=_outcontent(keep=NAME) noprint;
100720    +      run;
100721    +      data _outcontent;
100722    +          set _outcontent;
100723    +          if NAME in ('_TYPE_' , '_VAR_') then delete;
100724    +          index = 1;
100725    +          rename NAME = _NAME_;
100726    +      run;
100727    +      proc sort data=_outcontent;
100728    +          by _NAME_;
100729    +      run;
100730    +      proc sort data =&outdata;
100731    +           by _NAME_;
100732    +      run;
100733    +      data &outdata(drop=index);
100734    +          merge &outdata _outcontent;
100735    +          by _NAME_;
100736    +          if index = . then delete;
100737    +      run;
100738    +      /*-----------------------------------------------------------*/
100739    +      data &outdata;
100740    +           length CLUSNAME $16;
100741    +           set &outdata;
100742    +           if CLUSTER > &ncluster then delete;
100743    +           CLUSNAME='GC'||strip(CLUSTER);
100744    +           *label CLUSNAME = "Cluster Name";
100745    +           label CLUSNAME  = "%sysfunc(sasmsg(sashelp.dmine, rpt_varclus_label_clustername, noquote))" ;
100746    +           rename _NAME_ = VARIABLE ;
100747    +           *label _NAME_ = "Variable";
100748    +           *label CLUSTER = "Cluster";
100749    +           label _NAME_ ="%sysfunc(sasmsg(sashelp.dmine, rpt_varclus_label_variable, noquote))" ;
100750    +           label CLUSTER ="%sysfunc(sasmsg(sashelp.dmine, rpt_varclus_label_cluster, noquote))" ;
100751    +      run;
100752    +      proc sort data=&outdata out=&outdata;
100753    +           by CLUSTER;
100754    +      run;
100755    +      proc means data =&outdata noprint;
100756    +           output out=_meanout;
100757    +      run;
100758    +      data _null_;
100759    +            set _meanout;
100760    +            if strip(_STAT_) eq 'MAX' then do;
100761    +            call symput("&newncluster", CLUSTER);
100762    +            stop;
100763    +            end;
100764    +      run;
100766    +      proc datasets lib = work nolist;
100767    +           delete _outcontent _meanout;
100768    +      run;
100769    +      quit;
100770    +%mend  HierClusWithCorr;
100772    +%macro CreateScoreCode2(indata=, ncluscomp=, globalclusid=, fileref=);
100774    +     data _tmpindata;
100775    +          set &indata;
100776    +          if (_TYPE_ in ('SCORE' 'MEAN' 'STD') and _NCL_ = &ncluscomp ) or (_TYPE_ in ('MEAN' 'STD'));
100777    +          if _TYPE_ = 'MEAN' then _NAME_='MEAN';
100778    +          if _TYPE_ = 'STD' then _NAME_='STD';
100779    +          if _TYPE_ = 'SCORE' then _NAME_=upcase("GC&globalclusid._"||_NAME_);
100780    +          DROP _TYPE_ _NCL_;
100781    +     run;
100783    +     filename _file_  "&fileRef";
100785    +     data _null_;
100786    +        FILE _file_ MOD;
100787    +        put ' ';
100788    +        put "/*-------------------------------------------------*/";
100789    +        put '/* ' "%sysfunc(sasmsg(sashelp.dmine, rpt_varclus_score_title_gclus, noquote, &globalclusid))" '*/';
100790    +        put "/*-------------------------------------------------*/";
100791    +        put ' ';
100792    +        %let dsid = %sysfunc(open(work._tmpindata));
100794    +        %let nvar = %sysfunc(attrn(&dsid, NVAR));
100795    +        %let vn_name =%sysfunc(varnum(&dsid, _NAME_));
100796    +        %let k = 1;
100797    +        %do %while(^%sysfunc(fetch(&dsid)));
100798    +               %let _name = %sysfunc(getvarc(&dsid, &vn_name));
100799    +               %if &k > 2 %then %do;
100800    +                %let cn = %eval(&k-2);
100801    +                 put "&_name = 0 ; /*---" "%sysfunc(sasmsg(sashelp.dmine, rpt_varclus_score_gcluscompnum, noquote, &globalclusid, &cn))" "------ */";
100802    +                %end;
100803    +                %let k = %eval(&k+1);
100805    +        %end;
100806    +        %let rc = %sysfunc(rewind(&dsid));
100808    +        %do j= 2 %to &nvar;
100809    +            %let _varname = %sysfunc(varname(&dsid, &j));
100810    +            %do %while(^%sysfunc(fetch(&dsid)));
100811    +                %let _name = %sysfunc(getvarc(&dsid, &vn_name));
100812    +                %if &_name = MEAN %then
100813    +                %let _mean = %sysfunc(getvarn(&dsid, &j));
100814    +                %else %if &_name = STD %then
100815    +                %let _std = %sysfunc(getvarn(&dsid, &j));
100816    +                %else %do;
100817    +                      %let coeff =  %sysfunc(getvarn(&dsid, &j));
100818    +                      %let abscoeff = %sysfunc(abs(&coeff));
100819    +                          %if &abscoeff >  0 %then %do;
100820    +                       put "&_name = &_name+&coeff * (&_varname - &_mean)/&_std;";
100821    +                           %end;
100822    +                 %end;
100823    +             %end;
100824    +             %let rc = %sysfunc(rewind(&dsid));
100825    +         %end;
100827    +        %let dsid= %sysfunc(close(&dsid));
100829    +     run;
100831    +     filename _file_;
100832    +     proc datasets lib = work nolist;
100833    +           delete _tmpindata;
100834    +     run;
100835    +     quit;
100836    +%mend CreateScoreCode2;
100839    +%macro MakeDeltaCode2(groupds=,deltacodefile=);
100841    +     /*--- Build Code to Modify Metadata ---*/
100842    +     filename X "&deltacodefile";
100843    +     data _null_;
100844    +        FILE X;
100845    +        set &groupds end=eof;
100846    +        if _N_=1 then do;
100847    +           %if &EM_PROPERTY_INCLUDECLASSVAR eq Y %then %do;
100848    +            put "if upcase(strip(ROLE)) ='INPUT' and upcase(strip(LEVEL)) ^='INTERVAL' then ROLE ='REJECTED' ;";
100849    +           %end;
100850    +           put "if upcase(strip(ROLE))='INPUT' and upcase(strip(LEVEL))='INTERVAL' then do;";
100851    +           put "if upcase(strip(NAME)) in (";
100852    +        end;
100853    +        if Strip(upcase(Selected)) eq 'YES' then do;
100854    +           string = '"'!!trim(left(VARIABLE))!!'"';
100855    +           put string;
100856    +        end;
100857    +        if eof then do;
100858    +           put ') then ROLE="INPUT";';
100859    +           put 'else ROLE="REJECTED";';
100860    +           put 'end;';
100862    +           %if %upcase(&EM_PROPERTY_HIDEVARIABLE) eq Y %then %do;
100863    +             put 'if upcase(strip(ROLE)) = "REJECTED" then delete ;';
100864    +           %end;
100865    +        end;
100866    +     run;
100867    +     quit;
100869    +     filename X;
100870    +     quit;
100871    +%mend MakeDeltaCode2;
100873    +%macro getInitialGClusterNumber(indata=, ninput=, ndummy=0, div=100, ngc=);
100874    +  %global &ngc;
100875    +  data _null_;
100876    +  %if &indata ne %then %do;
100877    +      %let dsid = %sysfunc(open(&indata));
100878    +           %let nvar = %sysfunc(attrn(&dsid, NVAR));
100879    +      %let dsid = %sysfunc(close(&dsid));
100880    +  %end;
100881    +  %else %do;
100882    +       %let nvar = %eval(&ninput+&ndummy); ;
100883    +  %end;
100884    +  %let numgc = %eval(&nvar/&div+2);
100885    +  %let &ngc = &numgc;
100886    +   run;
100887    +  quit;
100888    +%mend getInitialGClusterNumber;
100891    +%macro MakeGobalConstellData(indata=, outlink=, outnode=);
100892    +data &outlink(drop = Selected);
100893    +     set &indata;
100894    +     LINKID = _N_;
100895    +     label LINKID = "%sysfunc(sasmsg(sashelp.dmine, rpt_varclus_label_linkid, noquote))" ;
100896    +run;
100897    +data &outnode(keep=NODEID TYPE LABEL);
100898    +    set &indata;
100899    +    length TYPE $16;
100900    +    rename VARIABLE = NODEID;
100901    +    *label  CLUSNAME="Node ID";
100902    +    label CLUSNAME= "%sysfunc(sasmsg(sashelp.dmine, rpt_varclus_label_nodeidvar, noquote))" ;
100903    +    TYPE = "VARIABLE";
100904    +    *label TYPE = "Node Type";
100905    +    label TYPE =  "%sysfunc(sasmsg(sashelp.dmine, rpt_varclus_label_nodetype, noquote))" ;
100906    +    run;
100907    +data _tmp(keep=NODEID TYPE LABEL);
100908    +    set &indata;
100909    +    length TYPE $16;
100910    +    rename CLUSNAME = NODEID;
100911    +    label  CLUSNAME= "%sysfunc(sasmsg(sashelp.dmine, rpt_varclus_label_nodeidvar, noquote))" ;
100912    +    TYPE = "GCLUSTER";
100913    +    label TYPE = "%sysfunc(sasmsg(sashelp.dmine, rpt_varclus_label_nodetype, noquote))" ;
100914    +    run;
100915    +proc sort data=_tmp;
100916    +    by NODEID;
100917    +run;
100918    +data _tmp;
100919    +    set _tmp; by NODEID;
100920    +    if first.NODEID then output;
100921    +run;
100922    +proc sort data=&outnode;
100923    +    by NODEID;
100924    +run;
100925    +data  &outnode;
100926    +    set _tmp &outnode;
100927    +run;
100928    +proc datasets lib = work nolist;
100929    +     delete _tmp;
100930    +run;
100931    +quit;
100932    +%mend MakeGobalConstellData;
100934    +/* Make contellation plot data among GCLUSTERS */
100936    +%Macro MakeGClusterConstData(indata=, inoutrsq=, outnode=, outlink=);
100938    +data &outlink(keep = _NAME_ _PARENT_ _LABEL_ LINKID);
100939    +     set &indata;
100940    +     LINKID = _N_;
100941    +     if upcase(substr(strip(_NAME_),1, 2))="CL" then do;
100942    +        _NAME_ = "ROOT"||upcase(substr(strip(_NAME_),5));
100943    +     end;
100944    +     if _PARENT_ ne " " and upcase(substr(strip(_PARENT_),1, 2))="CL" then do;
100945    +        _PARENT_ = "ROOT"||upcase(substr(strip(_PARENT_),5));
100946    +     end;
100947    +     if upcase(substr(strip(_LABEL_),1, 2))="CL" then do;
100948    +        _LABEL_ = "ROOT"||upcase(substr(strip(_LABEL_),5));
100949    +    end;
100950    +run;
100952    +data _tmp_outrsquare;
100953    +        set &inoutrsq;
100954    +        if upcase(strip(TYPE)) = 'CLUSTERCOMP' then delete;
100955    +run;
100957    +proc freq data =_tmp_outrsquare noprint;
100958    +         tables GCluster/out=_tmp_GCLUSFREQ(rename=(GCLUSTER=_NAME_));
100959    +run;
100961    +data &outnode(keep=_NAME_ TYPE LABEL);
100962    +    set &outlink;
100963    +    length TYPE $16;
100964    +    length LABEL $100;
100965    +    /*label CLUSNAME= "%sysfunc(sasmsg(sashelp.dmine, rpt_varclus_label_nodeidvar, noquote))" ;*/
100967    +    if upcase(substr(strip(_NAME_),1, 2))='GC' then do;
100968    +    TYPE = "GCLUSTER";
100969    +    LABEL = "%sysfunc(sasmsg(sashelp.dmine, rpt_varclus_label_gcluster, noquote)):"||_NAME_;
100970    +    end;
100971    +    else do;
100972    +    TYPE= "ROOT";
100973    +    LABEL= _NAME_;
100974    +    end;
100975    +    label TYPE  =  "%sysfunc(sasmsg(sashelp.dmine, rpt_varclus_label_nodetype, noquote))" ;
100976    +    label LABEL =  "%sysfunc(sasmsg(sashelp.dmine, rpt_varclus_label_label, noquote))" ;
100977    +    label _NAME_ =  "%sysfunc(sasmsg(sashelp.dmine, rpt_varclus_label_nodeidvar, noquote))" ;
100978    +    run;
100980    +proc sort data=&outnode;
100981    +     by _NAME_;
100982    +proc sort data=_tmp_GCLUSFREQ;
100983    +     by _NAME_;
100984    +run;
100986    +data  &outnode;
100987    +     merge &outnode _tmp_GCLUSFREQ; by _NAME_;
100988    +     if COUNT=. then COUNT=1;
100989    +run;
100991    +proc datasets lib = work nolist;
100992    +     delete _tmp_outrsquare _tmp_GCLUSFREQ;
100993    +run;
100995    +quit;
100996    +%Mend MakeGClusterConstData;
100999    +%macro CreateGClusterScoreCode(indata=,  globalclusid=, fileref=);
101001    +    data _gscoretmpds;
101002    +          set &indata;
101003    +          if (_TYPE_ in ('SCORE' 'MEAN' 'STD') and _NCL_ = 1 ) or (_TYPE_ in ('MEAN' 'STD'));
101004    +          if _TYPE_ = 'MEAN' then _NAME_='MEAN';
101005    +          if _TYPE_ = 'STD' then _NAME_='STD';
101006    +          if _TYPE_ = 'SCORE' then _NAME_ = "GC"||strip(&globalclusid);
101007    +          DROP _TYPE_ _NCL_;
101008    +     run;
101010    +    /*  %let gscorefile =  %bquote(&EM_NODEDIR)&EM_DSEP.gclusterscore.sas;
101011    +        GCluster Component &globalclusid ------ */
101013    +    filename _file_  "&fileref";
101015    +    data _null_;
101016    +        %if &globalclusid eq 1 %then %do;
101017    +          FILE _file_;
101018    +        %end;
101019    +        %else %do;
101020    +          FILE _file_ MOD;
101021    +        %end;
101023    +        %let dsid = %sysfunc(open(work._gscoretmpds));
101024    +        %let nvar = %sysfunc(attrn(&dsid, NVAR));
101025    +        %let vn_name =%sysfunc(varnum(&dsid, _NAME_));
101027    +        %let k = 1;
101028    +        %do %while(^%sysfunc(fetch(&dsid)));
101029    +                %let _name = %sysfunc(getvarc(&dsid, &vn_name));
101030    +                %if &k > 2 %then %do;
101031    +                put "&_name = 0 ; ";
101032    +                %end;
101033    +                %let k = %eval(&k+1);
101034    +        %end;
101036    +        %let rc = %sysfunc(rewind(&dsid));
101037    +        %do i= 2 %to &nvar;
101038    +            %let _varname =  %sysfunc(varname(&dsid, &i));
101039    +            %do %while(^%sysfunc(fetch(&dsid)));
101040    +                %let _name = %sysfunc(getvarc(&dsid, &vn_name));
101041    +                %if &_name = MEAN %then
101042    +                %let _mean = %sysfunc(getvarn(&dsid, &i));
101043    +                %else %if &_name = STD %then
101044    +                %let _std = %sysfunc(getvarn(&dsid, &i));
101045    +                %else %do;
101046    +                      %let coeff =  %sysfunc(getvarn(&dsid, &i));
101047    +                      %let abscoeff = %sysfunc(abs(&coeff));
101048    +                          %if &abscoeff >  0 %then %do;
101049    +                       put "&_name = &_name+&coeff * (&_varname - &_mean)/&_std;";
101050    +                           %end;
101051    +                 %end;
101052    +             %end;
101053    +             %let rc = %sysfunc(rewind(&dsid));
101055    +         %end;
101057    +        %let dsid= %sysfunc(close(&dsid));
101058    +       run;
101061    +       proc datasets lib=work nolist;
101062    +            delete _gscoretmpds;
101063    +       run;
101064    +      quit;
101066    +%mend CreateGClusterScoreCode;
101069    +%macro MakeGClusterCorrelation(Indata=, ngcluster=, gscorecode=, outrsquare=);
101071    +   %EM_REGISTER(KEY=GSCORE, TYPE=DATA);
101072    +   %EM_GETNAME(KEY=GSCORE, TYPE=DATA);
101073    +   %EM_REGISTER(KEY=GSCORESTAT, TYPE=DATA);
101074    +   %EM_GETNAME(KEY=GSCORESTAT, TYPE=DATA);
101075    +   %EM_REGISTER(KEY=GSCORETREE, TYPE=DATA);
101076    +   %EM_GETNAME(KEY=GSCORETREE, TYPE=DATA);
101077    +   %EM_REGISTER(KEY=GSCORECORR, TYPE=DATA);
101078    +   %EM_GETNAME(KEY=GSCORECORR, TYPE=DATA);
101079    +   %EM_REGISTER(KEY=GSCORECORRPLOT, TYPE=DATA);
101080    +   %EM_GETNAME(KEY=GSCORECORRPLOT, TYPE=DATA);
101081    +   %EM_REGISTER(KEY=GCLUSLINK, TYPE=DATA);
101082    +   %EM_GETNAME(KEY=GCLUSLINK, TYPE=DATA);
101083    +   %EM_REGISTER(KEY=GCLUSNODE, TYPE=DATA);
101084    +   %EM_GETNAME(KEY=GCLUSNODE, TYPE=DATA);
101086    +   filename gsfile "&gscorecode";
101088    +   data &EM_USER_GSCORE;
101089    +             set &indata;
101090    +             %include  gsfile;
101091    +        keep
101092    +        %do i=1 %to &ngcluster;
101093    +         %let gcvarname = GC&i;
101094    +         &gcvarname
101095    +        %end;
101096    +     ;
101097    +   run;
101099    +   proc varclus data=&EM_USER_GSCORE outstat=&EM_USER_GSCORESTAT outtree=&EM_USER_GSCORETREE
101100    +    %if %upcase(&EM_PROPERTY_CLUSCOMP) eq CENTROID %then %do; centroid %end;
101101    +    %if %upcase(&EM_PROPERTY_CLUSSOURCE) eq COV %then %do; cov %end;
101102    +    %if %upcase(&EM_PROPERTY_CLUSHIERACHY) eq Y %then %do; hi %end;
101103    +    noprint  ;
101104    +     var
101105    +       %do i=1 %to &ngcluster;
101106    +         %let gcvarname = GC&i;
101107    +         &gcvarname
101108    +        %end;
101109    +   ;
101110    +   run;
101113    +   %MakeVarClusCorrData(statds=&EM_USER_GSCORESTAT, corrds=&EM_USER_GSCORECORR, corrplotds=&EM_USER_GSCORECORRPLOT );
101114    +   data &EM_USER_GSCORECORRPLOT ;
101115    +        set &EM_USER_GSCORECORRPLOT;
101116    +        rename _X_ = X;
101117    +        rename _Y_ = Y;
101118    +        label _X_ = "%sysfunc(sasmsg(sashelp.dmine, rpt_varclus_label_gcluster, noquote))" ;
101119    +        label _Y_ = "%sysfunc(sasmsg(sashelp.dmine, rpt_varclus_label_gcluster, noquote))" ;
101120    +   run;
101122    +   %MakeGClusterConstData(indata=&EM_USER_GSCORETREE, inoutrsq=&outrsquare, outnode=&EM_USER_GCLUSNODE, outlink=&EM_USER_GCLUSLINK);
101124    +   data &EM_USER_GSCORETREE;
101125    +        length _NAME_ $32;
101126    +        length _LABEL_ $100;
101127    +        set &EM_USER_GSCORETREE(DROP=_LABEL_);
101128    +        if upcase(substr(strip(_NAME_),1, 2))='GC' then do;
101129    +         _LABEL_ = "%sysfunc(sasmsg(sashelp.dmine, rpt_varclus_label_gcluster, noquote)):"||_NAME_;
101130    +        end;else do;
101131    +         _LABEL_ = _NAME_;
101132    +        end;
101133    +       label _LABEL_ = "%sysfunc(sasmsg(sashelp.dmine, rpt_varclus_label_variable, noquote))";
101135    +   run;
101137    +   quit;
101139    +%mend MakeGClusterCorrelation;
NOTE: %INCLUDE (level 1) ending.
MPRINT(MAIN):   filename temp;
NOTE: Fileref TEMP has been deassigned.
MPRINT(SETPROPERTIES):  ;
MPRINT(SETPROPERTIES):  ;
MPRINT(SETPROPERTIES):  ;
MPRINT(SETPROPERTIES):  ;
MPRINT(SETPROPERTIES):  ;
MPRINT(SETPROPERTIES):  ;
MPRINT(SETPROPERTIES):  ;
MPRINT(SETPROPERTIES):  ;
MPRINT(SETPROPERTIES):  ;
MPRINT(SETPROPERTIES):  ;
MPRINT(SETPROPERTIES):  ;
MPRINT(SETPROPERTIES):  ;
MPRINT(SETPROPERTIES):  ;
MPRINT(MAIN):  ;
MPRINT(MAIN):   filename temp catalog 'sashelp.emexpl.variableclustering_score.source';
NOTE: %INCLUDE (level 1) file TEMP is file SASHELP.EMEXPL.VARIABLECLUSTERING_SCORE.SOURCE.
101142    +%macro score;
101144    +filename temp catalog 'sashelp.emexpl.variableclustering_score_macros.source';
101145    +%include temp;
101146    +filename temp;
101148    +%EM_GETNAME(key=VARCLUSMETA, type=DATA) ;
101150    +data _null_;
101151    +         set &EM_USER_VARCLUSMETA;
101152    +         if _N_=1 then
101153    +         call symput('_trainnum', TrainNum);
101154    +         call symput('_exportedcomp', ExportedComp);
101155    +         call symput('_hidevariable', HideVariable);
101156    +         call symput('_newTrain', NewTrain);
101157    +run;
101159    +%if &_newTrain = N %then %do;
101160    +        %if &EM_PROPERTY_EXPORTEDCOMP eq &_exportedcomp %then %let _exportedCompChanged = N;
101161    +        %else %let _exportedCompChanged = Y;
101162    +        %if &EM_PROPERTY_HIDEVARIABLE eq &_hidevariable %then %let _hideVariableChanged = N;
101163    +        %else  %let _hideVariableChanged = Y;
101164    +%end;
101165    +%else %do;
101166    +        %let _exportedCompChanged = Y;
101167    +        %let _hideVariableChanged = Y;
101168    +%end;
101170    +%if (&_trainnum = 1 ) or %upcase(&EM_PROPERTY_TWOSTAGECLUS) = NO %then %do;
101171    +     filename temp catalog 'sashelp.emexpl.variableclustering_score1.source';
101172    +     %include temp;
101173    +     filename temp;
101174    +     %score1(ExportedCompChanged=&_exportedCompChanged, HideVariableChanged=&_hideVariableChanged);
101175    +%end;
101176    +%if (&_trainnum = 2 ) or %upcase(&EM_PROPERTY_TWOSTAGECLUS) = YES %then %do;
101177    +     filename temp catalog 'sashelp.emexpl.variableclustering_score2.source';
101178    +     %include temp;
101179    +     filename temp;
101180    +     %score2(ExportedCompChanged=&_exportedCompChanged, HideVariableChanged=&_hideVariableChanged);
101181    +%end;
101183    +  /* store  current property values */
101184    + data &EM_USER_VARCLUSMETA;
101185    +       set &EM_USER_VARCLUSMETA;
101186    +        ExportedComp = "&EM_PROPERTY_EXPORTEDCOMP";
101187    +        HideVariable = "&EM_PROPERTY_HIDEVARIABLE";
101188    + run;
101190    +%mend score;
NOTE: %INCLUDE (level 1) ending.
MPRINT(MAIN):   filename temp;
NOTE: Fileref TEMP has been deassigned.
MPRINT(SCORE):   filename temp catalog 'sashelp.emexpl.variableclustering_score_macros.source';
NOTE: %INCLUDE (level 1) file TEMP is file SASHELP.EMEXPL.VARIABLECLUSTERING_SCORE_MACROS.SOURCE.
101194    +%macro ChangeVariableSelectionFlag(Indata=, gcluster=);
101195    +     proc sort data =&indata;
101196    +              by Cluster RsqRatio Type;
101197    +     run;
101198    +     /*----------------------------------------------------------------------
101199    +      The Type variabe is used becuse the variable need to be selected
101200    +        instead of Cluster component when only one variable is in the cluster
101201    +     +-----------------------------------------------------------------------*/
101203    +     %if &EM_PROPERTY_EXPORTEDCOMP eq CLUSTERCOMP %then %do;
101204    +         data &indata;
101205    +              set &indata; by cluster;
101206    +              if first.Cluster then Selected = 'YES';
101207    +              else Selected = 'NO';
101208    +         run;
101209    +         quit;
101210    +    %end;
101211    +    %else %do;
101212    +         data &indata(drop = _var _varchange);
101213    +              set &indata; retain _var 0; by Cluster;
101214    +             if first.Cluster then  _varchange = 0;
101215    +                 else _varchange =1;
101216    +             if _var ne _varchange then  Selected  = 'YES';
101217    +             else Selected = 'NO';
101218    +             if last.cluster then  _var = 0;
101219    +             else _var = _varchange;
101220    +         run;
101221    +         quit;
101222    +    %end;
101223    +%mend ChangeVariableSelectionFlag;
NOTE: %INCLUDE (level 1) ending.
MPRINT(SCORE):   filename temp;
NOTE: Fileref TEMP has been deassigned.
MPRINT(SCORE):   ;
MPRINT(SCORE):   data _null_;
MPRINT(SCORE):   set EMWS8.VarClus_VARCLUSMETA;
MPRINT(SCORE):   if _N_=1 then call symput('_trainnum', TrainNum);
MPRINT(SCORE):   call symput('_exportedcomp', ExportedComp);
MPRINT(SCORE):   call symput('_hidevariable', HideVariable);
MPRINT(SCORE):   call symput('_newTrain', NewTrain);
MPRINT(SCORE):   run;
 
NOTE: Numeric values have been converted to character values at the places given by: (Line):(Column).
      30:26
NOTE: There were 1 observations read from the data set EMWS8.VARCLUS_VARCLUSMETA.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
 
 
MPRINT(SCORE):   filename temp catalog 'sashelp.emexpl.variableclustering_score1.source';
NOTE: %INCLUDE (level 1) file TEMP is file SASHELP.EMEXPL.VARIABLECLUSTERING_SCORE1.SOURCE.
101226    +%macro score1(ExportedCompChanged=,
101227    +              HideVariableChanged=);
101229    +   %EM_GETNAME(KEY=OUTRSQUARE, TYPE=DATA);
101230    +   %if &ExportedCompChanged = Y %then %do;
101231    +   %ChangeVariableSelectionFlag(Indata=&EM_USER_OUTRSQUARE);
101232    +   %end;
101233    +   %MakeDeltaCode(groupds=&EM_USER_OUTRSQUARE, DeltaCodeFile=&EM_FILE_CDELTA_TRAIN);
101235    +%mend score1;
NOTE: %INCLUDE (level 1) ending.
MPRINT(SCORE):   filename temp;
NOTE: Fileref TEMP has been deassigned.
MPRINT(SCORE1):  ;
MPRINT(CHANGEVARIABLESELECTIONFLAG):   proc sort data =EMWS8.VarClus_OUTRSQUARE;
MPRINT(CHANGEVARIABLESELECTIONFLAG):   by Cluster RsqRatio Type;
MPRINT(CHANGEVARIABLESELECTIONFLAG):   run;
 
NOTE: There were 32 observations read from the data set EMWS8.VARCLUS_OUTRSQUARE.
NOTE: The data set EMWS8.VARCLUS_OUTRSQUARE has 32 observations and 9 variables.
NOTE: PROCEDURE SORT used (Total process time):
      real time           0.01 seconds
      cpu time            0.00 seconds
 
 
MPRINT(CHANGEVARIABLESELECTIONFLAG):   data EMWS8.VarClus_OUTRSQUARE;
MPRINT(CHANGEVARIABLESELECTIONFLAG):   set EMWS8.VarClus_OUTRSQUARE;
MPRINT(CHANGEVARIABLESELECTIONFLAG):   by cluster;
MPRINT(CHANGEVARIABLESELECTIONFLAG):   if first.Cluster then Selected = 'YES';
MPRINT(CHANGEVARIABLESELECTIONFLAG):   else Selected = 'NO';
MPRINT(CHANGEVARIABLESELECTIONFLAG):   run;
 
NOTE: There were 32 observations read from the data set EMWS8.VARCLUS_OUTRSQUARE.
NOTE: The data set EMWS8.VARCLUS_OUTRSQUARE has 32 observations and 9 variables.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
 
 
MPRINT(CHANGEVARIABLESELECTIONFLAG):   quit;
MPRINT(SCORE1):  ;
MPRINT(MAKEDELTACODE):   *--- Build Code to Modify Metadata ---*;
MPRINT(MAKEDELTACODE):   filename X "C:\\predictive-models-project\Workspaces\EMWS8\VarClus\CDELTA_TRAIN.sas";
MPRINT(MAKEDELTACODE):   data _null_;
MPRINT(MAKEDELTACODE):   FILE X;
MPRINT(MAKEDELTACODE):   set EMWS8.VarClus_OUTRSQUARE end=eof;
MPRINT(MAKEDELTACODE):   if _N_=1 then do;
MPRINT(MAKEDELTACODE):   put "if upcase(strip(ROLE))='INPUT' and upcase(strip(LEVEL))='INTERVAL' then do;";
MPRINT(MAKEDELTACODE):   put "if upcase(strip(NAME)) in (";
MPRINT(MAKEDELTACODE):   end;
MPRINT(MAKEDELTACODE):   if Strip(upcase(Selected)) eq 'YES' then do;
MPRINT(MAKEDELTACODE):   string = '"'!!trim(left(VARIABLE))!!'"';
MPRINT(MAKEDELTACODE):   put string;
MPRINT(MAKEDELTACODE):   end;
MPRINT(MAKEDELTACODE):   if eof then do;
MPRINT(MAKEDELTACODE):   put ') then ROLE="INPUT";';
MPRINT(MAKEDELTACODE):   put 'else ROLE="REJECTED";';
MPRINT(MAKEDELTACODE):   put 'end;';
MPRINT(MAKEDELTACODE):   put 'if upcase(strip(ROLE)) = "REJECTED" then delete ;';
MPRINT(MAKEDELTACODE):   end;
MPRINT(MAKEDELTACODE):   run;
 
NOTE: The file X is:
      Filename=C:\\predictive-models-project\Workspaces\EMWS8\VarClus\CDELTA_TRAIN.sas,
      RECFM=V,LRECL=256,File Size (bytes)=0,
      Last Modified=19. April 2016 17.21 Uhr,
      Create Time=03. April 2016 17.12 Uhr
 
NOTE: 14 records were written to the file X.
      The minimum record length was 4.
      The maximum record length was 75.
NOTE: There were 32 observations read from the data set EMWS8.VARCLUS_OUTRSQUARE.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
 
 
MPRINT(MAKEDELTACODE):   quit;
MPRINT(MAKEDELTACODE):   filename X;
NOTE: Fileref X has been deassigned.
MPRINT(MAKEDELTACODE):   quit;
MPRINT(SCORE1):  ;
MPRINT(SCORE):  ;
MPRINT(SCORE):   data EMWS8.VarClus_VARCLUSMETA;
MPRINT(SCORE):   set EMWS8.VarClus_VARCLUSMETA;
MPRINT(SCORE):   ExportedComp = "CLUSTERCOMP";
MPRINT(SCORE):   HideVariable = "Y";
MPRINT(SCORE):   run;
 
NOTE: There were 1 observations read from the data set EMWS8.VARCLUS_VARCLUSMETA.
NOTE: The data set EMWS8.VARCLUS_VARCLUSMETA has 1 observations and 5 variables.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
 
 
MPRINT(MAIN):  ;
MPRINT(EM_DIAGRAM):  ;
MPRINT(EM_DIAGRAM):   *------------------------------------------------------------*;
MPRINT(EM_DIAGRAM):   * End SCORE: VarClus;
MPRINT(EM_DIAGRAM):   *------------------------------------------------------------*;
101237
101238     *------------------------------------------------------------*;
101239     * End SCORE: VarClus;
101240     *------------------------------------------------------------*;
 
101241     filename emflow "C:\\predictive-models-project\Workspaces\EMWS8\VarClus\EMFLOWSCORE.sas";
MPRINT(EM_DIAGRAM):    filename emflow "C:\\predictive-models-project\Workspaces\EMWS8\VarClus\EMFLOWSCORE.sas";
MPRINT(EM_DIAGRAM):   *------------------------------------------------------------*;
MPRINT(EM_DIAGRAM):   * VarClus: Scoring DATA data;
MPRINT(EM_DIAGRAM):   *------------------------------------------------------------*;
101242     *------------------------------------------------------------*;
101243     * VarClus: Scoring DATA data;
101244     *------------------------------------------------------------*;
101245     data EMWS8.VarClus_TRAIN
101246     / view=EMWS8.VarClus_TRAIN
101247     ;
MPRINT(EM_DIAGRAM):   data EMWS8.VarClus_TRAIN / view=EMWS8.VarClus_TRAIN ;
101248     set EMWS8.Part_TRAIN
101249     ;
MPRINT(EM_DIAGRAM):   set EMWS8.Part_TRAIN ;
101250     %inc emflow;
NOTE: %INCLUDE (level 1) file EMFLOW is file C:\\predictive-models-project\Workspaces\EMWS8\VarClus\EMFLOWSCORE.sas.
101251    +
101252    +/*-------------------------------------------------*/
101253    +/* Varclus Score Code Begins*/
101254    +/*-------------------------------------------------*/
101255    +
101256    +Clus1 = 0 ; /*---Cluster Component 1------ */
MPRINT(EM_DIAGRAM):   Clus1 = 0 ;
101257    +Clus2 = 0 ; /*---Cluster Component 2------ */
MPRINT(EM_DIAGRAM):   Clus2 = 0 ;
101258    +Clus3 = 0 ; /*---Cluster Component 3------ */
MPRINT(EM_DIAGRAM):   Clus3 = 0 ;
101259    +Clus4 = 0 ; /*---Cluster Component 4------ */
MPRINT(EM_DIAGRAM):   Clus4 = 0 ;
101260    +Clus5 = 0 ; /*---Cluster Component 5------ */
MPRINT(EM_DIAGRAM):   Clus5 = 0 ;
101261    +Clus6 = 0 ; /*---Cluster Component 6------ */
MPRINT(EM_DIAGRAM):   Clus6 = 0 ;
101262    +Clus7 = 0 ; /*---Cluster Component 7------ */
MPRINT(EM_DIAGRAM):   Clus7 = 0 ;
101263    +Clus8 = 0 ; /*---Cluster Component 8------ */
MPRINT(EM_DIAGRAM):   Clus8 = 0 ;
101264    +Clus8 = Clus8+1 * (AcceptedCmpTotal - 0.31255265374894)/0.66837726102124;
MPRINT(EM_DIAGRAM):   Clus8 = Clus8+1 * (AcceptedCmpTotal - 0.31255265374894)/0.66837726102124;
101265    +Clus2 = Clus2+0.5 * (Age - 47.2059814658803)/12.0632948493559;
MPRINT(EM_DIAGRAM):   Clus2 = Clus2+0.5 * (Age - 47.2059814658803)/12.0632948493559;
101266    +Clus4 = Clus4+0.19973986384379 * (Frq - 12.6545914069081)/7.1598086029145;
MPRINT(EM_DIAGRAM):   Clus4 = Clus4+0.19973986384379 * (Frq - 12.6545914069081)/7.1598086029145;
101267    +Clus1 = Clus1+0.15242317288807 * (Income - 51962.545914069)/20878.2658128313;
MPRINT(EM_DIAGRAM):   Clus1 = Clus1+0.15242317288807 * (Income - 51962.545914069)/20878.2658128313;
101268    +Clus1 = Clus1+-0.11326525887946 * (Kidhome - 0.43555181128896)/0.53438033047728;
MPRINT(EM_DIAGRAM):   Clus1 = Clus1+-0.11326525887946 * (Kidhome - 0.43555181128896)/0.53438033047728;
101269    +Clus1 = Clus1+0.16405768583044 * (Mnt - 615.68197135636)/604.537497355942;
MPRINT(EM_DIAGRAM):   Clus1 = Clus1+0.16405768583044 * (Mnt - 615.68197135636)/604.537497355942;
101270    +Clus1 = Clus1+0.12820704015091 * (MntFishProducts - 36.4945240101095)/52.2208809602509;
MPRINT(EM_DIAGRAM):   Clus1 = Clus1+0.12820704015091 * (MntFishProducts - 36.4945240101095)/52.2208809602509;
101271    +Clus1 = Clus1+0.13003723528825 * (MntFruits - 27.153748946925)/39.7289323595324;
MPRINT(EM_DIAGRAM):   Clus1 = Clus1+0.13003723528825 * (MntFruits - 27.153748946925)/39.7289323595324;
101272    +Clus4 = Clus4+0.12026967394981 * (MntGoldProds - 44.0589721988205)/51.1646481009475;
MPRINT(EM_DIAGRAM):   Clus4 = Clus4+0.12026967394981 * (MntGoldProds - 44.0589721988205)/51.1646481009475;
101273    +Clus1 = Clus1+0.15378172897501 * (MntMeatProducts - 169.965037910699)/216.176716057929;
MPRINT(EM_DIAGRAM):   Clus1 = Clus1+0.15378172897501 * (MntMeatProducts - 169.965037910699)/216.176716057929;
101274    +Clus1 = Clus1+0.12839407773078 * (MntSweetProducts - 27.0804549283909)/39.2356363442449;
MPRINT(EM_DIAGRAM):   Clus1 = Clus1+0.12839407773078 * (MntSweetProducts - 27.0804549283909)/39.2356363442449;
101275    +Clus4 = Clus4+0.16875412248328 * (MntWines - 310.929233361415)/341.695699656276;
MPRINT(EM_DIAGRAM):   Clus4 = Clus4+0.16875412248328 * (MntWines - 310.929233361415)/341.695699656276;
101276    +Clus3 = Clus3+1 * (MonthsAsCustomer - 83.4953664700926)/16.9441392661404;
MPRINT(EM_DIAGRAM):   Clus3 = Clus3+1 * (MonthsAsCustomer - 83.4953664700926)/16.9441392661404;
101277    +Clus4 = Clus4+0.17191033798819 * (NumCatalogPurchases - 2.64448188711036)/2.77214051734809;
MPRINT(EM_DIAGRAM):   Clus4 = Clus4+0.17191033798819 * (NumCatalogPurchases - 2.64448188711036)/2.77214051734809;
101278    +Clus5 = Clus5+0.59365846567538 * (NumDealsPurchases - 2.25526537489469)/1.67318269219337;
MPRINT(EM_DIAGRAM):   Clus5 = Clus5+0.59365846567538 * (NumDealsPurchases - 2.25526537489469)/1.67318269219337;
101279    +Clus4 = Clus4+0.19568478317119 * (NumDistPurchases - 6.73504633529907)/4.60209117827878;
MPRINT(EM_DIAGRAM):   Clus4 = Clus4+0.19568478317119 * (NumDistPurchases - 6.73504633529907)/4.60209117827878;
101280    +Clus4 = Clus4+0.16265391840825 * (NumStorePurchases - 5.91954507160909)/3.25562388118508;
MPRINT(EM_DIAGRAM):   Clus4 = Clus4+0.16265391840825 * (NumStorePurchases - 5.91954507160909)/3.25562388118508;
101281    +Clus4 = Clus4+0.16220922357079 * (NumWebPurchases - 4.09056444818871)/2.61390561975288;
MPRINT(EM_DIAGRAM):   Clus4 = Clus4+0.16220922357079 * (NumWebPurchases - 4.09056444818871)/2.61390561975288;
101282    +Clus1 = Clus1+-0.12106102877754 * (NumWebVisitsMonth - 5.24220724515585)/2.33225525940929;
MPRINT(EM_DIAGRAM):   Clus1 = Clus1+-0.12106102877754 * (NumWebVisitsMonth - 5.24220724515585)/2.33225525940929;
101283    +Clus7 = Clus7+1 * (RFMstat - 531.396946202506)/1565.49314871989;
MPRINT(EM_DIAGRAM):   Clus7 = Clus7+1 * (RFMstat - 531.396946202506)/1565.49314871989;
101284    +Clus1 = Clus1+0.15685430945271 * (RMntFrq - 37.80392418146)/30.0642993170191;
MPRINT(EM_DIAGRAM):   Clus1 = Clus1+0.15685430945271 * (RMntFrq - 37.80392418146)/30.0642993170191;
101285    +Clus6 = Clus6+1 * (Recency - 48.7742207245156)/28.8224799181808;
MPRINT(EM_DIAGRAM):   Clus6 = Clus6+1 * (Recency - 48.7742207245156)/28.8224799181808;
101286    +Clus5 = Clus5+0.59365846567538 * (Teenhome - 0.48652064026958)/0.55047336656954;
MPRINT(EM_DIAGRAM):   Clus5 = Clus5+0.59365846567538 * (Teenhome - 0.48652064026958)/0.55047336656954;
101287    +Clus2 = Clus2+-0.5 * (Year_Birth - 1968.79401853412)/12.0632948493559;
MPRINT(EM_DIAGRAM):   Clus2 = Clus2+-0.5 * (Year_Birth - 1968.79401853412)/12.0632948493559;
NOTE: %INCLUDE (level 1) ending.
MPRINT(EM_DIAGRAM):   run;
101288     run;
 
NOTE: DATA STEP view saved on file EMWS8.VARCLUS_TRAIN.
NOTE: A stored DATA STEP view cannot run under a different operating system.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
 
 
MPRINT(EM_DIAGRAM):   quit;
101289     quit;
101290     filename emflow;
MPRINT(EM_DIAGRAM):   filename emflow;
NOTE: Fileref EMFLOW has been deassigned.
101291     filename emflow "C:\\predictive-models-project\Workspaces\EMWS8\VarClus\EMFLOWSCORE.sas";
MPRINT(EM_DIAGRAM):    filename emflow "C:\\predictive-models-project\Workspaces\EMWS8\VarClus\EMFLOWSCORE.sas";
MPRINT(EM_DIAGRAM):   *------------------------------------------------------------*;
MPRINT(EM_DIAGRAM):   * VarClus: Scoring VALIDATE data;
MPRINT(EM_DIAGRAM):   *------------------------------------------------------------*;
101292     *------------------------------------------------------------*;
101293     * VarClus: Scoring VALIDATE data;
101294     *------------------------------------------------------------*;
101295     data EMWS8.VarClus_VALIDATE
101296     / view=EMWS8.VarClus_VALIDATE
101297     ;
MPRINT(EM_DIAGRAM):   data EMWS8.VarClus_VALIDATE / view=EMWS8.VarClus_VALIDATE ;
101298     set EMWS8.Part_VALIDATE
101299     ;
MPRINT(EM_DIAGRAM):   set EMWS8.Part_VALIDATE ;
101300     %inc emflow;
NOTE: %INCLUDE (level 1) file EMFLOW is file C:\\predictive-models-project\Workspaces\EMWS8\VarClus\EMFLOWSCORE.sas.
101301    +
101302    +/*-------------------------------------------------*/
101303    +/* Varclus Score Code Begins*/
101304    +/*-------------------------------------------------*/
101305    +
101306    +Clus1 = 0 ; /*---Cluster Component 1------ */
MPRINT(EM_DIAGRAM):   Clus1 = 0 ;
101307    +Clus2 = 0 ; /*---Cluster Component 2------ */
MPRINT(EM_DIAGRAM):   Clus2 = 0 ;
101308    +Clus3 = 0 ; /*---Cluster Component 3------ */
MPRINT(EM_DIAGRAM):   Clus3 = 0 ;
101309    +Clus4 = 0 ; /*---Cluster Component 4------ */
MPRINT(EM_DIAGRAM):   Clus4 = 0 ;
101310    +Clus5 = 0 ; /*---Cluster Component 5------ */
MPRINT(EM_DIAGRAM):   Clus5 = 0 ;
101311    +Clus6 = 0 ; /*---Cluster Component 6------ */
MPRINT(EM_DIAGRAM):   Clus6 = 0 ;
101312    +Clus7 = 0 ; /*---Cluster Component 7------ */
MPRINT(EM_DIAGRAM):   Clus7 = 0 ;
101313    +Clus8 = 0 ; /*---Cluster Component 8------ */
MPRINT(EM_DIAGRAM):   Clus8 = 0 ;
101314    +Clus8 = Clus8+1 * (AcceptedCmpTotal - 0.31255265374894)/0.66837726102124;
MPRINT(EM_DIAGRAM):   Clus8 = Clus8+1 * (AcceptedCmpTotal - 0.31255265374894)/0.66837726102124;
101315    +Clus2 = Clus2+0.5 * (Age - 47.2059814658803)/12.0632948493559;
MPRINT(EM_DIAGRAM):   Clus2 = Clus2+0.5 * (Age - 47.2059814658803)/12.0632948493559;
101316    +Clus4 = Clus4+0.19973986384379 * (Frq - 12.6545914069081)/7.1598086029145;
MPRINT(EM_DIAGRAM):   Clus4 = Clus4+0.19973986384379 * (Frq - 12.6545914069081)/7.1598086029145;
101317    +Clus1 = Clus1+0.15242317288807 * (Income - 51962.545914069)/20878.2658128313;
MPRINT(EM_DIAGRAM):   Clus1 = Clus1+0.15242317288807 * (Income - 51962.545914069)/20878.2658128313;
101318    +Clus1 = Clus1+-0.11326525887946 * (Kidhome - 0.43555181128896)/0.53438033047728;
MPRINT(EM_DIAGRAM):   Clus1 = Clus1+-0.11326525887946 * (Kidhome - 0.43555181128896)/0.53438033047728;
101319    +Clus1 = Clus1+0.16405768583044 * (Mnt - 615.68197135636)/604.537497355942;
MPRINT(EM_DIAGRAM):   Clus1 = Clus1+0.16405768583044 * (Mnt - 615.68197135636)/604.537497355942;
101320    +Clus1 = Clus1+0.12820704015091 * (MntFishProducts - 36.4945240101095)/52.2208809602509;
MPRINT(EM_DIAGRAM):   Clus1 = Clus1+0.12820704015091 * (MntFishProducts - 36.4945240101095)/52.2208809602509;
101321    +Clus1 = Clus1+0.13003723528825 * (MntFruits - 27.153748946925)/39.7289323595324;
MPRINT(EM_DIAGRAM):   Clus1 = Clus1+0.13003723528825 * (MntFruits - 27.153748946925)/39.7289323595324;
101322    +Clus4 = Clus4+0.12026967394981 * (MntGoldProds - 44.0589721988205)/51.1646481009475;
MPRINT(EM_DIAGRAM):   Clus4 = Clus4+0.12026967394981 * (MntGoldProds - 44.0589721988205)/51.1646481009475;
101323    +Clus1 = Clus1+0.15378172897501 * (MntMeatProducts - 169.965037910699)/216.176716057929;
MPRINT(EM_DIAGRAM):   Clus1 = Clus1+0.15378172897501 * (MntMeatProducts - 169.965037910699)/216.176716057929;
101324    +Clus1 = Clus1+0.12839407773078 * (MntSweetProducts - 27.0804549283909)/39.2356363442449;
MPRINT(EM_DIAGRAM):   Clus1 = Clus1+0.12839407773078 * (MntSweetProducts - 27.0804549283909)/39.2356363442449;
101325    +Clus4 = Clus4+0.16875412248328 * (MntWines - 310.929233361415)/341.695699656276;
MPRINT(EM_DIAGRAM):   Clus4 = Clus4+0.16875412248328 * (MntWines - 310.929233361415)/341.695699656276;
101326    +Clus3 = Clus3+1 * (MonthsAsCustomer - 83.4953664700926)/16.9441392661404;
MPRINT(EM_DIAGRAM):   Clus3 = Clus3+1 * (MonthsAsCustomer - 83.4953664700926)/16.9441392661404;
101327    +Clus4 = Clus4+0.17191033798819 * (NumCatalogPurchases - 2.64448188711036)/2.77214051734809;
MPRINT(EM_DIAGRAM):   Clus4 = Clus4+0.17191033798819 * (NumCatalogPurchases - 2.64448188711036)/2.77214051734809;
101328    +Clus5 = Clus5+0.59365846567538 * (NumDealsPurchases - 2.25526537489469)/1.67318269219337;
MPRINT(EM_DIAGRAM):   Clus5 = Clus5+0.59365846567538 * (NumDealsPurchases - 2.25526537489469)/1.67318269219337;
101329    +Clus4 = Clus4+0.19568478317119 * (NumDistPurchases - 6.73504633529907)/4.60209117827878;
MPRINT(EM_DIAGRAM):   Clus4 = Clus4+0.19568478317119 * (NumDistPurchases - 6.73504633529907)/4.60209117827878;
101330    +Clus4 = Clus4+0.16265391840825 * (NumStorePurchases - 5.91954507160909)/3.25562388118508;
MPRINT(EM_DIAGRAM):   Clus4 = Clus4+0.16265391840825 * (NumStorePurchases - 5.91954507160909)/3.25562388118508;
101331    +Clus4 = Clus4+0.16220922357079 * (NumWebPurchases - 4.09056444818871)/2.61390561975288;
MPRINT(EM_DIAGRAM):   Clus4 = Clus4+0.16220922357079 * (NumWebPurchases - 4.09056444818871)/2.61390561975288;
101332    +Clus1 = Clus1+-0.12106102877754 * (NumWebVisitsMonth - 5.24220724515585)/2.33225525940929;
MPRINT(EM_DIAGRAM):   Clus1 = Clus1+-0.12106102877754 * (NumWebVisitsMonth - 5.24220724515585)/2.33225525940929;
101333    +Clus7 = Clus7+1 * (RFMstat - 531.396946202506)/1565.49314871989;
MPRINT(EM_DIAGRAM):   Clus7 = Clus7+1 * (RFMstat - 531.396946202506)/1565.49314871989;
101334    +Clus1 = Clus1+0.15685430945271 * (RMntFrq - 37.80392418146)/30.0642993170191;
MPRINT(EM_DIAGRAM):   Clus1 = Clus1+0.15685430945271 * (RMntFrq - 37.80392418146)/30.0642993170191;
101335    +Clus6 = Clus6+1 * (Recency - 48.7742207245156)/28.8224799181808;
MPRINT(EM_DIAGRAM):   Clus6 = Clus6+1 * (Recency - 48.7742207245156)/28.8224799181808;
101336    +Clus5 = Clus5+0.59365846567538 * (Teenhome - 0.48652064026958)/0.55047336656954;
MPRINT(EM_DIAGRAM):   Clus5 = Clus5+0.59365846567538 * (Teenhome - 0.48652064026958)/0.55047336656954;
101337    +Clus2 = Clus2+-0.5 * (Year_Birth - 1968.79401853412)/12.0632948493559;
MPRINT(EM_DIAGRAM):   Clus2 = Clus2+-0.5 * (Year_Birth - 1968.79401853412)/12.0632948493559;
NOTE: %INCLUDE (level 1) ending.
MPRINT(EM_DIAGRAM):   run;
101338     run;
 
NOTE: DATA STEP view saved on file EMWS8.VARCLUS_VALIDATE.
NOTE: A stored DATA STEP view cannot run under a different operating system.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
 
 
MPRINT(EM_DIAGRAM):   quit;
101339     quit;
101340     filename emflow;
MPRINT(EM_DIAGRAM):   filename emflow;
NOTE: Fileref EMFLOW has been deassigned.
101342     *------------------------------------------------------------*;
MPRINT(EM_DIAGRAM):     *------------------------------------------------------------*;
101343     * VarClus: Computing metadata for TRAIN data;
MPRINT(EM_DIAGRAM):   * VarClus: Computing metadata for TRAIN data;
101344     *------------------------------------------------------------*;
MPRINT(EM_DIAGRAM):   *------------------------------------------------------------*;
 
NOTE: View EMWS8.VARCLUS_TRAIN.VIEW used (Total process time):
      real time           0.01 seconds
      cpu time            0.01 seconds
 
MPRINT(EM_DIAGRAM):    *------------------------------------------------------------*;
MPRINT(EM_DIAGRAM):   * &nodeid: Computing Metadata for TRAIN data;
MPRINT(EM_DIAGRAM):   *------------------------------------------------------------*;
MPRINT(EM_DIAGRAM):   filename _delta "C:\\predictive-models-project\Workspaces\EMWS8\VarClus\CDELTA_TRAIN.sas";
MPRINT(EMADVISECOLUMNS):   proc display c=sashelp.emmeta.advisecolumns.scl;
MPRINT(EMADVISECOLUMNS):   run;
MPRINT(EMADVISECOLUMNS):    options validvarname=any;
MPRINT(EMADVISECOLUMNS):   proc contents data=EMWS8.VarClus_TRAIN out=_tempAdvisor noprint;
MPRINT(EMADVISECOLUMNS):   run;
MPRINT(EMADVISECOLUMNS):   options validvarname=V7;
MPRINT(EMADVISECOLUMNS):    data _null_;
MPRINT(EMADVISECOLUMNS):   dsid = open('EMWS8.VarClus_TRAIN');
MPRINT(EMADVISECOLUMNS):   call symput('_dsidTable', strip(put(dsid, best.)));
MPRINT(EMADVISECOLUMNS):   if dsid then do;
MPRINT(EMADVISECOLUMNS):   call symput('_engineTable', attrc(dsid, 'ENGINE'));
MPRINT(EMADVISECOLUMNS):   dsid = close(dsid);
MPRINT(EMADVISECOLUMNS):   end;
MPRINT(EMADVISECOLUMNS):   run;
MPRINT(EMADVISECOLUMNS):    proc contents data=EMWS8.VarClus_TRAIN out=WORK.M00_LA62 noprint;
MPRINT(EMADVISECOLUMNS):   run;
MPRINT(EMADVISECOLUMNS):    data WORK.M00_LA62;
MPRINT(EMADVISECOLUMNS):   length NAME $ 64 TYPE $ 1 LABEL $ 200 FORMAT $ 20 INFORMAT $20 INDEX $ 1 INDEXTYPE $ 9;
MPRINT(EMADVISECOLUMNS):   label NAME =;
MPRINT(EMADVISECOLUMNS):   set WORK.M00_LA62(keep=name type length label format formatl formatd informat informl informd idxusage rename=(type=itype));
MPRINT(EMADVISECOLUMNS):   if itype = 1 then type = 'N';
MPRINT(EMADVISECOLUMNS):   else type = 'C';
MPRINT(EMADVISECOLUMNS):   if formatl > 0 then do;
MPRINT(EMADVISECOLUMNS):   if format ne ' ' then format = strip(format)!!strip(put(formatl, best12.))!!'.'!!strip(put(formatd, best12.));
MPRINT(EMADVISECOLUMNS):   else format = strip(put(formatl, best12.))!!'.'!!strip(put(formatd, best12.));
MPRINT(EMADVISECOLUMNS):   end;
MPRINT(EMADVISECOLUMNS):   else if format ne '' then format = strip(format)!!'.';
MPRINT(EMADVISECOLUMNS):   if informl > 0 then do;
MPRINT(EMADVISECOLUMNS):   if informat ne ' ' then informat = strip(informat)!!strip(put(informl, best12.))!!'.'!!strip(put(informd, best12.));
MPRINT(EMADVISECOLUMNS):   else informat = strip(put(informl, best12.))!!'.'!!strip(put(informd, best12.));
MPRINT(EMADVISECOLUMNS):   end;
MPRINT(EMADVISECOLUMNS):   else if informat ne '' then informat = strip(informat)!!'.';
MPRINT(EMADVISECOLUMNS):   if idxusage = 'NONE' then index ="N";
MPRINT(EMADVISECOLUMNS):   else index = "Y";
MPRINT(EMADVISECOLUMNS):   indextype = idxusage;
MPRINT(EMADVISECOLUMNS):   drop idxusage itype formatl formatd informl informd;
MPRINT(EMADVISECOLUMNS):   run;
MPRINT(EMADVISECOLUMNS):    data WORK.M00_LA62;
MPRINT(EMADVISECOLUMNS):   length UNAME $64;
MPRINT(EMADVISECOLUMNS):   set WORK.M00_LA62;
MPRINT(EMADVISECOLUMNS):   UNAME = upcase(NAME);
MPRINT(EMADVISECOLUMNS):   run;
MPRINT(EMADVISECOLUMNS):    proc sort data=WORK.M32CMMS8 NOTHREADS;
MPRINT(EMADVISECOLUMNS):   by UNAME;
MPRINT(EMADVISECOLUMNS):   run;
MPRINT(EMADVISECOLUMNS):    data WORK.M32CMMS8;
MPRINT(EMADVISECOLUMNS):   drop UNAME;
MPRINT(EMADVISECOLUMNS):   set WORK.M32CMMS8;
MPRINT(EMADVISECOLUMNS):   run;
MPRINT(EMADVISECOLUMNS):    data WORK.M2RUAIKO(keep=NAME ATTR);
MPRINT(EMADVISECOLUMNS):   length ATTR $ 20;
MPRINT(EMADVISECOLUMNS):   set WORK.M32CMMS8;
MPRINT(EMADVISECOLUMNS):   if level ne "INTERVAL" then do;
MPRINT(EMADVISECOLUMNS):   if order = ' ' then do;
MPRINT(EMADVISECOLUMNS):   attr = 'ORDER';
MPRINT(EMADVISECOLUMNS):   output;
MPRINT(EMADVISECOLUMNS):   end;
MPRINT(EMADVISECOLUMNS):   end;
MPRINT(EMADVISECOLUMNS):   if format ne ' ' and formattype = ' ' then do;
MPRINT(EMADVISECOLUMNS):   attr = 'FORMATTYPE';
MPRINT(EMADVISECOLUMNS):   output;
MPRINT(EMADVISECOLUMNS):   end;
MPRINT(EMADVISECOLUMNS):   if role = ' ' then do;
MPRINT(EMADVISECOLUMNS):   attr = 'ROLE';
MPRINT(EMADVISECOLUMNS):   output;
MPRINT(EMADVISECOLUMNS):   end;
MPRINT(EMADVISECOLUMNS):   if level = ' ' then do;
MPRINT(EMADVISECOLUMNS):   attr = 'LEVEL';
MPRINT(EMADVISECOLUMNS):   output;
MPRINT(EMADVISECOLUMNS):   end;
MPRINT(EMADVISECOLUMNS):   if type = ' ' then do;
MPRINT(EMADVISECOLUMNS):   attr = 'TYPE';
MPRINT(EMADVISECOLUMNS):   output;
MPRINT(EMADVISECOLUMNS):   end;
MPRINT(EMADVISECOLUMNS):   if index = ' ' then do;
MPRINT(EMADVISECOLUMNS):   attr = 'INDEX';
MPRINT(EMADVISECOLUMNS):   output;
MPRINT(EMADVISECOLUMNS):   end;
MPRINT(EMADVISECOLUMNS):   if report = ' ' then do;
MPRINT(EMADVISECOLUMNS):   attr = 'REPORT';
MPRINT(EMADVISECOLUMNS):   output;
MPRINT(EMADVISECOLUMNS):   end;
MPRINT(EMADVISECOLUMNS):   run;
MPRINT(EMADVISECOLUMNS):   proc sort NOTHREADS;
MPRINT(EMADVISECOLUMNS):   by attr;
MPRINT(EMADVISECOLUMNS):   run;
MPRINT(EMADVISECOLUMNS):    data WORK.M32CMMS8;
MPRINT(EMADVISECOLUMNS):   length NAME $64 ROLE $ 32 LEVEL $ 10 ORDER $ 8 CREATOR $32 FORMATTYPE $ 10 FAMILY $ 10 LOWERLIMIT 8 UPPERLIMIT 8 REPORT $1 DISTRIBUTION $ 20 COMMENT $64;
MPRINT(EMADVISECOLUMNS):   length levelAssigned 8 roleAssigned 8 PRICE 8;
MPRINT(EMADVISECOLUMNS):   set WORK.M32CMMS8;
MPRINT(EMADVISECOLUMNS):   if formattype = ' ' then do;
MPRINT(EMADVISECOLUMNS):   if format ne ' ' then do;
MPRINT(EMADVISECOLUMNS):   if type = 'N' then do;
MPRINT(EMADVISECOLUMNS):   pos = indexc(format,'.1234567890');
MPRINT(EMADVISECOLUMNS):   if pos > 1 then tempfmt = substr(format,1, pos-1);
MPRINT(EMADVISECOLUMNS):   else tempfmt = ' ';
MPRINT(EMADVISECOLUMNS):   flen = length(tempfmt);
MPRINT(EMADVISECOLUMNS):   select;
MPRINT(EMADVISECOLUMNS):   when(tempfmt in ("DATE" "DAY" "DDMMYY" "DOWNAME" "JULDAY" "JULIAN" "MMDDYY" "MMDDYYD" "MMDDYYC" "MMDDYYN" "MMDDYYP" "MMDDYYS" "MONNAME" "MONTH" "MONYY" "NENGO" "QTR" "QTRR" "WEEKDATE" "WEEKDATX" "WEEKDAY" "WORDDATE" "WORDDATX"
"YEAR" "YYMMDD" "YYMON" "YYMMDDC" "YYMMDDD" "YYMMDDN" "YYMMDDP" "YYMMDDS" "EURDFDE" "NJDATE" "NLDATE" "EURDFDD" "EURDFDWN" "EURDFMN" "EURDFMY" "EURDFWK" "EURDFWKX" "EURDFWDX" "EURDFDN" "EURDFDE" )) formattype = 'DATE';
MPRINT(EMADVISECOLUMNS):   when(tempfmt in ("DATETIME" "EURDFDT" "TOD" )) formattype = "DATETIME";
MPRINT(EMADVISECOLUMNS):   when(tempfmt in ("HHMM" "HOUR" "MMSS" "TIME" "TIMEAMPM" )) formattype = "TIME";
MPRINT(EMADVISECOLUMNS):   when(tempfmt in ("COMMA" "COMMAX" "DOLLAR" "DOLLARX" "E" "FRACT" "NEGPAREN" "PERCENT")) formattype="QUANTITY";
MPRINT(EMADVISECOLUMNS):   when(tempfmt in ("BINARY" "HEX" "IB" "OCTAL" "PD" "PIB" "PK" "RB" "SSN" "Z" "ZD")) formattype = "CODING";
MPRINT(EMADVISECOLUMNS):   otherwise do;
MPRINT(EMADVISECOLUMNS):   formattype = "USER";
MPRINT(EMADVISECOLUMNS):   if substr(tempfmt, 1, 6)='NLDATE' then formattype = "DATE";
MPRINT(EMADVISECOLUMNS):   else if substr(tempfmt, 1, 6)='NLDATM' then formattype = "DATETIME";
MPRINT(EMADVISECOLUMNS):   else if substr(tempfmt, 1, 4)='NLTIM' then formattype = "TIME";
MPRINT(EMADVISECOLUMNS):   else if flen >= 4 then do;
MPRINT(EMADVISECOLUMNS):   str = substr(tempfmt,1,4);
MPRINT(EMADVISECOLUMNS):   if str in ("MMYY" "YYMM" "YYQR") then formattype ="DATE";
MPRINT(EMADVISECOLUMNS):   else if str = "S370" then formattype = "CODING";
MPRINT(EMADVISECOLUMNS):   else if str = "BEST" then formattype = "NUM";
MPRINT(EMADVISECOLUMNS):   drop str;
MPRINT(EMADVISECOLUMNS):   end;
MPRINT(EMADVISECOLUMNS):   else if flen >=3 and substr(tempfmt,1,3) = "YYQ" then formatType = "DATE";
MPRINT(EMADVISECOLUMNS):   end;
MPRINT(EMADVISECOLUMNS):   end;
MPRINT(EMADVISECOLUMNS):   drop flen tempfmt pos;
MPRINT(EMADVISECOLUMNS):   end;
MPRINT(EMADVISECOLUMNS):   else do;
MPRINT(EMADVISECOLUMNS):   formatType = "CATEGORY";
MPRINT(EMADVISECOLUMNS):   end;
MPRINT(EMADVISECOLUMNS):   end;
MPRINT(EMADVISECOLUMNS):   if formatType = "NUM" then do;
MPRINT(EMADVISECOLUMNS):   if index = "Y" then formatType = "DISCRETE";
MPRINT(EMADVISECOLUMNS):   else formatType = "QUANTITY";
MPRINT(EMADVISECOLUMNS):   end;
MPRINT(EMADVISECOLUMNS):   end;
MPRINT(EMADVISECOLUMNS):   if level = ' ' then do;
MPRINT(EMADVISECOLUMNS):   if formatType in ("CATEGORY", "CODING", "ID") or type = "C" then level = "NOMINAL";
MPRINT(EMADVISECOLUMNS):   else level = "INTERVAL";
MPRINT(EMADVISECOLUMNS):   levelAssigned = 1;
MPRINT(EMADVISECOLUMNS):   end;
MPRINT(EMADVISECOLUMNS):   else level = upcase(level);
MPRINT(EMADVISECOLUMNS):   if role = ' ' then do;
MPRINT(EMADVISECOLUMNS):   length name_prefix $8 _uname $64;
MPRINT(EMADVISECOLUMNS):   drop name_prefix _uname _freqflag;
MPRINT(EMADVISECOLUMNS):   retain _freqflag;
MPRINT(EMADVISECOLUMNS):   if LENGTH> 80 then ROLE = 'TEXT';
MPRINT(EMADVISECOLUMNS):   _uname = upcase(NAME);
MPRINT(EMADVISECOLUMNS):   select(_uname);
MPRINT(EMADVISECOLUMNS):   when('_WARN_') ROLE = 'ASSESS';
MPRINT(EMADVISECOLUMNS):   when('EM_SEGMENT') do;
MPRINT(EMADVISECOLUMNS):   ROLE = 'SEGMENT';
MPRINT(EMADVISECOLUMNS):   LEVEL = 'NOMINAL';
MPRINT(EMADVISECOLUMNS):   end;
MPRINT(EMADVISECOLUMNS):   when('_NODE_') do;
MPRINT(EMADVISECOLUMNS):   ROLE = 'SEGMENT';
MPRINT(EMADVISECOLUMNS):   LEVEL = 'NOMINAL';
MPRINT(EMADVISECOLUMNS):   end;
MPRINT(EMADVISECOLUMNS):   when('EM_CLASSTARGET') ROLE = 'ASSESS';
MPRINT(EMADVISECOLUMNS):   when('EM_VALUETARGET') ROLE = 'ASSESS';
MPRINT(EMADVISECOLUMNS):   when('EM_PREDICTION') ROLE = 'PREDICT';
MPRINT(EMADVISECOLUMNS):   when('EM_PROBABILITY') ROLE = 'PREDICT';
MPRINT(EMADVISECOLUMNS):   when('EM_EVENTPROBABILITY') ROLE = 'PREDICT';
MPRINT(EMADVISECOLUMNS):   when('EM_CLASSIFICATION') ROLE = 'CLASSIFICATION';
MPRINT(EMADVISECOLUMNS):   when('EM_DECISION') ROLE = 'DECISION';
MPRINT(EMADVISECOLUMNS):   when('EM_PROFIT') ROLE = 'ASSESS';
MPRINT(EMADVISECOLUMNS):   when('EM_LOSS') ROLE = 'ASSESS';
MPRINT(EMADVISECOLUMNS):   when('EM_ROI') ROLE = 'ASSESS';
MPRINT(EMADVISECOLUMNS):   when('URI') ROLE = 'URL';
MPRINT(EMADVISECOLUMNS):   when('FILTERED') ROLE = 'TEXTLOC';
MPRINT(EMADVISECOLUMNS):   otherwise do;
MPRINT(EMADVISECOLUMNS):   if upcase(NAME) =: 'ZIP' then do;
MPRINT(EMADVISECOLUMNS):   ROLE = 'REJECTED';
MPRINT(EMADVISECOLUMNS):   LEVEL = 'NOMINAL';
MPRINT(EMADVISECOLUMNS):   COMMENT = 'Rejected by: Exceed the maximum class level of %s';
MPRINT(EMADVISECOLUMNS):   end;
MPRINT(EMADVISECOLUMNS):   else if upcase(NAME) in('FREQ', 'FREQUENCY') then do;
MPRINT(EMADVISECOLUMNS):   ROLE = 'FREQ';
MPRINT(EMADVISECOLUMNS):   if TYPE = 'C' then ROLE = 'INPUT';
MPRINT(EMADVISECOLUMNS):   else if _freqflag =1 then ROLE='REJECTED';
MPRINT(EMADVISECOLUMNS):   end;
MPRINT(EMADVISECOLUMNS):   else do;
MPRINT(EMADVISECOLUMNS):   name_prefix = scan(_uname, 1, '_');
MPRINT(EMADVISECOLUMNS):   if scan(_uname, 2, '_') = '' then name_prefix='';
MPRINT(EMADVISECOLUMNS):   if name_prefix in('F', 'I', 'U') then do;
MPRINT(EMADVISECOLUMNS):   ROLE = 'CLASSIFICATION';
MPRINT(EMADVISECOLUMNS):   LEVEL = 'NOMINAL';
MPRINT(EMADVISECOLUMNS):   end;
MPRINT(EMADVISECOLUMNS):   else if name_prefix in('P', 'V') then ROLE = 'PREDICT';
MPRINT(EMADVISECOLUMNS):   else if name_prefix in('R', 'RS', 'RT', 'RD', 'RDS', 'RDT', 'RA', 'RAS', 'RAT') then ROLE = 'RESIDUAL';
MPRINT(EMADVISECOLUMNS):   else if name_prefix ='D' then do;
MPRINT(EMADVISECOLUMNS):   ROLE = 'DECISION';
MPRINT(EMADVISECOLUMNS):   LEVEL = 'NOMINAL';
MPRINT(EMADVISECOLUMNS):   end;
MPRINT(EMADVISECOLUMNS):   else if name_prefix ='B' then do;
MPRINT(EMADVISECOLUMNS):   ROLE = 'SEGMENT';
MPRINT(EMADVISECOLUMNS):   LEVEL = 'NOMINAL';
MPRINT(EMADVISECOLUMNS):   end;
MPRINT(EMADVISECOLUMNS):   else if name_prefix in('EP', 'BP', 'CP', 'EL', 'CL', 'BL', 'W', 'ROI', 'IC') then ROLE = 'ASSESS';
MPRINT(EMADVISECOLUMNS):   else do;
MPRINT(EMADVISECOLUMNS):   array _ROLE_ (19) $32 _TEMPORARY_ ('ASSESS','CLASSIFICATION','CENSOR', 'COST', 'CROSSID', 'DECISION', 'ID','INPUT', 'LABEL', 'MISSING','PREDICT','REFERRER','REJECTED', 'RESIDUAL','SEGMENT', 'SEQUENCE','TARGET', 'TEXT', 'TIMEID');
MPRINT(EMADVISECOLUMNS):   drop _found_ i;
MPRINT(EMADVISECOLUMNS):   _found_=0;
MPRINT(EMADVISECOLUMNS):   do i=1 to 19 until(_found_=1);
MPRINT(EMADVISECOLUMNS):   if index(_uname, trim(_ROLE_{i}))=1 then do;
MPRINT(EMADVISECOLUMNS):   ROLE=_ROLE_{i};
MPRINT(EMADVISECOLUMNS):   if ROLE = 'ID' then LEVEL = 'NOMINAL';
MPRINT(EMADVISECOLUMNS):   else if ROLE = 'SEGMENT' then LEVEL = 'NOMINAL';
MPRINT(EMADVISECOLUMNS):   else if ROLE = 'TIMEID' and TYPE='N' then LEVEL = 'INTERVAL';
MPRINT(EMADVISECOLUMNS):   _found_=1;
MPRINT(EMADVISECOLUMNS):   end;
MPRINT(EMADVISECOLUMNS):   end;
MPRINT(EMADVISECOLUMNS):   if length(_uname)>2 then do;
MPRINT(EMADVISECOLUMNS):   if substr(reverse(trim(_uname)), 1, 3) = 'DI_' then do;
MPRINT(EMADVISECOLUMNS):   ROLE = 'ID';
MPRINT(EMADVISECOLUMNS):   LEVEL = 'NOMINAL';
MPRINT(EMADVISECOLUMNS):   end;
MPRINT(EMADVISECOLUMNS):   end;
MPRINT(EMADVISECOLUMNS):   end;
MPRINT(EMADVISECOLUMNS):   end;
MPRINT(EMADVISECOLUMNS):   end;
MPRINT(EMADVISECOLUMNS):   end;
MPRINT(EMADVISECOLUMNS):   if ROLE='FREQ' then _freqflag=1;
MPRINT(EMADVISECOLUMNS):   else if ROLE = 'CLASSIFICATION' then LEVEL = 'NOMINAL';
MPRINT(EMADVISECOLUMNS):   end;
MPRINT(EMADVISECOLUMNS):   if role = ' ' then do;
MPRINT(EMADVISECOLUMNS):   if formattype in('DATE', 'DATETIME', 'TIME') then role = 'TIMEID';
MPRINT(EMADVISECOLUMNS):   else role = 'INPUT';
MPRINT(EMADVISECOLUMNS):   roleAssigned = 1;
MPRINT(EMADVISECOLUMNS):   end;
MPRINT(EMADVISECOLUMNS):   else role = upcase(role);
MPRINT(EMADVISECOLUMNS):   if REPORT = '' then REPORT = 'N';
MPRINT(EMADVISECOLUMNS):   run;
MPRINT(EMADVISECOLUMNS):    data WORK.M32CMMS8;
MPRINT(EMADVISECOLUMNS):   set WORK.M32CMMS8;
MPRINT(EMADVISECOLUMNS):   label NAME = "Variable Name" TYPE = "Type" ROLE = "Role" LEVEL= "Measurement Level" ORDER= "Order" CREATOR= "Creator" FORMATTYPE= "Format Type" FAMILY= "Family" DISTRIBUTION= "Distribution" PRICE= "Price" LOWERLIMIT= "Lower
limit" UPPERLIMIT= "Upper Limit" REPORT= "Report" COMMENT= "Comment" INDEX= "Index" INDEXTYPE= "IndexType" LABEL= "Label" LENGTH= "Length";
MPRINT(EMADVISECOLUMNS):   drop levelAssigned roleAssigned;
MPRINT(EMADVISECOLUMNS):   run;
MPRINT(EMADVISECOLUMNS):
MPRINT(EM_DIAGRAM):  ;
MPRINT(EM_DIAGRAM):   proc sort data=WORK.COLUMNMETA;
MPRINT(EM_DIAGRAM):   by NAME;
MPRINT(EM_DIAGRAM):   run;
MPRINT(EM_DIAGRAM):   *------------------------------------------------------------*;
MPRINT(EM_DIAGRAM):   * &nodeid: Merge incoming metadata;
MPRINT(EM_DIAGRAM):   *------------------------------------------------------------*;
MPRINT(EM_DIAGRAM):   proc contents data=EMWS8.Part_TRAIN noprint out=_temp2(keep=NAME);
MPRINT(EM_DIAGRAM):   run;
MPRINT(EM_DIAGRAM):   proc sort data=_temp2;
MPRINT(EM_DIAGRAM):   by NAME;
MPRINT(EM_DIAGRAM):   run;
MPRINT(EM_DIAGRAM):   proc sort data=EMWS8.Part_CMeta_TRAIN out=_temp;
MPRINT(EM_DIAGRAM):   by NAME;
MPRINT(EM_DIAGRAM):   run;
MPRINT(EM_DIAGRAM):   data EMWS8.VarClus_CMeta_TRAIN;
MPRINT(EM_DIAGRAM):   merge WORK.COLUMNMETA(in=_a) _temp2(in=_b) _temp(drop=FORMAT INFORMAT LENGTH INDEX INDEXTYPE in=_c) end=_eof_;
MPRINT(EM_DIAGRAM):   by NAME;
MPRINT(EM_DIAGRAM):   if (^_a and _b) or (^_c and _a and _b) then delete;
MPRINT(EM_DIAGRAM):   if ^_b then CREATOR = "VarClus";
MPRINT(EM_DIAGRAM):   *------------------------------------------------------------*;
MPRINT(EM_DIAGRAM):   * VarClus: Apply Delta Code;
MPRINT(EM_DIAGRAM):   *------------------------------------------------------------*;
MPRINT(EM_DIAGRAM):   if upcase(strip(ROLE))='INPUT' and upcase(strip(LEVEL))='INTERVAL' then do;
MPRINT(EM_DIAGRAM):   if upcase(strip(NAME)) in ( "CLUS1" "CLUS2" "CLUS3" "CLUS4" "CLUS5" "CLUS6" "CLUS7" "CLUS8" ) then ROLE="INPUT";
MPRINT(EM_DIAGRAM):   else ROLE="REJECTED";
MPRINT(EM_DIAGRAM):   end;
MPRINT(EM_DIAGRAM):   if upcase(strip(ROLE)) = "REJECTED" then delete ;
MPRINT(EM_DIAGRAM):   run;
MPRINT(EM_DIAGRAM):   filename _delta;
NOTE: View EMWS8.VARCLUS_TRAIN.VIEW used (Total process time):
      real time           0.01 seconds
      cpu time            0.01 seconds
 
NOTE: View EMWS8.VARCLUS_VALIDATE.VIEW used (Total process time):
      real time           0.01 seconds
      cpu time            0.01 seconds
 
MPRINT(EM_DIAGRAM):    proc printto;
MPRINT(EM_DIAGRAM):   run;
MPRINT(EM_DIAGRAM):    data _null_;
MPRINT(EM_DIAGRAM):   call symput('NLDATE', strip(put(date(), NLDATE.)));
MPRINT(EM_DIAGRAM):   call symput('NLTIME', strip(put(datetime(), NLTIME.)));
MPRINT(EM_DIAGRAM):   run;
MPRINT(EM_DIAGRAM):   data _null_;
MPRINT(EM_DIAGRAM):   nldate= sasmsg("sashelp.dmine", "log_date_note", 'N', "19. April 2016" );
MPRINT(EM_DIAGRAM):   nltime= sasmsg("sashelp.dmine", "log_time_note", 'N', "17.21 Uhr" );
MPRINT(EM_DIAGRAM):   put "*------------------------------------------------------------*";
MPRINT(EM_DIAGRAM):   put "* Report Log";
MPRINT(EM_DIAGRAM):   put nldate;
MPRINT(EM_DIAGRAM):   put nltime;
MPRINT(EM_DIAGRAM):   put "*------------------------------------------------------------*";
MPRINT(EM_DIAGRAM):   run;
*------------------------------------------------------------*
* Report Log
Date:                19. April 2016
Time:                17.21 Uhr
*------------------------------------------------------------*
MPRINT(EM_DIAGRAM):    filename O1KK1MKG "C:\\predictive-models-project\Workspaces\EMWS8\VarClus\EMREPORT.out" encoding="UTF-8" NOBOM;
MPRINT(EM_DIAGRAM):   proc printto print=O1KK1MKG new;
MPRINT(EM_DIAGRAM):   run;
101680     %let EMEXCEPTIONSTRING=;
101681     *------------------------------------------------------------*;
MPRINT(EM_DIAGRAM):    *------------------------------------------------------------*;
101682     * REPORT: VarClus;
MPRINT(EM_DIAGRAM):   * REPORT: VarClus;
101683     *------------------------------------------------------------*;
MPRINT(EM_DIAGRAM):   *------------------------------------------------------------*;
101684     %let EM_ACTION = REPORT;
101685     %let syscc = 0;
101686
101687     %macro main;
101688
101689        filename temp catalog 'sashelp.emexpl.variableclustering_macros.source';
101690        %include temp;
101691        filename temp catalog 'sashelp.emexpl.variableclustering_macros2.source';
101692        %include temp;
101693        filename temp;
101694
101695       %SetProperties;
101696
101697        %if %upcase(&EM_ACTION) = CREATE %then %do;
101698            filename temp catalog 'sashelp.emexpl.variableclustering_create.source';
101699            %include temp;
101700            filename temp;
101701            %create;
101702        %end;
101703        %else
101704        %if %upcase(&EM_ACTION) = TRAIN %then %do;
101705             filename temp catalog 'sashelp.emexpl.variableclustering_train.source';
101706                %include temp;
101707                filename temp;
101708                %train;
101709        %end;
101710        %else
101711        %if %upcase(&EM_ACTION) = SCORE %then %do;
101712                filename temp catalog 'sashelp.emexpl.variableclustering_score.source';
101713                %include temp;
101714                filename temp;
101715                %score;
101716        %end;
101717        %else
101718        %if %upcase(&EM_ACTION) = REPORT %then %do;
101719                filename temp catalog 'sashelp.emexpl.variableclustering_report.source';
101720                %include temp;
101721                filename temp;
101722                %report;
101723        %end;
101724        /*
101725        %if %upcase(&EM_ACTION) = OPENTESTTABLE %then %do;
101726            %put 'OPENING TABLE';
101727        %end;
101728        %if %upcase(&EM_ACTION) = CLOSETESTTABLE %then %do;
101729            %put 'CLOSE TABLE';
101730        %end;
101731        */
101732     %mend main;
101733     %main;
MPRINT(EM_DIAGRAM):
MPRINT(MAIN):   filename temp catalog 'sashelp.emexpl.variableclustering_macros.source';
NOTE: %INCLUDE (level 1) file TEMP is file SASHELP.EMEXPL.VARIABLECLUSTERING_MACROS.SOURCE.
101735    +/* Initialize property macro variables */
101736    +%macro SetProperties;
101737    +   %em_checkmacro(name=EM_PROPERTY_MAXCLUS,       global=Y, value=DEFAULT);
101738    +   %em_checkmacro(name=EM_PROPERTY_HIDEVARIABLE,  global=Y, value=Y);
101739    +   %em_checkmacro(name=EM_PROPERTY_PRINTOPTION,   global=Y, value=SHORT);
101740    +   %em_checkmacro(name=EM_PROPERTY_CLUSSOURCE,    global=Y, value=CORR);
101741    +   %em_checkmacro(name=EM_PROPERTY_CLUSCOMP,      global=Y, value=PRINCIPAL);
101742    +   %em_checkmacro(name=EM_PROPERTY_CLUSHIERACHY,      global=Y, value=Y);
101743    +   %em_checkmacro(name=EM_PROPERTY_INCLUDECLASSVAR,      global=Y, value=N);
101744    +   %em_checkmacro(name=EM_PROPERTY_EXPORTEDCOMP,      global=Y, value=CLUSTERCOMP);
101745    +   %em_checkmacro(name=EM_PROPERTY_MAXEIGEN,         global=Y, value=DEFAULT);
101746    +   %em_checkmacro(name=EM_PROPERTY_PROPORTION,      global=Y, value=DEFAULT);
101747    +   %em_checkmacro(name=EM_PROPERTY_PRINTOPTION,      global=Y, value=SHORT);
101748    +   %em_checkmacro(name=EM_PROPERTY_TWOSTAGECLUS,      global=Y, value=AUTO);
101749    +   %em_checkmacro(name=EM_PROPERTY_SUPPRESSSAMPWARN,      global=Y, value=N);
101751    +%mend SetProperties;
101753    +%Macro MakeDummyVariables(indata=,
101754    +                          outvar=,
101755    +                          outdata=,
101756    +                          fileref=,
101757    +                          recreatecmeta=N, /* optional */
101758    +                          incmeta=,     /* optional */
101759    +                          outcmeta=,    /* optional */
101760    +                          ndummyvars=_ndummyvars
101761    +                          );
101762    +    %global &ndummyvars;
101764    +    proc dmdb batch data=&indata out=_dmdbdat dmdbcat=_dmdbcat classout=_classout;;
101765    +       class
101766    +       %EM_BINARY_INPUT %EM_NOMINAL_INPUT %EM_ORDINAL_INPUT
101767    +       %EM_BINARY_REJECTED %EM_NOMINAL_REJECTED %EM_ORDINAL_REJECTED
101768    +    ;
101769    +    run;
101770    +    %let &ndummyvars = 0;
101771    +    data _null_;
101772    +    %let dsid = %sysfunc(open(work._classout));
101773    +      %let &ndummyvars = %sysfunc(attrn(&dsid, NOBS));
101774    +    %let dsid = %sysfunc(close(&dsid));
101775    +    run;
101777    +    proc dmzip data=_dmdbdat dmdbcat=_dmdbcat;
101778    +       input
101779    +       %EM_BINARY_INPUT %EM_NOMINAL_INPUT %EM_ORDINAL_INPUT
101780    +       %EM_BINARY_REJECTED %EM_NOMINAL_REJECTED %EM_ORDINAL_REJECTED
101781    +        / level=nominal stdize=no;
101782    +       make outvar = &outvar;
101783    +       score data = &indata out =&outdata;
101784    +       code  file=  "&fileref";
101785    +    run;
101786    +    %if &recreatecmeta eq Y %then %do;
101787    +    proc contents data =&outvar out=_tmpds(keep=NAME LABEL);
101788    +    data _tmpds;
101789    +        set _tmpds;
101790    +           ROLE = 'INPUT';
101791    +           LEVEL = 'INTERVAL';
101792    +           CREATOR='DMZIP';
101793    +           if NAME = '_TYPE_' then delete;
101794    +    run;
101795    +    data &outcmeta;
101796    +         set &incmeta _tmpds;
101797    +    run;
101798    +    %end;
101799    +    proc datasets lib=work nolist;
101800    +      delete  _dmdbdat _dmdbcat _classout
101801    +    %if &recreatecmeta eq Y %then %do;
101802    +    _tmpds
101803    +    %end;
101804    +    ;
101805    +    quit;
101806    +%Mend MakeDummyVariables;
101808    +/*--- Determine Optimal Number of Cluster ----
101809    +%macro FindClusNum(statds=, groupds=, minvariation=);
101810    +   %global optnclus;
101811    +   data varclus_tmp(drop=_NAME_);
101812    +      set &statDs;
101813    +      where _type_ ='PROPOR';
101814    +   run;
101815    +   proc sort data=varclus_tmp;
101816    +      by _NCL_;
101817    +   run;
101818    +   proc transpose data=varclus_tmp out=varclus_tmp;
101819    +      by _NCL_;
101820    +      var %EM_INTERVAL_INPUT
101821    +      %if &EM_PROPERTY_INCLUDECLASSVAR eq Y %then %do;
101822    +      %let dsid = %sysfunc(open(&EM_USER_OUTDUMMY));
101823    +      %let nvar = %sysfunc(attrn(&dsid, NVAR));
101824    +          %do i = 2 %to &nvar;
101825    +          %let varname = %sysfunc(varname(&dsid, &i));
101826    +          &varname
101827    +          %end;
101828    +      %end;
101829    +   ;
101830    +   run;
101832    +   %if &minVariation eq %then %do;
101833    +       %let minVariation = &EM_PROPERTY_MINVARIATION;
101834    +   %end;
101835    +   %if ^(0<&minVariation<100) %then %do;
101836    +       %let minVariation = 90;
101837    +   %end;
101839    +   data _null_;
101840    +      set varclus_tmp end=eof;
101841    +      by _NCL_;
101842    +      retain flag 0;
101843    +      if first._ncl_ then flag=0;
101844    +      if .<col1 < &minVariation then flag=1;
101845    +      if last._ncl_ and ^flag then do;
101846    +         call symput('OPTNCL', _ncl_);
101847    +         stop;
101848    +      end;
101849    +     if eof then call symput('OPTNCL', _ncl_);
101850    +   run;
101852    +   %let optnclus = &OPTNCL;
101854    +   data varclus_tmp(drop=_NCL_ _NAME_);
101855    +      set &statDs;
101856    +      where _type_ in('RSQUARED' 'GROUP') and _NCL_=&OPTNCL;
101857    +   run;
101858    +   proc sort data=varclus_tmp;
101859    +      by _TYPE_;
101860    +   run;
101861    +   proc transpose data=varclus_tmp out=varclus_tmp;
101862    +      by _TYPE_;
101863    +   run;
101864    +   proc sort data=varclus_tmp;
101865    +      by _name_ _type_;
101866    +   run;
101868    +  proc transpose data=varclus_tmp out=&groupds;
101869    +      by _NAME_;
101870    +   run;
101871    +   proc sort data=&groupDs(rename=(col1=Cluster col2=Rsquare _NAME_=VARIABLE));
101872    +      by Cluster descending Rsquare;
101873    +      where Cluster ne 0;
101874    +   run;
101875    +   proc datasets lib=work nolist mt=(DATA VIEW);
101876    +      delete varclus_tmp;
101877    +   run;
101878    +   quit;
101879    +%mend findClusNum;
101880    +*/
101882    +%macro getNclusfromTrain(inoutstat=, nc=);
101883    +%global &nc;
101884    +data _null_;
101885    +    set &inoutstat end=eof;
101886    +    if eof then do;
101887    +    call symput("&nc", _ncl_);
101888    +    end;
101889    +run;
101890    +%mend  getNclusfromTrain;
101892    +%macro MakeDeltaCode(groupds=, outstatscore=, deltacodefile=);
101894    +     *--- Build Code to Modify Metadata ---*;
101895    +     filename X "&deltacodefile";
101896    +     data _null_;
101897    +        FILE X;
101898    +        set &groupds end=eof;
101899    +        /*by Cluster;*/
101900    +         if _N_=1 then do;
101901    +           %if &EM_PROPERTY_INCLUDECLASSVAR eq Y %then %do;
101902    +            put "if upcase(strip(ROLE)) ='INPUT' and upcase(strip(LEVEL)) ^='INTERVAL' then ROLE ='REJECTED' ;";
101903    +           %end;
101904    +           put "if upcase(strip(ROLE))='INPUT' and upcase(strip(LEVEL))='INTERVAL' then do;";
101905    +           put "if upcase(strip(NAME)) in (";
101906    +        end;
101907    +        if Strip(upcase(Selected)) eq 'YES' then do;
101908    +           string = '"'!!trim(left(VARIABLE))!!'"';
101909    +           put string;
101910    +        end;
101911    +        if eof then do;
101912    +           put ') then ROLE="INPUT";';
101913    +           put 'else ROLE="REJECTED";';
101914    +           put 'end;';
101916    +           %if %upcase(&EM_PROPERTY_HIDEVARIABLE) eq Y %then %do;
101917    +             put 'if upcase(strip(ROLE)) = "REJECTED" then delete ;';
101918    +           %end;
101919    +        end;
101920    +     run;
101921    +     quit;
101923    +     filename X;
101925    +     quit;
101926    +%mend MakeDeltaCode;
101928    +%macro MakeVarClusCorrData(statds=, corrds=, corrplotds= );
101929    +    %if ^%sysfunc(exist(&statds)) %then %do;
101930    +         %goto doendc;
101931    +    %end;
101933    +    data &corrds(drop=_TYPE_ _NCL_) ;
101934    +       set &statds;
101935    +       where _type_ eq 'CORR' ;
101936    +    run ;
101937    +    proc sort data=&corrds;
101938    +       by _NAME_ ;
101939    +    run ;
101940    +    proc transpose data=&corrds out=&corrplotds name=_TMP_;
101941    +      BY _NAME_ ;
101942    +    run ;
101943    +    data &corrplotds;
101944    +       length _Y_ $100;
101945    +       set &corrplotDs;
101946    +       if _LABEL_ ne '' then _Y_=_LABEL_ ; else _Y_=_TMP_ ;
101947    +    run ;
101948    +    data varclus_match(rename=(_TMP_= _NAME_ _LABEL_=_X_));
101949    +       set &corrplotds;
101950    +       where _LABEL_ ne '' ;
101951    +       keep _TMP_ _LABEL_ ;
101952    +    run ;
101953    +    data _null_;
101954    +       nobs=0;
101955    +       dsid = open('varclus_match');
101956    +       if dsid then do;
101957    +          nobs = attrn(dsid, 'NOBS');
101958    +          dsid = close(dsid);
101959    +       end;
101960    +       call symput ('CORR_NOBS', nobs);
101961    +    run;
101962    +    %if &corr_nobs %then %do;
101963    +        proc sort data=varclus_match;
101964    +           by _name_;
101965    +        run ;
101966    +        proc sort data=&corrplotds;
101967    +           by _name_;
101968    +        run ;
101969    +        data &corrplotds(keep= _X_ _Y_ col1 rename=(col1=Correlation)) ;
101970    +           merge varclus_match &corrplotds;
101971    +           by _NAME_ ;
101972    +           if _X_ eq '' then _X_=_NAME_ ;
101973    +           label _X_ = "%sysfunc(sasmsg(sashelp.dmine, rpt_varclus_label_variable, noquote))";
101974    +           label _Y_ = "%sysfunc(sasmsg(sashelp.dmine, rpt_varclus_label_variable, noquote))";
101975    +           label col1 = "%sysfunc(sasmsg(sashelp.dmine, rpt_correlation_vlabel, noquote))";
101977    +       run ;
101978    +    %end;
101979    +    %else %do;
101980    +        proc sort data=&corrplotds;
101981    +           by _name_;
101982    +        run ;
101983    +        data &corrplotds(keep= _NAME_ _Y_ col1 rename=(_NAME_=_X_ col1=Correlation)) ;
101984    +           set &corrplotds;
101985    +           label _NAME_ = "%sysfunc(sasmsg(sashelp.dmine, rpt_varclus_label_variable, noquote))" ;
101986    +           label _Y_ = "%sysfunc(sasmsg(sashelp.dmine, rpt_varclus_label_variable, noquote))" ;
101987    +           label col1 = "%sysfunc(sasmsg(sashelp.dmine, rpt_correlation_vlabel, noquote))";
101989    +        run ;
101990    +    %end;
101991    +    proc sort data=&corrplotds;
101992    +       by _X_ _Y_;
101993    +    run ;
101994    +    proc datasets lib=work nolist mt=(DATA VIEW);
101995    +       delete varclus_match;
101996    +    run;
101997    +    quit;
101999    +%doendc:
102001    +%mend MakeVarClusCorrData;
102003    +%macro MakeStatPlotData(statds= , outstatplotds=);
102004    +   %if %sysfunc(exist(&statds)) %then %do;
102006    +       data varclus_tmp(drop=_NAME_ _NCL_) ;
102007    +          set &statDs;
102008    +          where _type_ in('MEAN', 'STD', 'N');
102009    +       run ;
102010    +       proc transpose data=varclus_tmp out=&outstatplotds;
102011    +          id _TYPE_ ;
102012    +       run ;
102013    +       data &outstatplotds;
102014    +          set &outstatplotds(obs=1000);
102015    +          label _name_= "%sysfunc(sasmsg(sashelp.dmine, rpt_varclus_label_name, noquote))";
102016    +          label _label_="%sysfunc(sasmsg(sashelp.dmine, rpt_varclus_label_label, noquote))" ;
102017    +          if MEAN ne 0 then SCALEDSTD= STD / MEAN ;
102018    +          else SCALEDSTD= STD ;
102019    +          label SCALEDSTD = "%sysfunc(sasmsg(sashelp.dmine, rpt_varclus_label_scaledstd, noquote))";
102020    +       run ;
102021    +       proc sort data=&outstatplotds;
102022    +          by descending SCALEDSTD ;
102023    +       run ;
102024    +       proc datasets lib=work nolist mt=(DATA VIEW);
102025    +          delete varclus_tmp;
102026    +       run;
102027    +       quit;
102028    +    %end;
102030    +%mend MakeStatPlotData;
102033    +%macro CreateScoreCode(indata=, ncluscomp=, fileref=);
102034    +     %EM_GETNAME(KEY=OUTSTATSCORE, type=DATA);
102035    +    data &EM_USER_OUTSTATSCORE;
102036    +          set &indata;
102037    +          if (_TYPE_ in ('SCORE' 'MEAN' 'STD') and _NCL_ = &ncluscomp ) or (_TYPE_ in ('MEAN' 'STD'));
102038    +          if _TYPE_ = 'MEAN' then _NAME_='MEAN';
102039    +          if _TYPE_ = 'STD' then _NAME_='STD';
102040    +          DROP _TYPE_ _NCL_;
102041    +     run;
102043    +     filename _file_  "&fileRef";
102045    +     data _null_;
102046    +        FILE _file_ MOD;
102047    +        put ' ';
102048    +        put '/*-------------------------------------------------*/';
102049    +        put '/* ' "%sysfunc(sasmsg(sashelp.dmine, rpt_varclus_score_title_begin , noquote))" '*/';
102050    +        put '/*-------------------------------------------------*/';
102051    +        put ' ';
102052    +        %let dsid = %sysfunc(open(&EM_USER_OUTSTATSCORE));
102054    +        %let nvar = %sysfunc(attrn(&dsid, NVAR));
102055    +        %let vn_name =%sysfunc(varnum(&dsid, _NAME_));
102057    +        %let k = 1;
102058    +        %do %while(^%sysfunc(fetch(&dsid)));
102059    +                %let _name = %sysfunc(getvarc(&dsid, &vn_name));
102060    +                %if &k > 2 %then %do;
102061    +                 %let cn = %eval(&k-2);
102062    +                 put "&_name = 0 ; /*---" "%sysfunc(sasmsg(sashelp.dmine, rpt_varclus_score_cluscompnum, noquote, &cn))"  "------ */";
102063    +                %end;
102064    +                %let k = %eval(&k+1);
102065    +        %end;
102067    +        %let rc = %sysfunc(rewind(&dsid));
102069    +        %do i= 2 %to &nvar;
102070    +            %let _varname =  %sysfunc(varname(&dsid, &i));
102071    +            %do %while(^%sysfunc(fetch(&dsid)));
102072    +                %let _name = %sysfunc(getvarc(&dsid, &vn_name));
102073    +                %if &_name = MEAN %then
102074    +                %let _mean = %sysfunc(getvarn(&dsid, &i));
102075    +                %else %if &_name = STD %then
102076    +                %let _std = %sysfunc(getvarn(&dsid, &i));
102077    +                %else %do;
102078    +                      %let coeff =  %sysfunc(getvarn(&dsid, &i));
102079    +                      %let abscoeff = %sysfunc(abs(&coeff));
102080    +                          %if &abscoeff >  0 %then %do;
102081    +                       put "&_name = &_name+&coeff * (&_varname - &_mean)/&_std;";
102082    +                           %end;
102083    +                 %end;
102084    +             %end;
102085    +             %let rc = %sysfunc(rewind(&dsid));
102086    +         %end;
102088    +        %let dsid= %sysfunc(close(&dsid));
102089    +       run;
102090    +%mend CreateScoreCode;
102094    +/*----------------------------------------------------------
102095    +    Instead of using %MakeRSquareData,
102096    +    %MakeVarClusResultTable at macro2.source is used
102097    + +----------------------------------------------------------*/
102100    +%macro MakeRSquareData(indata=, inClusRSquare=, outdata=, ncluster=);
102102    +/* modifying  from ods rsquare = data */
102104    +data &outdata(drop= ControlVar  NumberOfClusters CurrentCluster);
102105    +    Length Cluster $16;
102106    +    length Variable $32;
102107    +    Length VariableLabel $64;
102108    +    set &indata; retain CurrentCluster;
102109    +    if NumberOfClusters ^= &ncluster then delete;
102110    +    if strip(Cluster) eq '' then Cluster = CurrentCluster;
102111    +    CurrentCluster = Cluster;
102112    +   run;
102113    +proc sort data =&outdata ;
102114    +     by Cluster RsquareRatio;
102115    +run;
102116    +data _tmprsq(drop=index);
102117    +     set &outdata; by Cluster;
102118    +     if first.Cluster then do;
102119    +     index = strip(scan(Cluster,2 ));
102120    +     Variable = "Clus"||index;
102121    +     VariableLabel = "Cluster Component "||index;
102122    +     OwnCluster = 1;
102123    +     NextClosest = .;
102124    +     RsquareRatio = 0;
102125    +     output;
102126    +     end;
102127    +run;
102129    +proc sort data = _tmprsq ;
102130    +     by Cluster RsquareRatio;
102131    +run;
102132    +data &outdata;
102133    +     set &outdata _tmprsq;
102134    +by Cluster;
102135    +run;
102138    +/* Just create the Selected variable with all YES */
102140    +data &outdata;
102141    +    set &outdata; by cluster;
102142    +    length Selected $8;
102143    +    Selected = 'YES';
102144    +    label  OwnCluster = 'R-Sqaure with Cluster Component';
102145    +    label  NextClosest = 'R-Sqaure with Next Cluster Component';
102146    +    rename OwnCluster = RSqWithClusterComp;
102147    +    rename NextClosest = RSqWithNextClusComp;
102148    +run;
102151    +/* Selected = Y/N will be done %score section -----
102153    +%if &EM_PROPERTY_EXPORTEDCOMP ne CLUSTERCOMP %then %do;
102154    +data &outdata;
102155    +    set &outdata; by cluster;
102156    +    length Selected $8;
102157    +    if first.Cluster then Selected = 'YES';
102158    +    else Selected = 'NO';
102159    +    label  OwnCluster = 'R-Sqaure with Cluster Component';
102160    +    label  NextClosest = 'R-Sqaure with Next Cluster Component';
102161    +    rename OwnCluster = RSqWithClusterComp;
102162    +    rename NextClosest = RSqWithNextClusComp;
102163    +run;
102164    +%end;
102165    +%else %do;
102166    +data &outdata;
102167    +    set &outdata; by cluster;
102168    +    if last.Cluster then Selected = 'YES';
102169    +    else Selected = 'NO';
102170    +    label  OwnCluster = 'R-Sqaure with Cluster Component';
102171    +    label  NextClosest = 'R-Sqaure with Next Cluster Component';
102172    +    rename OwnCluster = RSqWithClusterComp;
102173    +    rename NextClosest = RSqWithNextClusComp;
102174    +run;
102175    +%end;
102176    +---------------------------------------------------------------*/
102178    +%if %sysfunc(exist(&inClusRSquare)) %then %do;
102179    +/* to calculate NextClosestClusRsq */
102180    +proc transpose data = &inClusRSquare  out=_clusRsq;
102181    +      by cluster;
102182    +      run;
102183    +data _clusRsq;
102184    +     set _clusRsq;
102185    +     if strip(upcase(Cluster)) eq strip(upcase(_NAME_)) then delete;
102186    +run;
102188    +proc sort data=_clusRsq;
102189    +    by cluster col1;
102190    +    run;
102191    +data _clusRsq(drop=_NAME_ _LABEL_);
102192    +     set _clusRsq; by cluster;
102193    +     if last.Cluster then output;
102194    +     label  COL1 = 'R-Sqaure with Next Cluster Component';
102195    +     rename COL1 = RSqWithNextClusComp;
102196    +     rename Cluster = Variable;
102197    +     label  Cluster = "Variable";
102198    +run;
102200    +proc sort data =&outdata;
102201    +     by Variable;
102202    +run;
102203    +data &outdata;
102204    +    merge &outdata _clusRsq;
102205    +    by Variable;
102206    +run;
102207    +proc sort data =&outdata;
102208    +by Cluster  RsquareRatio;
102209    +run;
102210    +quit;
102211    +%end;
102213    +proc datasets lib = work nolist;
102214    +     delete _tmprsq _clusRsq;
102215    +     run;
102216    +quit;
102218    +%mend MakeRSquareData;
102221    +/*-------------------------------------------------------------------------*/
102225    +%macro ModifyCorr(indata=,
102226    +                  outdata=,
102227    +                  rsquare = Y
102228    +                  );
102229    +    data corr_tmp;
102230    +        set &indata;
102231    +    run;
102232    +     proc sql;
102233    +           update &indata
102234    +           set
102235    +     %let dsid = %sysfunc(open(work.corr_tmp));
102236    +     %let nvar = %sysfunc(attrn(&dsid, NVAR));
102237    +          %do i = 4 %to &nvar;
102238    +          %let _name = %sysfunc(varname(&dsid, &i));
102239    +             %if &rsquare eq Y %then %let _name_md = &_name.**2;
102240    +            %else  %let _name_md = &_name;
102241    +            %if &i < &nvar %then %do;
102242    +               &_name = 1- &_name_md ,
102243    +            %end;
102244    +            %else %do;
102245    +               &_name = &_name_md where _TYPE_ contains 'CORR' ;
102246    +            %end;
102247    +          %end;
102248    +      %let dsid= %sysfunc(close(&dsid));
102250    +      select * from &indata;
102251    +      run;
102252    +      proc datasets lib = work nolist;
102253    +           delete corr_tmp;
102254    +      run;
102255    +      quit;
102257    + %mend ModifyCorr;
102259    + %macro MakeClusStructCorrData(indata=,outdata=, ncluster=, Rsquare=N);
102260    +    data &outdata(drop= _NCL_  _TYPE_);
102261    +       set &indata;
102262    +       if ^(strip(_NCL_) eq &ncluster and strip(_TYPE_) eq 'STRUCTUR') then delete;
102263    +       rename _NAME_ = Cluster;
102264    +       label _NAME_ = "%sysfunc(sasmsg(sashelp.dmine, rpt_varclus_label_clustername,  noquote))";
102265    +    run;
102266    +    %if &RSquare eq Y %then %do;
102267    +     data corr_tmp;
102268    +        set &outdata;
102269    +     run;
102271    +     data &outdata(drop=i);
102272    +          set &outdata;
102273    +          %let dsid = %sysfunc(open(work.corr_tmp));
102274    +          %let nvar = %sysfunc(attrn(&dsid, NVAR));
102275    +          %do i = 2 %to &nvar;
102276    +            %let _name = %sysfunc(varname(&dsid, &i));
102277    +            %let _name_md = &_name.**2;
102278    +                &_name = &_name_md;
102279    +          %end;
102280    +      %let dsid= %sysfunc(close(&dsid));
102281    +      run;
102282    +      proc datasets lib = work nolist;
102283    +           delete corr_tmp;
102284    +      run;
102286    +    %end;
102287    +     quit;
102288    +%mend MakeClusStructCorrData;
102290    +%macro MakeInterClusCorrData(indata=, outdata=, ncluster=, RSquare=N, makeplotds=N, plotds=);
102291    +    data &outdata(drop= _NCL_  _TYPE_);
102292    +       set &indata;
102293    +       if ^(strip(_NCL_) eq &ncluster and strip(_TYPE_) eq 'CCORR') then delete;
102294    +       rename _NAME_ = Cluster;
102295    +       label _NAME_ = "%sysfunc(sasmsg(sashelp.dmine, rpt_varclus_label_clustername,  noquote))";
102296    +    run;
102297    +    data corr_tmp;
102298    +        set &outdata;
102299    +    run;
102301    +    %let dsid = %sysfunc(open(work.corr_tmp));
102302    +    %let nclus2= %eval(&ncluster+1);
102303    +    data &outdata;
102304    +         set &outdata;
102305    +          %do i = 2 %to &nclus2;
102306    +          %let i_1 = %eval(&i-1);
102307    +            %let _name = %sysfunc(varname(&dsid, &i));
102308    +            %let _newName = Clus&i_1;
102309    +                rename &_name = &_newName; ;
102310    +                *label &_name ="Cluster &i_1";
102311    +                label &_name = "%sysfunc(sasmsg(sashelp.dmine, rpt_varclus_label_clusternum, noquote,  &i_1))";
102312    +          %end;
102313    +          keep Cluster
102314    +          %do i = 2 %to &nclus2;
102315    +                %let _name = %sysfunc(varname(&dsid, &i));
102316    +                &_name
102317    +          %end;
102318    +          ;
102319    +    %let dsid= %sysfunc(close(&dsid));
102320    +     run;
102321    +     quit;
102323    +    %if &RSquare eq Y %then %do;
102325    +       data corr_tmp;
102326    +        set &outdata;
102327    +     run;
102329    +     data &outdata(drop=i);
102330    +          set &outdata;
102331    +          %let dsid = %sysfunc(open(work.corr_tmp));
102332    +          %let nvar = %sysfunc(attrn(&dsid, NVAR));
102333    +          %do i = 2 %to &nvar;
102334    +            %let _name = %sysfunc(varname(&dsid, &i));
102335    +            %let _name_md = &_name.**2;
102336    +                &_name = &_name_md;
102337    +          %end;
102338    +      %let dsid= %sysfunc(close(&dsid));
102339    +      run;
102340    +    %end;
102342    +    %if &makeplotds eq Y %then %do;
102343    +     proc transpose data = &outdata
102344    +          out=&plotds(drop=_LABEL_ rename=(_NAME_ = Y Cluster=X Col1= Correlation));
102345    +          by cluster;
102346    +     run;
102347    +     data &plotds;
102348    +          set  &plotds;
102349    +          label x="%sysfunc(sasmsg(sashelp.dmine, rpt_varclus_label_cluster, noquote))";
102350    +          label Y="%sysfunc(sasmsg(sashelp.dmine, rpt_varclus_label_cluster, noquote))";
102351    +     run;
102352    +     %end;
102353    +     proc datasets lib = work nolist;
102354    +           delete corr_tmp;
102355    +     run;
102356    +     quit;
102357    +%mend MakeInterClusCorrData;
102360    +%macro MakeClusConstellData(indata=, outlink=, outnode=);
102362    +data &outlink(drop = Selected);
102363    +     set &indata;
102364    +     LINKID = _N_;
102365    +     label LINKID = "%sysfunc(sasmsg(sashelp.dmine, rpt_varclus_label_linkid,  noquote))";
102366    +     if strip(upcase(Cluster)) eq strip(upcase(Variable)) then Variable = ClosestCluster;
102367    +run;
102368    +data &outnode(keep=NODEID TYPE LABEL);
102369    +    set &indata;
102370    +    length TYPE $16;
102371    +    rename Variable = NODEID;
102372    +    label  Variable= "%sysfunc(sasmsg(sashelp.dmine, rpt_varclus_label_nodeidvar, noquote))";
102373    +    if strip(upcase(Cluster)) eq strip(upcase(Variable))
102374    +    then  TYPE = "CLUSTER";
102375    +    else  TYPE="VARIABLE";
102376    +    label TYPE = "%sysfunc(sasmsg(sashelp.dmine, rpt_varclus_label_nodetype, noquote))";
102377    +run;
102378    +quit;
102379    +%mend MakeClusConstellData;
102383    +%macro MakeClusConstellData(indata=, outlink=, outnode=);
102385    +data &outlink(drop = Selected);
102386    +     set &indata;
102387    +     LINKID = _N_;
102388    +     label LINKID = "%sysfunc(sasmsg(sashelp.dmine, rpt_varclus_label_linkid,  noquote))";
102389    +     if strip(upcase(Cluster)) eq strip(upcase(Variable)) then Variable = ClosestCluster;
102390    +run;
102391    +data &outnode(keep=NODEID TYPE LABEL);
102392    +    set &indata;
102393    +    length TYPE $16;
102394    +    rename Variable = NODEID;
102395    +    label  Variable= "%sysfunc(sasmsg(sashelp.dmine, rpt_varclus_label_nodeidvar, noquote))";
102396    +    if strip(upcase(Cluster)) eq strip(upcase(Variable))
102397    +    then  TYPE = "CLUSTER";
102398    +    else  TYPE="VARIABLE";
102399    +    label TYPE = "%sysfunc(sasmsg(sashelp.dmine, rpt_varclus_label_nodetype, noquote))";
102400    +run;
102401    +quit;
102402    +%mend MakeClusConstellData;
102405    +/*--- This will work only when inds is not a view data -------
102407    +%macro getNVarNObs(inds=, nvar=, nobs=);
102409    +    %global &nvar;
102410    +    %global &nobs;
102411    +    data _null_;
102412    +         dsid = open("&inds");
102413    +         nv = attrn(dsid, 'NVAR');
102414    +         no = attrn(dsid, 'NOBS');
102415    +         dsid = close(dsid);
102416    +         call symput("&nvar", nv);
102417    +         call symput("&nobs", no);
102418    +    run;
102419    +    quit;
102420    +%mend  getNVarNObs;
102422    ++---------------------------------------------------------------*/
102425    +%macro getNVar(inds=, nvar=);
102426    +    %global &nvar;
102427    +    data _null_;
102428    +         dsid = open("&inds");
102429    +         nv = attrn(dsid, 'NVAR');
102430    +         dsid = close(dsid);
102431    +         call symput("&nvar", nv);
102432    +    run;
102433    +    quit;
102434    +%mend  getNVar;
102438    +%macro getNObs(inds=, nobs=);
102439    +    %global &nobs;
102440    +    data _null_;
102441    +        set &inds end=eof;
102442    +        if eof then call symput("&nobs", _N_);
102443    +    run;
102444    +    quit;
102445    +%mend  getNObs;
102447    +%Macro CreateVarclusMeta(trainnum=);
102448    +   %EM_GETNAME(KEY=VARCLUSMETA, TYPE=DATA);
102449    +    data &EM_USER_VARCLUSMETA;
102450    +         length TrainNum 8.;
102451    +         length NewTrain $8;
102452    +         length NGCluster 8.;
102453    +         length ExportedComp $16;
102454    +         length HideVariable $8;
102455    +         TrainNum = &trainnum;
102456    +         NewTrain = "Y";
102457    +         ExportedComp = "&EM_PROPERTY_EXPORTEDCOMP";
102458    +         HideVariable = "&EM_PROPERTY_HIDEVARIABLE";
102459    +         NGCluster = 0; /* zero means no twostage */
102460    +   run;
102461    +   quit;
102462    +%mend CreateVarclusMeta;
NOTE: %INCLUDE (level 1) ending.
MPRINT(MAIN):   filename temp catalog 'sashelp.emexpl.variableclustering_macros2.source';
NOTE: %INCLUDE (level 1) file TEMP is file SASHELP.EMEXPL.VARIABLECLUSTERING_MACROS2.SOURCE.
102464    +%macro MakeInterClusCorrData(indata=, outdata=, ncluster=, globalclusid=, RSquare=N, makeplotds=N, plotds=);
102465    +    data &outdata(drop= _NCL_  _TYPE_);
102466    +       set &indata;
102467    +       if ^(strip(_NCL_) eq &ncluster and strip(_TYPE_) eq 'CCORR') then delete;
102468    +       %if &globalclusid ne %then %do;
102469    +       _NAME_ = "GC&globalclusid._"||upcase(_NAME_);
102470    +       rename _NAME_ = Cluster;
102471    +       %end;
102472    +       %else %do;
102473    +        _NAME_ = upcase(_NAME_);
102474    +       rename _NAME_ = Cluster;
102475    +       %end;
102476    +       label _NAME_ = "%sysfunc(sasmsg(sashelp.dmine, rpt_varclus_label_clustername,  noquote))";
102477    +    run;
102478    +    data corr_tmp;
102479    +        set &outdata;
102480    +    run;
102482    +    %let dsid = %sysfunc(open(work.corr_tmp));
102483    +    %let nclus2= %eval(&ncluster+1);
102484    +    data &outdata;
102485    +         set &outdata;
102486    +          %do i = 2 %to &nclus2;
102487    +          %let i_1 = %eval(&i-1);
102488    +            %let _name = %sysfunc(varname(&dsid, &i));
102489    +            %if &globalclusid ne %then
102490    +                %do; %let _newName = GC&globalclusid._CLUS&i_1;
102491    +                     rename &_name = &_newName;
102492    +                     *label &_name ="GC &globalclusid : Cluster &i_1";
102493    +                     label &_name = "%sysfunc(sasmsg(sashelp.dmine, rpt_varclus_label_gc_clusternum, noquote,  &globalclusid, &i_1))";
102494    +                %end;
102495    +            %else
102496    +                %do; %let _newName = CLUS&i_1;
102497    +                     rename &_name = &_newName;
102498    +                     *label &_name ="Cluster &i_1";
102499    +                     label &_name = "%sysfunc(sasmsg(sashelp.dmine, rpt_varclus_label_clusternum, noquote,  &i_1))";
102500    +                %end;
102501    +          %end;
102502    +          keep Cluster
102503    +          %do i = 2 %to &nclus2;
102504    +                %let _name = %sysfunc(varname(&dsid, &i));
102505    +                &_name
102506    +          %end;
102507    +          ;
102508    +    %let dsid= %sysfunc(close(&dsid));
102509    +     run;
102510    +     quit;
102512    +    %if &RSquare eq Y %then %do;
102514    +       data corr_tmp;
102515    +        set &outdata;
102516    +     run;
102518    +     data &outdata;
102519    +          set &outdata;
102520    +          %let dsid = %sysfunc(open(work.corr_tmp));
102521    +          %let nvar = %sysfunc(attrn(&dsid, NVAR));
102522    +          %do i = 2 %to &nvar;
102523    +            %let _name = %sysfunc(varname(&dsid, &i));
102524    +            %let _name_md = &_name.**2;
102525    +                &_name = &_name_md;
102526    +          %end;
102527    +      %let dsid= %sysfunc(close(&dsid));
102528    +      run;
102529    +    %end;
102531    +    %if &makeplotds eq Y %then %do;
102532    +     proc transpose data = &outdata
102533    +          out=&plotds(drop=_LABEL_ rename=(_NAME_ = Y Cluster=X Col1= Correlation));
102534    +          by cluster;
102535    +     run;
102536    +     data &plotds;
102537    +          set  &plotds;
102538    +          label x="%sysfunc(sasmsg(sashelp.dmine, rpt_varclus_label_cluster, noquote))";
102539    +          label Y="%sysfunc(sasmsg(sashelp.dmine, rpt_varclus_label_cluster, noquote))";
102540    +          label  Correlation="%sysfunc(sasmsg(sashelp.dmine, rpt_correlation_vlabel, noquote))";
102541    +     run;
102542    +     %end;
102543    +     proc datasets lib = work nolist;
102544    +           delete corr_tmp;
102545    +     run;
102546    +     quit;
102547    +%mend MakeInterClusCorrData;
102549    +%macro MakeOwnRSquare(indata=, outdata=, ncluster=, globalclusid=);
102550    +    data _tmpds(drop= _NCL_);
102551    +       set &indata;
102552    +       if ^(strip(_NCL_) eq &ncluster and strip(_TYPE_) in ('GROUP','RSQUARED')) then delete;
102553    +       %if &globalclusid ne %then %do;
102554    +           _NAME_ = "GC&globalclusid.";
102555    +       rename _NAME_ = Cluster;
102556    +       %end;
102557    +       %else %do;
102558    +        _NAME_ = "CLUS";
102559    +        rename _NAME_ = Cluster;
102560    +       %end;
102561    +       label _NAME_ = "%sysfunc(sasmsg(sashelp.dmine, rpt_varclus_label_clustername,  noquote))";
102562    +    run;
102563    +    proc transpose data =_tmpds out =&outdata;
102564    +    run;
102566    +    data &outdata(drop=COL1);
102567    +        %if &globalclusid ne %then %do;
102568    +        length GCluster $16;
102569    +        %end;
102570    +        length Cluster $32;
102571    +        length _NAME_ $32;
102572    +         set &outdata;
102573    +         _NAME_ = upcase(_NAME_);
102574    +         rename _NAME_=Variable;
102575    +         *label _NAME_="Variable";
102576    +         label _NAME_ = "%sysfunc(sasmsg(sashelp.dmine, rpt_varclus_label_variable, noquote))" ;
102577    +         label Cluster = "%sysfunc(sasmsg(sashelp.dmine, rpt_varclus_label_cluster, noquote))" ;
102578    +         label GCluster = "%sysfunc(sasmsg(sashelp.dmine, rpt_varclus_label_gcluster, noquote))" ;
102580    +         %if &globalclusid ne %then %do;
102581    +          GCluster = "GC&globalclusid";
102582    +          Cluster = "GC&globalclusid._CLUS"||strip(COL1);
102583    +         %end;
102584    +         %else %do;
102585    +         Cluster = "CLUS"||strip(COL1);
102586    +        %end;
102587    +         rename COL2 = RSqWithOwnClusComp;
102588    +         *label COL2 = "R-Square With Own Cluster Component";
102589    +         label COL2 = "%sysfunc(sasmsg(sashelp.dmine, rpt_varclus_label_ownrsq, noquote))" ;
102591    +   run;
102592    +   proc sort data =&outdata;
102593    +        by Cluster RSqWithOwnClusComp;
102594    +   run;
102595    +   proc datasets lib = work nolist;
102596    +           delete _tmpds;
102597    +   run;
102598    +   quit;
102599    +%mend MakeOwnRSquare;
102601    +%macro MakeClusStructCorrData(indata=, outdata=, globalclusid=, ncluster=, Rsquare=N);
102602    +    data &outdata(drop= _NCL_  _TYPE_);
102603    +       %if &globalclusid ne %then %do;
102604    +        length GCluster $16;
102605    +        %end;
102606    +       set &indata;
102607    +       if ^(strip(_NCL_) eq &ncluster and strip(_TYPE_) eq 'STRUCTUR') then delete;
102608    +       %if &globalclusid ne %then %do;
102609    +         GCluster = "GC&globalclusid";
102610    +         _NAME_ = "GC&globalclusid._"||upcase(_NAME_);
102611    +         rename _NAME_ = Cluster;
102612    +         label _NAME_ = "%sysfunc(sasmsg(sashelp.dmine, rpt_varclus_label_cluster, noquote))" ;
102613    +         label GCluster = "%sysfunc(sasmsg(sashelp.dmine, rpt_varclus_label_gcluster, noquote))" ;
102615    +       %end;
102616    +       %else %do;
102617    +         _NAME_ = upcase(_NAME_);
102618    +         rename _NAME_ = Cluster;
102619    +         label _NAME_ = "%sysfunc(sasmsg(sashelp.dmine, rpt_varclus_label_cluster, noquote))" ;
102620    +         label GCluster = "%sysfunc(sasmsg(sashelp.dmine, rpt_varclus_label_gcluster, noquote))" ;
102622    +       %end;
102623    +     run;
102624    +    %if &RSquare eq Y %then %do;
102625    +     data corr_tmp;
102626    +          set &outdata;
102627    +     run;
102628    +     %let istart = 2;
102629    +     %if &globalclusid ne %then %let istart = 3;
102630    +     data &outdata;
102631    +          set &outdata;
102632    +          %let dsid = %sysfunc(open(work.corr_tmp));
102633    +          %let nvar = %sysfunc(attrn(&dsid, NVAR));
102634    +          %do i =&istart %to &nvar;
102635    +            %let _name = %sysfunc(varname(&dsid, &i));
102636    +            %let _name_md = &_name.**2;
102637    +                &_name = &_name_md;
102638    +          %end;
102639    +      %let dsid= %sysfunc(close(&dsid));
102640    +      run;
102641    +      proc datasets lib = work nolist;
102642    +           delete corr_tmp;
102643    +      run;
102644    +    %end;
102645    +     quit;
102646    +%mend MakeClusStructCorrData;
102648    +/*
102649    +%MakeClusStructCorrData(indata=playpen._outstat, outdata=_structrsq , ncluster=7, Rsquare=Y);
102650    +*/
102652    +%macro FindNextClosestClusByVar(indata=, outdata=, globalclusid=, ncluster=);
102654    +     /* The indata should be the outdata
102655    +        from %MakeClusStructCorrData(indata=, outdata=, ); */
102657    +     proc sort data =&indata out=_tmpclusRsq;
102658    +     by cluster;
102659    +     run;
102661    +     proc transpose data =_tmpclusRsq out=_tmpclusRsq;
102662    +      by cluster;
102663    +     run;
102665    +     proc sort data=_tmpclusRsq;
102666    +        by _NAME_ COL1;
102667    +     run;
102669    +     data _tmpclusRsq;
102670    +         length _NAME_ $32;
102671    +         set _tmpclusRsq; by _NAME_;
102672    +          _NAME_ = upcase(_NAME_);
102673    +          %if &ncluster ne 1 %then %do;
102674    +             if last._NAME_ then delete;
102675    +          %end;
102676    +          %else %do;
102677    +             COL1 = 0;
102678    +          %end;
102679    +     run;
102680    +     /* need to sort again */
102681    +     proc sort data=_tmpclusRsq;
102682    +        by _NAME_ COL1;
102683    +     run;
102685    +     data &outdata;
102686    +         set _tmpclusRsq; by _NAME_;
102687    +         Cluster = upcase(Cluster);
102688    +         if last._NAME_ then output;
102689    +         *label  COL1 = 'R-Sqaure with Next Cluster Component';
102690    +         label COL1 = "%sysfunc(sasmsg(sashelp.dmine, rpt_varclus_label_nextrsq, noquote))" ;
102691    +         rename COL1 = RSqWithNextClusComp;
102692    +         Cluster = upcase(Cluster);
102693    +         rename Cluster = ClosestCluster;
102694    +         *label  Cluster = "Next Closest Cluster";
102695    +         label Cluster = "%sysfunc(sasmsg(sashelp.dmine, rpt_varclus_label_nextclus, noquote))" ;
102696    +         rename _NAME_ = Variable;
102697    +         label  _NAME_ = "%sysfunc(sasmsg(sashelp.dmine, rpt_varclus_label_variable, noquote))" ;
102698    +    run;
102701    +    %if &globalclusid ne %then %do;
102702    +    data &outdata;
102703    +       length GCluster $16;
102704    +       set &outdata;
102705    +       GCluster = "GC&globalclusid";
102706    +       run;
102707    +    %end;
102708    +    proc datasets lib = work nolist;
102709    +           delete _tmpclusRsq;
102710    +    run;
102711    +    quit;
102712    +%mend FindNextClosestClusByVar;
102715    +%macro FindNextClosestClusByCluster(indata=, outdata=, globalclusid=, ncluster=);
102716    +     /* The indata should be the outdata from %MakeInterClusCorrData(indata=, outdata=, ); */
102717    +     proc sort data =&indata out=_tmpclusRsq;
102718    +     by cluster;
102719    +     run;
102720    +     proc transpose data =_tmpclusRsq out=_tmpclusRsq;
102721    +     by cluster;
102722    +     run;
102723    +     proc sort data=_tmpclusRsq;
102724    +        by _NAME_ col1;
102725    +     run;
102726    +     data _tmpclusRsq;
102727    +         length _NAME_ $32;
102728    +         set _tmpclusRsq; by _NAME_;
102729    +          _NAME_ = upcase(_NAME_);
102730    +          %if &ncluster ne 1 %then %do;
102731    +             if last._NAME_ then delete;
102732    +          %end;
102733    +          %else %do;
102734    +             COL1 = 0;
102735    +          %end;
102736    +     run;
102737    +     data &outdata;
102738    +         set _tmpclusRsq; by _NAME_;
102739    +         Cluster = upcase(Cluster);
102740    +         if last._NAME_ then output;
102741    +         *label  COL1 = 'R-Sqaure with Next Cluster Component';
102742    +         label COL1 = "%sysfunc(sasmsg(sashelp.dmine, rpt_varclus_label_nextrsq, noquote))" ;
102743    +         rename COL1 = RSqWithNextClusComp;
102744    +         Cluster = upcase(Cluster);
102745    +         rename Cluster = ClosestCluster;
102746    +         *label  Cluster = "Next Closest Cluster";
102747    +         label Cluster = "%sysfunc(sasmsg(sashelp.dmine, rpt_varclus_label_nextclus, noquote))" ;
102748    +         rename _NAME_ = Variable;
102749    +         *label  _NAME_ = "Variable";
102750    +         label  _NAME_ = "%sysfunc(sasmsg(sashelp.dmine, rpt_varclus_label_variable, noquote))" ;
102752    +    run;
102753    +    %if &globalclusid ne %then %do;
102754    +    data &outdata;
102755    +       length GCluster $16;
102756    +       set &outdata;
102757    +       GCluster = "GC&globalclusid";
102758    +       run;
102759    +    %end;
102761    +    proc datasets lib = work nolist;
102762    +           delete _tmpclusRsq;
102763    +    run;
102765    +    quit;
102766    +%mend FindNextClosestClusByCluster;
102768    +%macro MakeVarClusResultTable(indata1=, indata2=, indata3=, outdata=, globalclusid=, ncluster=, selectedcomp=clustercomp);
102769    +/*----
102770    +  indata1=_ownRsq, indata2=_nextVarRsq, indata3=_nextClusRSq,
102771    +-----------*/
102773    +proc sort data =&indata1;
102774    +    by Variable;
102775    +run;
102776    +proc sort data =&indata2;
102777    +    by Variable;
102778    +run;
102779    +data &outdata;
102780    +    merge &indata1 &indata2;
102781    +    by Variable;
102782    +    length Type $16;
102783    +    Type = 'Variable';
102784    +    *label Type ='Type';
102785    +    label Type = "%sysfunc(sasmsg(sashelp.dmine, rpt_varclus_label_type, noquote))" ;
102786    +run;
102789    +data &indata3;
102790    +    set  &indata3 ;
102791    +    length RSqWithOwnClusComp 8.;
102792    +    Cluster = Variable;
102793    +    RSqWithOwnClusComp = 1;
102794    +    *label RSqWithOwnClusComp = "R-Square With Own Cluster Component";
102795    +    label RSqWithOwnClusComp = "%sysfunc(sasmsg(sashelp.dmine, rpt_varclus_label_ownrsq, noquote))" ;
102796    +    length Type $16;
102797    +    Type = 'ClusterComp';
102798    +    label Type = "%sysfunc(sasmsg(sashelp.dmine, rpt_varclus_label_type, noquote))" ;
102800    +;
102801    +run;
102803    +proc sort data=&outdata;
102804    +    by Cluster;
102805    +run;
102806    +proc sort data =&indata3;
102807    +    by Cluster;
102808    +run;
102810    +data &outdata;
102811    +     set &outdata &indata3;
102812    +     by Cluster;
102813    +run;
102816    +/* Create the Selected variable with all YES */
102818    +data &outdata;
102819    +     set &outdata;
102820    +     length RsqRatio 8.;
102821    +     length Selected $8;
102822    +     *label RSqRatio = "1-R**2 Ratio";
102823    +     label RSqRatio =  "%sysfunc(sasmsg(sashelp.dmine, rpt_varclus_label_oneminusrsq, noquote))" ;
102824    +     *label Selected = "Variable Selected";
102825    +     label Selected = "%sysfunc(sasmsg(sashelp.dmine, rpt_varclus_label_varselected, noquote))" ;
102826    +     RsqRatio = (1-RSqWithOwnClusComp)/(1-RSqWithNextClusComp);
102827    +     Selected ='YES';
102828    +     rename _LABEL_ = Label;
102829    +     label _LABEL_ =  "%sysfunc(sasmsg(sashelp.dmine, rpt_varclus_label_label, noquote))" ;
102830    +run;
102833    +/*----  Selected = Y/N will be assigened at the %score                   -------+
102834    +        Just create the Selected variable with all YES at the step above
102835    + +------------------------------------------------------------------------------+
102837    +proc sort data=&outdata;
102838    +    by Cluster RsqRatio;
102839    +run;
102841    +%if &selectedcomp eq CLUSTERCOMP %then %do;
102842    +data &outdata;
102843    +     set &outdata; by Cluster;
102844    +     length Selected $8;
102845    +     label Selected = "Variable Selected";
102846    +     if  first.Cluster then Selected ='Yes';
102847    +     else Selected = 'No';
102848    +    run;
102849    +%end;
102850    +%else %do;
102851    +data &outdata(drop = _var _varchange);
102852    +     set &outdata; retain _var 0; by Cluster;
102853    +     length Selected $8;
102854    +     label Selected = "Variable Selected";
102855    +     if first.Cluster then  _varchange = 0;
102856    +     else _varchange =1;
102857    +     if _var ne _varchange then  Selected  = 'Yes';
102858    +     else Selected = 'No';
102859    +     if last.cluster then  _var = 0;
102860    +     else _var = _varchange;
102861    +run;
102862    +%end;
102864    +--------------------------------------------------------------*/
102866    +quit;
102867    +%mend MakeVarClusResultTable;
102869    +%Macro MakePlotDataFromCorrTable(indata=, outdata=, globalclusid=);
102870    +     proc sort data =&indata;
102871    +        by cluster;
102872    +     run;
102873    +     proc transpose data =&indata
102874    +          out=&outdata(drop=_LABEL_ rename=(_NAME_ = Y Cluster=X Col1= Correlation));
102875    +          by cluster;
102876    +     run;
102877    +     data &outdata;
102878    +          set  &outdata;
102879    +          label x= "%sysfunc(sasmsg(sashelp.dmine, rpt_varclus_label_cluster, noquote))" ;
102880    +          label Y= "%sysfunc(sasmsg(sashelp.dmine, rpt_varclus_label_cluster, noquote))" ;
102881    +          label Correlation = "%sysfunc(sasmsg(sashelp.dmine, rpt_correlation_vlabel, noquote))" ;
102882    +     run;
102883    +     %if &globalclusid ne %then %do;
102884    +     data &outdata;
102885    +          Length GCluster $16;
102886    +          label GCluster = "%sysfunc(sasmsg(sashelp.dmine, rpt_varclus_label_gcluster, noquote))" ;
102887    +          set  &outdata;
102888    +          GCluster ="GC&globalclusid.";
102889    +          run;
102890    +     %end;
102892    +%Mend MakePlotDataFromCorrTable;
102895    +%macro MakeCorrelation(indata=,
102896    +                       outstat=_tmpoutstat,
102897    +                       corrmatrix=N,
102898    +                       outcorr=_tmpoutcorr,
102899    +                       includeclassvar=N,
102900    +                       target=,
102901    +                       freq=,
102902    +                       weight=);
102903    +   %if &target eq  %then %do;
102905    +       proc varclus data=&indata outstat=&outstat hi maxclusters=1 noprint;
102906    +            var %EM_INTERVAL_INPUT %EM_INTERVAL_REJECTED
102907    +       %if &includeclassvar eq Y %then %do;
102908    +          %let dsid = %sysfunc(open(&EM_USER_OUTDUMMY));
102909    +          %let nvar = %sysfunc(attrn(&dsid, NVAR));
102910    +          %do i = 2 %to &nvar;
102911    +          %let varname = %sysfunc(varname(&dsid, &i));
102912    +          &varname
102913    +          %end;
102914    +       %end;
102915    +       ;
102916    +      %if &freq ne  %then %do;
102917    +          freq &freq;
102918    +      %end;
102919    +      %if &weight ne  %then %do;
102920    +          weight &weight;
102921    +      %end;
102923    +      run;
102924    +      %if &corrmatrix eq Y %then %do;
102925    +      data  &outcorr (drop = _NCL_ _TYPE_);
102926    +           set  &outstat ;
102927    +           if _TYPE_ ='CORR' then output;
102928    +      run;
102929    +      %end;
102930    +    %end;
102931    +    %else %do;
102932    +       proc corr data=&indata outp=&outstat noprint;
102933    +            var
102934    +       %let dsid = %sysfunc(open(&indata));
102935    +       %let nvar = %sysfunc(attrn(&dsid, NVAR));
102936    +          %do i = 1 %to &nvar;
102937    +              %let _name = %sysfunc(varname(&dsid, &i));
102938    +              %if &_name ne &target %then;
102939    +              &_name
102940    +           %end;
102941    +        %let dsid= %sysfunc(close(&dsid));
102942    +        ;
102943    +        with &target;
102944    +        run;
102945    +    %end;
102946    +    quit;
102947    +%mend MakeCorrelation;
102950    +%macro MakeCorrelationDistance(indata=,
102951    +                               outdata=,
102952    +                               rsquare = N
102953    +                               );
102954    +    data corr_tmp;
102955    +        set &indata;
102956    +        if _N_ = 1 then do;
102957    +           output;
102958    +           stop;
102959    +         end;
102960    +    run;
102961    +    %if &outdata ne  %then %let  _outdata = &outdata;
102962    +    %else %let _outdata = &indata;
102964    +    data &_outdata;
102965    +         set &indata;
102967    +         %let dsid = %sysfunc(open(work.corr_tmp));
102968    +         %let nvar = %sysfunc(attrn(&dsid, NVAR));
102969    +          %do i = 2 %to &nvar;
102970    +              %let _name = %sysfunc(varname(&dsid, &i));
102971    +              %if &rsquare eq Y %then %let _name_md = &_name.**2;
102972    +              %else  %let _name_md = &_name;
102973    +              &_name = 1- &_name_md;
102974    +          %end;
102975    +      %let dsid= %sysfunc(close(&dsid));
102976    +      run;
102977    +      proc datasets lib = work nolist;
102978    +           delete corr_tmp;
102979    +      run;
102980    +      quit;
102981    +  %mend MakeCorrelationDistance;
102984    +%macro UpdateOutStatCorrToDistance(indata=, /* indata should be a outstat from proc varclus */
102985    +                                   rsquare = N
102986    +                                   );
102987    +    data corr_tmp;
102988    +        set &indata;
102989    +    run;
102990    +    proc sql noprint;
102991    +           update &indata
102992    +           set
102993    +     %let dsid = %sysfunc(open(work.corr_tmp));
102994    +     %let nvar = %sysfunc(attrn(&dsid, NVAR));
102995    +          %do i = 4 %to &nvar;
102996    +          %let _name = %sysfunc(varname(&dsid, &i));
102997    +             %if &rsquare eq Y %then %let _name_md = &_name.**2;
102998    +            %else  %let _name_md = &_name;
102999    +            %if &i < &nvar %then %do;
103000    +               &_name = 1- &_name_md ,
103001    +            %end;
103002    +            %else %do;
103003    +               &_name = &_name_md where _TYPE_ eq 'CORR' ;
103004    +            %end;
103005    +          %end;
103006    +      %let dsid= %sysfunc(close(&dsid));
103008    +      select * from &indata;
103009    +      run;
103010    +     data &indata( drop = _NCL_);
103011    +           set &indata;
103012    +           if _TYPE_ not in ('CORR', 'STD', 'N', 'MEAN') then delete;
103013    +           if _TYPE_ ='CORR' then _TYPE_ ='DISTANCE';
103014    +     run;
103015    +     data &indata(DROP = _NCL_);
103016    +           set &indata;
103017    +           if _TYPE_ = 'CORR' then _TYPE_ ='DISTANCE';
103018    +           if _TYPE_ not in ('DISTANCE', 'N', 'STD', 'MEAN') then delete;
103019    +           rename _NAME_ = _VAR_;
103020    +     run;
103021    +     proc datasets lib = work nolist;
103022    +           delete corr_tmp;
103023    +     run;
103024    +     quit;
103025    + %mend UpdateOutStatCorrToDistance;
103028    +%macro HierClusWithCorr(indata= ,
103029    +                        ncluster=,
103030    +                        method = Ward,
103031    +                        outtree = _outtree,
103032    +                        idvar =_VAR_,
103033    +                        outdata=,
103034    +                        rescore = N,
103035    +                        newncluster=
103036    +                        );
103037    +      %global &newncluster;
103038    +      %if &rescore ne Y %then %do;
103039    +      proc cluster data=&indata(type=Distance where=(upcase(strip(_TYPE_)) = "DISTANCE"))
103040    +                   method=&method outtree=&outtree noprint;
103041    +           id &idvar;
103042    +      run;
103043    +      %end;
103044    +      proc tree data=&outtree nclusters = &ncluster out=&outdata noprint;
103045    +      run;
103046    +      /* ----- Check some variables like CL1, CL5..., remove them ----*/
103047    +      proc contents data =&indata out=_outcontent(keep=NAME) noprint;
103048    +      run;
103049    +      data _outcontent;
103050    +          set _outcontent;
103051    +          if NAME in ('_TYPE_' , '_VAR_') then delete;
103052    +          index = 1;
103053    +          rename NAME = _NAME_;
103054    +      run;
103055    +      proc sort data=_outcontent;
103056    +          by _NAME_;
103057    +      run;
103058    +      proc sort data =&outdata;
103059    +           by _NAME_;
103060    +      run;
103061    +      data &outdata(drop=index);
103062    +          merge &outdata _outcontent;
103063    +          by _NAME_;
103064    +          if index = . then delete;
103065    +      run;
103066    +      /*-----------------------------------------------------------*/
103067    +      data &outdata;
103068    +           length CLUSNAME $16;
103069    +           set &outdata;
103070    +           if CLUSTER > &ncluster then delete;
103071    +           CLUSNAME='GC'||strip(CLUSTER);
103072    +           *label CLUSNAME = "Cluster Name";
103073    +           label CLUSNAME  = "%sysfunc(sasmsg(sashelp.dmine, rpt_varclus_label_clustername, noquote))" ;
103074    +           rename _NAME_ = VARIABLE ;
103075    +           *label _NAME_ = "Variable";
103076    +           *label CLUSTER = "Cluster";
103077    +           label _NAME_ ="%sysfunc(sasmsg(sashelp.dmine, rpt_varclus_label_variable, noquote))" ;
103078    +           label CLUSTER ="%sysfunc(sasmsg(sashelp.dmine, rpt_varclus_label_cluster, noquote))" ;
103079    +      run;
103080    +      proc sort data=&outdata out=&outdata;
103081    +           by CLUSTER;
103082    +      run;
103083    +      proc means data =&outdata noprint;
103084    +           output out=_meanout;
103085    +      run;
103086    +      data _null_;
103087    +            set _meanout;
103088    +            if strip(_STAT_) eq 'MAX' then do;
103089    +            call symput("&newncluster", CLUSTER);
103090    +            stop;
103091    +            end;
103092    +      run;
103094    +      proc datasets lib = work nolist;
103095    +           delete _outcontent _meanout;
103096    +      run;
103097    +      quit;
103098    +%mend  HierClusWithCorr;
103100    +%macro CreateScoreCode2(indata=, ncluscomp=, globalclusid=, fileref=);
103102    +     data _tmpindata;
103103    +          set &indata;
103104    +          if (_TYPE_ in ('SCORE' 'MEAN' 'STD') and _NCL_ = &ncluscomp ) or (_TYPE_ in ('MEAN' 'STD'));
103105    +          if _TYPE_ = 'MEAN' then _NAME_='MEAN';
103106    +          if _TYPE_ = 'STD' then _NAME_='STD';
103107    +          if _TYPE_ = 'SCORE' then _NAME_=upcase("GC&globalclusid._"||_NAME_);
103108    +          DROP _TYPE_ _NCL_;
103109    +     run;
103111    +     filename _file_  "&fileRef";
103113    +     data _null_;
103114    +        FILE _file_ MOD;
103115    +        put ' ';
103116    +        put "/*-------------------------------------------------*/";
103117    +        put '/* ' "%sysfunc(sasmsg(sashelp.dmine, rpt_varclus_score_title_gclus, noquote, &globalclusid))" '*/';
103118    +        put "/*-------------------------------------------------*/";
103119    +        put ' ';
103120    +        %let dsid = %sysfunc(open(work._tmpindata));
103122    +        %let nvar = %sysfunc(attrn(&dsid, NVAR));
103123    +        %let vn_name =%sysfunc(varnum(&dsid, _NAME_));
103124    +        %let k = 1;
103125    +        %do %while(^%sysfunc(fetch(&dsid)));
103126    +               %let _name = %sysfunc(getvarc(&dsid, &vn_name));
103127    +               %if &k > 2 %then %do;
103128    +                %let cn = %eval(&k-2);
103129    +                 put "&_name = 0 ; /*---" "%sysfunc(sasmsg(sashelp.dmine, rpt_varclus_score_gcluscompnum, noquote, &globalclusid, &cn))" "------ */";
103130    +                %end;
103131    +                %let k = %eval(&k+1);
103133    +        %end;
103134    +        %let rc = %sysfunc(rewind(&dsid));
103136    +        %do j= 2 %to &nvar;
103137    +            %let _varname = %sysfunc(varname(&dsid, &j));
103138    +            %do %while(^%sysfunc(fetch(&dsid)));
103139    +                %let _name = %sysfunc(getvarc(&dsid, &vn_name));
103140    +                %if &_name = MEAN %then
103141    +                %let _mean = %sysfunc(getvarn(&dsid, &j));
103142    +                %else %if &_name = STD %then
103143    +                %let _std = %sysfunc(getvarn(&dsid, &j));
103144    +                %else %do;
103145    +                      %let coeff =  %sysfunc(getvarn(&dsid, &j));
103146    +                      %let abscoeff = %sysfunc(abs(&coeff));
103147    +                          %if &abscoeff >  0 %then %do;
103148    +                       put "&_name = &_name+&coeff * (&_varname - &_mean)/&_std;";
103149    +                           %end;
103150    +                 %end;
103151    +             %end;
103152    +             %let rc = %sysfunc(rewind(&dsid));
103153    +         %end;
103155    +        %let dsid= %sysfunc(close(&dsid));
103157    +     run;
103159    +     filename _file_;
103160    +     proc datasets lib = work nolist;
103161    +           delete _tmpindata;
103162    +     run;
103163    +     quit;
103164    +%mend CreateScoreCode2;
103167    +%macro MakeDeltaCode2(groupds=,deltacodefile=);
103169    +     /*--- Build Code to Modify Metadata ---*/
103170    +     filename X "&deltacodefile";
103171    +     data _null_;
103172    +        FILE X;
103173    +        set &groupds end=eof;
103174    +        if _N_=1 then do;
103175    +           %if &EM_PROPERTY_INCLUDECLASSVAR eq Y %then %do;
103176    +            put "if upcase(strip(ROLE)) ='INPUT' and upcase(strip(LEVEL)) ^='INTERVAL' then ROLE ='REJECTED' ;";
103177    +           %end;
103178    +           put "if upcase(strip(ROLE))='INPUT' and upcase(strip(LEVEL))='INTERVAL' then do;";
103179    +           put "if upcase(strip(NAME)) in (";
103180    +        end;
103181    +        if Strip(upcase(Selected)) eq 'YES' then do;
103182    +           string = '"'!!trim(left(VARIABLE))!!'"';
103183    +           put string;
103184    +        end;
103185    +        if eof then do;
103186    +           put ') then ROLE="INPUT";';
103187    +           put 'else ROLE="REJECTED";';
103188    +           put 'end;';
103190    +           %if %upcase(&EM_PROPERTY_HIDEVARIABLE) eq Y %then %do;
103191    +             put 'if upcase(strip(ROLE)) = "REJECTED" then delete ;';
103192    +           %end;
103193    +        end;
103194    +     run;
103195    +     quit;
103197    +     filename X;
103198    +     quit;
103199    +%mend MakeDeltaCode2;
103201    +%macro getInitialGClusterNumber(indata=, ninput=, ndummy=0, div=100, ngc=);
103202    +  %global &ngc;
103203    +  data _null_;
103204    +  %if &indata ne %then %do;
103205    +      %let dsid = %sysfunc(open(&indata));
103206    +           %let nvar = %sysfunc(attrn(&dsid, NVAR));
103207    +      %let dsid = %sysfunc(close(&dsid));
103208    +  %end;
103209    +  %else %do;
103210    +       %let nvar = %eval(&ninput+&ndummy); ;
103211    +  %end;
103212    +  %let numgc = %eval(&nvar/&div+2);
103213    +  %let &ngc = &numgc;
103214    +   run;
103215    +  quit;
103216    +%mend getInitialGClusterNumber;
103219    +%macro MakeGobalConstellData(indata=, outlink=, outnode=);
103220    +data &outlink(drop = Selected);
103221    +     set &indata;
103222    +     LINKID = _N_;
103223    +     label LINKID = "%sysfunc(sasmsg(sashelp.dmine, rpt_varclus_label_linkid, noquote))" ;
103224    +run;
103225    +data &outnode(keep=NODEID TYPE LABEL);
103226    +    set &indata;
103227    +    length TYPE $16;
103228    +    rename VARIABLE = NODEID;
103229    +    *label  CLUSNAME="Node ID";
103230    +    label CLUSNAME= "%sysfunc(sasmsg(sashelp.dmine, rpt_varclus_label_nodeidvar, noquote))" ;
103231    +    TYPE = "VARIABLE";
103232    +    *label TYPE = "Node Type";
103233    +    label TYPE =  "%sysfunc(sasmsg(sashelp.dmine, rpt_varclus_label_nodetype, noquote))" ;
103234    +    run;
103235    +data _tmp(keep=NODEID TYPE LABEL);
103236    +    set &indata;
103237    +    length TYPE $16;
103238    +    rename CLUSNAME = NODEID;
103239    +    label  CLUSNAME= "%sysfunc(sasmsg(sashelp.dmine, rpt_varclus_label_nodeidvar, noquote))" ;
103240    +    TYPE = "GCLUSTER";
103241    +    label TYPE = "%sysfunc(sasmsg(sashelp.dmine, rpt_varclus_label_nodetype, noquote))" ;
103242    +    run;
103243    +proc sort data=_tmp;
103244    +    by NODEID;
103245    +run;
103246    +data _tmp;
103247    +    set _tmp; by NODEID;
103248    +    if first.NODEID then output;
103249    +run;
103250    +proc sort data=&outnode;
103251    +    by NODEID;
103252    +run;
103253    +data  &outnode;
103254    +    set _tmp &outnode;
103255    +run;
103256    +proc datasets lib = work nolist;
103257    +     delete _tmp;
103258    +run;
103259    +quit;
103260    +%mend MakeGobalConstellData;
103262    +/* Make contellation plot data among GCLUSTERS */
103264    +%Macro MakeGClusterConstData(indata=, inoutrsq=, outnode=, outlink=);
103266    +data &outlink(keep = _NAME_ _PARENT_ _LABEL_ LINKID);
103267    +     set &indata;
103268    +     LINKID = _N_;
103269    +     if upcase(substr(strip(_NAME_),1, 2))="CL" then do;
103270    +        _NAME_ = "ROOT"||upcase(substr(strip(_NAME_),5));
103271    +     end;
103272    +     if _PARENT_ ne " " and upcase(substr(strip(_PARENT_),1, 2))="CL" then do;
103273    +        _PARENT_ = "ROOT"||upcase(substr(strip(_PARENT_),5));
103274    +     end;
103275    +     if upcase(substr(strip(_LABEL_),1, 2))="CL" then do;
103276    +        _LABEL_ = "ROOT"||upcase(substr(strip(_LABEL_),5));
103277    +    end;
103278    +run;
103280    +data _tmp_outrsquare;
103281    +        set &inoutrsq;
103282    +        if upcase(strip(TYPE)) = 'CLUSTERCOMP' then delete;
103283    +run;
103285    +proc freq data =_tmp_outrsquare noprint;
103286    +         tables GCluster/out=_tmp_GCLUSFREQ(rename=(GCLUSTER=_NAME_));
103287    +run;
103289    +data &outnode(keep=_NAME_ TYPE LABEL);
103290    +    set &outlink;
103291    +    length TYPE $16;
103292    +    length LABEL $100;
103293    +    /*label CLUSNAME= "%sysfunc(sasmsg(sashelp.dmine, rpt_varclus_label_nodeidvar, noquote))" ;*/
103295    +    if upcase(substr(strip(_NAME_),1, 2))='GC' then do;
103296    +    TYPE = "GCLUSTER";
103297    +    LABEL = "%sysfunc(sasmsg(sashelp.dmine, rpt_varclus_label_gcluster, noquote)):"||_NAME_;
103298    +    end;
103299    +    else do;
103300    +    TYPE= "ROOT";
103301    +    LABEL= _NAME_;
103302    +    end;
103303    +    label TYPE  =  "%sysfunc(sasmsg(sashelp.dmine, rpt_varclus_label_nodetype, noquote))" ;
103304    +    label LABEL =  "%sysfunc(sasmsg(sashelp.dmine, rpt_varclus_label_label, noquote))" ;
103305    +    label _NAME_ =  "%sysfunc(sasmsg(sashelp.dmine, rpt_varclus_label_nodeidvar, noquote))" ;
103306    +    run;
103308    +proc sort data=&outnode;
103309    +     by _NAME_;
103310    +proc sort data=_tmp_GCLUSFREQ;
103311    +     by _NAME_;
103312    +run;
103314    +data  &outnode;
103315    +     merge &outnode _tmp_GCLUSFREQ; by _NAME_;
103316    +     if COUNT=. then COUNT=1;
103317    +run;
103319    +proc datasets lib = work nolist;
103320    +     delete _tmp_outrsquare _tmp_GCLUSFREQ;
103321    +run;
103323    +quit;
103324    +%Mend MakeGClusterConstData;
103327    +%macro CreateGClusterScoreCode(indata=,  globalclusid=, fileref=);
103329    +    data _gscoretmpds;
103330    +          set &indata;
103331    +          if (_TYPE_ in ('SCORE' 'MEAN' 'STD') and _NCL_ = 1 ) or (_TYPE_ in ('MEAN' 'STD'));
103332    +          if _TYPE_ = 'MEAN' then _NAME_='MEAN';
103333    +          if _TYPE_ = 'STD' then _NAME_='STD';
103334    +          if _TYPE_ = 'SCORE' then _NAME_ = "GC"||strip(&globalclusid);
103335    +          DROP _TYPE_ _NCL_;
103336    +     run;
103338    +    /*  %let gscorefile =  %bquote(&EM_NODEDIR)&EM_DSEP.gclusterscore.sas;
103339    +        GCluster Component &globalclusid ------ */
103341    +    filename _file_  "&fileref";
103343    +    data _null_;
103344    +        %if &globalclusid eq 1 %then %do;
103345    +          FILE _file_;
103346    +        %end;
103347    +        %else %do;
103348    +          FILE _file_ MOD;
103349    +        %end;
103351    +        %let dsid = %sysfunc(open(work._gscoretmpds));
103352    +        %let nvar = %sysfunc(attrn(&dsid, NVAR));
103353    +        %let vn_name =%sysfunc(varnum(&dsid, _NAME_));
103355    +        %let k = 1;
103356    +        %do %while(^%sysfunc(fetch(&dsid)));
103357    +                %let _name = %sysfunc(getvarc(&dsid, &vn_name));
103358    +                %if &k > 2 %then %do;
103359    +                put "&_name = 0 ; ";
103360    +                %end;
103361    +                %let k = %eval(&k+1);
103362    +        %end;
103364    +        %let rc = %sysfunc(rewind(&dsid));
103365    +        %do i= 2 %to &nvar;
103366    +            %let _varname =  %sysfunc(varname(&dsid, &i));
103367    +            %do %while(^%sysfunc(fetch(&dsid)));
103368    +                %let _name = %sysfunc(getvarc(&dsid, &vn_name));
103369    +                %if &_name = MEAN %then
103370    +                %let _mean = %sysfunc(getvarn(&dsid, &i));
103371    +                %else %if &_name = STD %then
103372    +                %let _std = %sysfunc(getvarn(&dsid, &i));
103373    +                %else %do;
103374    +                      %let coeff =  %sysfunc(getvarn(&dsid, &i));
103375    +                      %let abscoeff = %sysfunc(abs(&coeff));
103376    +                          %if &abscoeff >  0 %then %do;
103377    +                       put "&_name = &_name+&coeff * (&_varname - &_mean)/&_std;";
103378    +                           %end;
103379    +                 %end;
103380    +             %end;
103381    +             %let rc = %sysfunc(rewind(&dsid));
103383    +         %end;
103385    +        %let dsid= %sysfunc(close(&dsid));
103386    +       run;
103389    +       proc datasets lib=work nolist;
103390    +            delete _gscoretmpds;
103391    +       run;
103392    +      quit;
103394    +%mend CreateGClusterScoreCode;
103397    +%macro MakeGClusterCorrelation(Indata=, ngcluster=, gscorecode=, outrsquare=);
103399    +   %EM_REGISTER(KEY=GSCORE, TYPE=DATA);
103400    +   %EM_GETNAME(KEY=GSCORE, TYPE=DATA);
103401    +   %EM_REGISTER(KEY=GSCORESTAT, TYPE=DATA);
103402    +   %EM_GETNAME(KEY=GSCORESTAT, TYPE=DATA);
103403    +   %EM_REGISTER(KEY=GSCORETREE, TYPE=DATA);
103404    +   %EM_GETNAME(KEY=GSCORETREE, TYPE=DATA);
103405    +   %EM_REGISTER(KEY=GSCORECORR, TYPE=DATA);
103406    +   %EM_GETNAME(KEY=GSCORECORR, TYPE=DATA);
103407    +   %EM_REGISTER(KEY=GSCORECORRPLOT, TYPE=DATA);
103408    +   %EM_GETNAME(KEY=GSCORECORRPLOT, TYPE=DATA);
103409    +   %EM_REGISTER(KEY=GCLUSLINK, TYPE=DATA);
103410    +   %EM_GETNAME(KEY=GCLUSLINK, TYPE=DATA);
103411    +   %EM_REGISTER(KEY=GCLUSNODE, TYPE=DATA);
103412    +   %EM_GETNAME(KEY=GCLUSNODE, TYPE=DATA);
103414    +   filename gsfile "&gscorecode";
103416    +   data &EM_USER_GSCORE;
103417    +             set &indata;
103418    +             %include  gsfile;
103419    +        keep
103420    +        %do i=1 %to &ngcluster;
103421    +         %let gcvarname = GC&i;
103422    +         &gcvarname
103423    +        %end;
103424    +     ;
103425    +   run;
103427    +   proc varclus data=&EM_USER_GSCORE outstat=&EM_USER_GSCORESTAT outtree=&EM_USER_GSCORETREE
103428    +    %if %upcase(&EM_PROPERTY_CLUSCOMP) eq CENTROID %then %do; centroid %end;
103429    +    %if %upcase(&EM_PROPERTY_CLUSSOURCE) eq COV %then %do; cov %end;
103430    +    %if %upcase(&EM_PROPERTY_CLUSHIERACHY) eq Y %then %do; hi %end;
103431    +    noprint  ;
103432    +     var
103433    +       %do i=1 %to &ngcluster;
103434    +         %let gcvarname = GC&i;
103435    +         &gcvarname
103436    +        %end;
103437    +   ;
103438    +   run;
103441    +   %MakeVarClusCorrData(statds=&EM_USER_GSCORESTAT, corrds=&EM_USER_GSCORECORR, corrplotds=&EM_USER_GSCORECORRPLOT );
103442    +   data &EM_USER_GSCORECORRPLOT ;
103443    +        set &EM_USER_GSCORECORRPLOT;
103444    +        rename _X_ = X;
103445    +        rename _Y_ = Y;
103446    +        label _X_ = "%sysfunc(sasmsg(sashelp.dmine, rpt_varclus_label_gcluster, noquote))" ;
103447    +        label _Y_ = "%sysfunc(sasmsg(sashelp.dmine, rpt_varclus_label_gcluster, noquote))" ;
103448    +   run;
103450    +   %MakeGClusterConstData(indata=&EM_USER_GSCORETREE, inoutrsq=&outrsquare, outnode=&EM_USER_GCLUSNODE, outlink=&EM_USER_GCLUSLINK);
103452    +   data &EM_USER_GSCORETREE;
103453    +        length _NAME_ $32;
103454    +        length _LABEL_ $100;
103455    +        set &EM_USER_GSCORETREE(DROP=_LABEL_);
103456    +        if upcase(substr(strip(_NAME_),1, 2))='GC' then do;
103457    +         _LABEL_ = "%sysfunc(sasmsg(sashelp.dmine, rpt_varclus_label_gcluster, noquote)):"||_NAME_;
103458    +        end;else do;
103459    +         _LABEL_ = _NAME_;
103460    +        end;
103461    +       label _LABEL_ = "%sysfunc(sasmsg(sashelp.dmine, rpt_varclus_label_variable, noquote))";
103463    +   run;
103465    +   quit;
103467    +%mend MakeGClusterCorrelation;
NOTE: %INCLUDE (level 1) ending.
MPRINT(MAIN):   filename temp;
NOTE: Fileref TEMP has been deassigned.
MPRINT(SETPROPERTIES):  ;
MPRINT(SETPROPERTIES):  ;
MPRINT(SETPROPERTIES):  ;
MPRINT(SETPROPERTIES):  ;
MPRINT(SETPROPERTIES):  ;
MPRINT(SETPROPERTIES):  ;
MPRINT(SETPROPERTIES):  ;
MPRINT(SETPROPERTIES):  ;
MPRINT(SETPROPERTIES):  ;
MPRINT(SETPROPERTIES):  ;
MPRINT(SETPROPERTIES):  ;
MPRINT(SETPROPERTIES):  ;
MPRINT(SETPROPERTIES):  ;
MPRINT(MAIN):  ;
MPRINT(MAIN):   filename temp catalog 'sashelp.emexpl.variableclustering_report.source';
NOTE: %INCLUDE (level 1) file TEMP is file SASHELP.EMEXPL.VARIABLECLUSTERING_REPORT.SOURCE.
103470    +%macro report;
103471    +    %EM_GETNAME(key=VARCLUSMETA, type=DATA) ;
103473    +    data _null_;
103474    +         set &EM_USER_VARCLUSMETA;
103475    +         if _N_=1 then
103476    +         call symput('_trainnum', TrainNum);
103477    +    run;
103478    +   %if (&_trainnum = 1 ) or %upcase(&EM_PROPERTY_TWOSTAGECLUS) = NO %then %do;
103479    +           filename temp catalog 'sashelp.emexpl.variableclustering_report1.source';
103480    +           %include temp;
103481    +           filename temp;
103482    +           %report1;
103483    +       %end;
103484    +   %if (&_trainnum = 2 ) or %upcase(&EM_PROPERTY_TWOSTAGECLUS) = YES %then %do;
103485    +           filename temp catalog 'sashelp.emexpl.variableclustering_report2.source';
103486    +           %include temp;
103487    +           filename temp;
103488    +           %report2;
103489    +    %end;
103491    +   /* End of all runs, change the flag of newtrain to N */
103492    +    %EM_GETNAME(KEY=VARCLUSMETA, TYPE=DATA);
103493    +    data &EM_USER_VARCLUSMETA;
103494    +         set &EM_USER_VARCLUSMETA;
103495    +         NewTrain = "N";
103496    +    run;
103497    +    quit;
103498    +%mend report;
NOTE: %INCLUDE (level 1) ending.
MPRINT(MAIN):   filename temp;
NOTE: Fileref TEMP has been deassigned.
MPRINT(REPORT):   ;
MPRINT(REPORT):   data _null_;
MPRINT(REPORT):   set EMWS8.VarClus_VARCLUSMETA;
MPRINT(REPORT):   if _N_=1 then call symput('_trainnum', TrainNum);
MPRINT(REPORT):   run;
 
NOTE: Numeric values have been converted to character values at the places given by: (Line):(Column).
      17:26
NOTE: There were 1 observations read from the data set EMWS8.VARCLUS_VARCLUSMETA.
NOTE: DATA statement used (Total process time):
      real time           0.01 seconds
      cpu time            0.01 seconds
 
 
MPRINT(REPORT):   filename temp catalog 'sashelp.emexpl.variableclustering_report1.source';
NOTE: %INCLUDE (level 1) file TEMP is file SASHELP.EMEXPL.VARIABLECLUSTERING_REPORT1.SOURCE.
103501    +%macro report1;
103503    +   %EM_GETNAME(key=OUTRSQUARE, type=DATA) ;
103504    +   %EM_GETNAME(key=OUTVARSEL, type=DATA) ;
103505    +   %EM_GETNAME(key=CLUSFREQ, type=DATA) ;
103507    +   data &EM_USER_OUTVARSEL;
103508    +        set &EM_USER_OUTRSQUARE;
103509    +        if upcase(strip(SELECTED)) = 'YES' then output;
103510    +   run;
103512    +   data _tmp_outrsquare;
103513    +        set &EM_USER_OUTRSQUARE;
103514    +        if upcase(strip(TYPE)) = 'CLUSTERCOMP' then delete;
103515    +   run;
103517    +   proc freq data =_tmp_outrsquare noprint;
103518    +        tables cluster/out=&EM_USER_CLUSFREQ sparse;
103519    +   run;
103521    +   proc datasets lib = work nolist;
103522    +     delete _tmp_outrsquare;
103523    +   run;
103525    +   data &EM_USER_CLUSFREQ;
103526    +       set &EM_USER_CLUSFREQ;
103527    +       label
103528    +           cluster = "%sysfunc(sasmsg(sashelp.dmine, rpt_varclus_label_cluster, NOQUOTE))"
103529    +           count   = "%sysfunc(sasmsg(sashelp.dmine, rpt_varclus_label_freqcnt, NOQUOTE))"
103530    +           percent = "%sysfunc(sasmsg(sashelp.dmine, rpt_varclus_label_freqpct, NOQUOTE))"
103531    +       ;
103532    +   run;
103534    +   %EM_REPORT(key=OUTVARSEL, viewtype=DATA, block=MODEL, autodisplay=Y, description=selectedvariables);
103535    +   %EM_REPORT(key=CLUSFREQ, viewtype=DATA, block=MODEL, autodisplay=Y, description=varfreqbycluster);
103536    +   %EM_REPORT(key=OUTRSQUARE, viewtype=DATA, block=MODEL, autodisplay=Y, description=varseltable);
103538    +   %EM_REPORT(linkkey=OUTLINK, nodekey=OUTNODE, viewtype=Constellation,  autodisplay=Y, block=MODEL,  linkfrom=Cluster, linkto=Variable, linkid=LINKID, nodeid=NODEID, nodeshape=TYPE, description=clusterplot);
103539    +   %EM_REPORT(KEY=OUTTREE, VIEWTYPE=DENDROGRAM,  autodisplay=Y, block =MODEL, Name=_NAME_, PARENT=_PARENT_, HEIGHT=_PROPOR_ , TipText = Variable, description=dendrogram );
103540    +   %EM_REPORT(key=OUTRSQUARE, view = 1, viewtype=SCATTER, x=Cluster, y=RSqRatio, autodisplay=N, group=Selected, block=MODEL, description=rsqplot);
103541    +   %EM_REPORT(view = 1, y=RsqWithOwnClusComp);
103542    +   %EM_REPORT(view=1, y=RsqWithNextClusComp);
103543    +   %EM_REPORT(key=OUTCORRPLOT, viewtype=HISTOGRAM, X=_X_,Y=_Y_, FREQ=correlation, autodisplay=N, block=MODEL, description=varcorr);
103544    +   %EM_REPORT(key=OUTCLUSCORRPLOT, viewtype=HISTOGRAM, X=X,Y=Y, FREQ=Correlation, autodisplay=N, block=MODEL, description=cluscorr);
103545    +   %EM_REPORT(key=OUTCLUSSTRUCT, view=2, viewtype=BAR, block=MODEL, x=Cluster, freq=_anynumeric_ , autodisplay=N,  description=corrstruct) ;
103547    +   /*
103548    +   %EM_REPORT(KEY=OUTTREE, VIEWTYPE=DENDROGRAM,  autodisplay=N, block =Dendrogram, Name=_NAME_, Parent=_PARENT_, Height=_VAREXP_, TipText=Variable, description=totvar);
103549    +   %EM_REPORT(key=OUTCORR, viewtype=DATA, block=MODEL,description=corrmatrix) ;
103550    +   %EM_REPORT(key=OUTSTATPLOT, viewtype=DATA, block=MODEL, description=sumstat) ; */
103553    +%mend report1;
NOTE: %INCLUDE (level 1) ending.
MPRINT(REPORT):   filename temp;
NOTE: Fileref TEMP has been deassigned.
MPRINT(REPORT1):   ;
MPRINT(REPORT1):   ;
MPRINT(REPORT1):   ;
MPRINT(REPORT1):   data EMWS8.VarClus_OUTVARSEL;
MPRINT(REPORT1):   set EMWS8.VarClus_OUTRSQUARE;
MPRINT(REPORT1):   if upcase(strip(SELECTED)) = 'YES' then output;
MPRINT(REPORT1):   run;
 
NOTE: There were 32 observations read from the data set EMWS8.VARCLUS_OUTRSQUARE.
NOTE: The data set EMWS8.VARCLUS_OUTVARSEL has 8 observations and 9 variables.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
 
 
MPRINT(REPORT1):   data _tmp_outrsquare;
MPRINT(REPORT1):   set EMWS8.VarClus_OUTRSQUARE;
MPRINT(REPORT1):   if upcase(strip(TYPE)) = 'CLUSTERCOMP' then delete;
MPRINT(REPORT1):   run;
 
NOTE: There were 32 observations read from the data set EMWS8.VARCLUS_OUTRSQUARE.
NOTE: The data set WORK._TMP_OUTRSQUARE has 24 observations and 9 variables.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
 
 
MPRINT(REPORT1):   proc freq data =_tmp_outrsquare noprint;
MPRINT(REPORT1):   tables cluster/out=EMWS8.VarClus_CLUSFREQ sparse;
MPRINT(REPORT1):   run;
 
NOTE: There were 24 observations read from the data set WORK._TMP_OUTRSQUARE.
NOTE: The data set EMWS8.VARCLUS_CLUSFREQ has 8 observations and 3 variables.
NOTE: PROCEDURE FREQ used (Total process time):
      real time           0.01 seconds
      cpu time            0.01 seconds
 
 
MPRINT(REPORT1):   proc datasets lib = work nolist;
MPRINT(REPORT1):   delete _tmp_outrsquare;
MPRINT(REPORT1):   run;
 
NOTE: Deleting WORK._TMP_OUTRSQUARE (memtype=DATA).
 
NOTE: PROCEDURE DATASETS used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
 
 
MPRINT(REPORT1):   data EMWS8.VarClus_CLUSFREQ;
MPRINT(REPORT1):   set EMWS8.VarClus_CLUSFREQ;
MPRINT(REPORT1):   label cluster = "Cluster" count = "Frequency Count" percent = "Percent of Total Frequency" ;
MPRINT(REPORT1):   run;
 
NOTE: There were 8 observations read from the data set EMWS8.VARCLUS_CLUSFREQ.
NOTE: The data set EMWS8.VARCLUS_CLUSFREQ has 8 observations and 3 variables.
NOTE: DATA statement used (Total process time):
      real time           0.01 seconds
      cpu time            0.01 seconds
 
 
MPRINT(EM_REPORT):   data WORK.EM_USER_REPORT;
MPRINT(EM_REPORT):   retain id 0;
MPRINT(EM_REPORT):   id + 1;
MPRINT(EM_REPORT):   length VIEW 8 NAME $32 VALUE $400;
MPRINT(EM_REPORT):   NAME = "KEY";
MPRINT(EM_REPORT):   VALUE = "OUTVARSEL";
MPRINT(EM_REPORT):   VIEW = 0.76349856833158;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "VIEWTYPE";
MPRINT(EM_REPORT):   VALUE = "DATA";
MPRINT(EM_REPORT):   VIEW = 0.76349856833158;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "AUTODISPLAY";
MPRINT(EM_REPORT):   VALUE = "Y";
MPRINT(EM_REPORT):   VIEW = 0.76349856833158;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "SPK";
MPRINT(EM_REPORT):   VALUE = "Y";
MPRINT(EM_REPORT):   VIEW = 0.76349856833158;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "COMPARE";
MPRINT(EM_REPORT):   VALUE = "N";
MPRINT(EM_REPORT):   VIEW = 0.76349856833158;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "LOCALIZE";
MPRINT(EM_REPORT):   VALUE = "N";
MPRINT(EM_REPORT):   VIEW = 0.76349856833158;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "EQUALIZEROWX";
MPRINT(EM_REPORT):   VALUE = "N";
MPRINT(EM_REPORT):   VIEW = 0.76349856833158;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "EQUALIZEROWY";
MPRINT(EM_REPORT):   VALUE = "N";
MPRINT(EM_REPORT):   VIEW = 0.76349856833158;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "EQUALIZECOLX";
MPRINT(EM_REPORT):   VALUE = "N";
MPRINT(EM_REPORT):   VIEW = 0.76349856833158;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "EQUALIZECOLY";
MPRINT(EM_REPORT):   VALUE = "N";
MPRINT(EM_REPORT):   VIEW = 0.76349856833158;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "NROWS";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 0.76349856833158;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "NCOLS";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 0.76349856833158;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "DISCRETEX";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 0.76349856833158;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "DISCRETEY";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 0.76349856833158;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "LATTICEX";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 0.76349856833158;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "LATTICEY";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 0.76349856833158;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "LATTICETYPE";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 0.76349856833158;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "ABSOLUTEVALUE";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 0.76349856833158;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "SORTORDER";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 0.76349856833158;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "ORIENTATION";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 0.76349856833158;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "METHOD";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 0.76349856833158;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "DIRECTION";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 0.76349856833158;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "BYSET";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 0.76349856833158;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "RENDERMODE";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 0.76349856833158;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "DESCRIPTION";
MPRINT(EM_REPORT):   VALUE = "selectedvariables";
MPRINT(EM_REPORT):   VIEW = 0.76349856833158;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "X";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 0.76349856833158;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "EXCLUDEVARS";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 0.76349856833158;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "Z";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 0.76349856833158;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "YVARS";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 0.76349856833158;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "FREQVARS";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 0.76349856833158;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "AXIS";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 0.76349856833158;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "FREQ";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 0.76349856833158;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "GROUP";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 0.76349856833158;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "SUBGROUP";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 0.76349856833158;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "BLOCK";
MPRINT(EM_REPORT):   VALUE = "MODEL";
MPRINT(EM_REPORT):   VIEW = 0.76349856833158;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "COLOR";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 0.76349856833158;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "COLORINDEX";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 0.76349856833158;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "TIPTEXT";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 0.76349856833158;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "TIP";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 0.76349856833158;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "TOOLTIP";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 0.76349856833158;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "REPORTID";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 0.76349856833158;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "IDVALUE";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 0.76349856833158;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "ID";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 0.76349856833158;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "SIZE";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 0.76349856833158;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "FROM";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 0.76349856833158;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "TO";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 0.76349856833158;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "VALUE";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 0.76349856833158;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "VIEWS";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 0.76349856833158;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "PARENT";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 0.76349856833158;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "NODETEXT";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 0.76349856833158;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "NODESIZE";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 0.76349856833158;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "STATS";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 0.76349856833158;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "CLASSDIST";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 0.76349856833158;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "INTDIST";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 0.76349856833158;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "FOLDER";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 0.76349856833158;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "YPLOTTYPE";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 0.76349856833158;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "XREF";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 0.76349856833158;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "XREF2";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 0.76349856833158;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "YREF";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 0.76349856833158;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "Y2REF";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 0.76349856833158;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "YREF2";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 0.76349856833158;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "Y2REF2";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 0.76349856833158;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "GROUPINDEX";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 0.76349856833158;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "JOIN";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 0.76349856833158;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "XEXCLUDE";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 0.76349856833158;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "FREQEXCLUDE";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 0.76349856833158;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "YEXCLUDE";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 0.76349856833158;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "NAME";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 0.76349856833158;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "HEIGHT";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 0.76349856833158;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "WIDTH";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 0.76349856833158;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "XAXISLABEL";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 0.76349856833158;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "Y2AXISLABEL";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 0.76349856833158;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "YAXISLABEL";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 0.76349856833158;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "DISPLAYXLABEL";
MPRINT(EM_REPORT):   VALUE = "Y";
MPRINT(EM_REPORT):   VIEW = 0.76349856833158;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "DISPLAYYLABEL";
MPRINT(EM_REPORT):   VALUE = "Y";
MPRINT(EM_REPORT):   VIEW = 0.76349856833158;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "CHOICETEXT";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 0.76349856833158;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "SEGMENTVALUE";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 0.76349856833158;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "LOWERBAND";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 0.76349856833158;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "UPPERBAND";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 0.76349856833158;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "YLINE";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 0.76349856833158;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "LINKKEY";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 0.76349856833158;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "NODEKEY";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 0.76349856833158;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "NODEID";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 0.76349856833158;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "NODEVALUE";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 0.76349856833158;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "NODECOLOR";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 0.76349856833158;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "NODESHAPE";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 0.76349856833158;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "NODESHAPEVAR";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 0.76349856833158;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "NODELABEL";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 0.76349856833158;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "NODETIP";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 0.76349856833158;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "LINKID";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 0.76349856833158;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "LINKVALUE";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 0.76349856833158;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "LINKFROM";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 0.76349856833158;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "LINKTO";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 0.76349856833158;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "LINKCOLOR";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 0.76349856833158;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "LINKWIDTH";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 0.76349856833158;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "LINKTIP";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 0.76349856833158;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "XFROM";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 0.76349856833158;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "XTO";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 0.76349856833158;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "YFROM";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 0.76349856833158;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "YTO";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 0.76349856833158;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "MATRIXVAR";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 0.76349856833158;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "RESPONSE";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 0.76349856833158;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "SERIES";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 0.76349856833158;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "DESCARG";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 0.76349856833158;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "Y1";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 0.76349856833158;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "Y2";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 0.76349856833158;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "Y3";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 0.76349856833158;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "Y4";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 0.76349856833158;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "Y5";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 0.76349856833158;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "Y6";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 0.76349856833158;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "Y7";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 0.76349856833158;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "Y8";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 0.76349856833158;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "Y9";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 0.76349856833158;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "Y10";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 0.76349856833158;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "Y11";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 0.76349856833158;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "Y12";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 0.76349856833158;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "Y13";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 0.76349856833158;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "Y14";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 0.76349856833158;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "Y15";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 0.76349856833158;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "Y16";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 0.76349856833158;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "TITLE";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 0.76349856833158;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "LEGEND";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 0.76349856833158;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "LEGENDTITLE";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 0.76349856833158;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "SHAPE";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 0.76349856833158;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "METHOD";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 0.76349856833158;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "NOBINMISS";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 0.76349856833158;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   run;
 
NOTE: The data set WORK.EM_USER_REPORT has 126 observations and 4 variables.
NOTE: DATA statement used (Total process time):
      real time           0.03 seconds
      cpu time            0.03 seconds
 
 
MPRINT(REPORT1):  ;
MPRINT(EM_REPORT):   data WORK.EM_USER_REPORT;
MPRINT(EM_REPORT):   set WORK.EM_USER_REPORT end=eof;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   if eof then do;
MPRINT(EM_REPORT):   id+1;
MPRINT(EM_REPORT):   NAME = "KEY";
MPRINT(EM_REPORT):   VALUE = "CLUSFREQ";
MPRINT(EM_REPORT):   VIEW = 0.10444600186517;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "VIEWTYPE";
MPRINT(EM_REPORT):   VALUE = "DATA";
MPRINT(EM_REPORT):   VIEW = 0.10444600186517;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "AUTODISPLAY";
MPRINT(EM_REPORT):   VALUE = "Y";
MPRINT(EM_REPORT):   VIEW = 0.10444600186517;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "SPK";
MPRINT(EM_REPORT):   VALUE = "Y";
MPRINT(EM_REPORT):   VIEW = 0.10444600186517;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "COMPARE";
MPRINT(EM_REPORT):   VALUE = "N";
MPRINT(EM_REPORT):   VIEW = 0.10444600186517;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "LOCALIZE";
MPRINT(EM_REPORT):   VALUE = "N";
MPRINT(EM_REPORT):   VIEW = 0.10444600186517;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "EQUALIZEROWX";
MPRINT(EM_REPORT):   VALUE = "N";
MPRINT(EM_REPORT):   VIEW = 0.10444600186517;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "EQUALIZEROWY";
MPRINT(EM_REPORT):   VALUE = "N";
MPRINT(EM_REPORT):   VIEW = 0.10444600186517;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "EQUALIZECOLX";
MPRINT(EM_REPORT):   VALUE = "N";
MPRINT(EM_REPORT):   VIEW = 0.10444600186517;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "EQUALIZECOLY";
MPRINT(EM_REPORT):   VALUE = "N";
MPRINT(EM_REPORT):   VIEW = 0.10444600186517;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "NROWS";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 0.10444600186517;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "NCOLS";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 0.10444600186517;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "DISCRETEX";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 0.10444600186517;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "DISCRETEY";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 0.10444600186517;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "LATTICEX";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 0.10444600186517;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "LATTICEY";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 0.10444600186517;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "LATTICETYPE";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 0.10444600186517;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "ABSOLUTEVALUE";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 0.10444600186517;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "SORTORDER";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 0.10444600186517;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "ORIENTATION";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 0.10444600186517;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "METHOD";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 0.10444600186517;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "DIRECTION";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 0.10444600186517;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "BYSET";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 0.10444600186517;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "RENDERMODE";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 0.10444600186517;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "DESCRIPTION";
MPRINT(EM_REPORT):   VALUE = "varfreqbycluster";
MPRINT(EM_REPORT):   VIEW = 0.10444600186517;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "X";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 0.10444600186517;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "EXCLUDEVARS";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 0.10444600186517;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "Z";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 0.10444600186517;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "YVARS";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 0.10444600186517;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "FREQVARS";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 0.10444600186517;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "AXIS";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 0.10444600186517;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "FREQ";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 0.10444600186517;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "GROUP";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 0.10444600186517;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "SUBGROUP";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 0.10444600186517;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "BLOCK";
MPRINT(EM_REPORT):   VALUE = "MODEL";
MPRINT(EM_REPORT):   VIEW = 0.10444600186517;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "COLOR";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 0.10444600186517;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "COLORINDEX";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 0.10444600186517;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "TIPTEXT";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 0.10444600186517;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "TIP";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 0.10444600186517;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "TOOLTIP";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 0.10444600186517;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "REPORTID";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 0.10444600186517;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "IDVALUE";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 0.10444600186517;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "ID";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 0.10444600186517;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "SIZE";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 0.10444600186517;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "FROM";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 0.10444600186517;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "TO";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 0.10444600186517;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "VALUE";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 0.10444600186517;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "VIEWS";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 0.10444600186517;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "PARENT";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 0.10444600186517;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "NODETEXT";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 0.10444600186517;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "NODESIZE";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 0.10444600186517;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "STATS";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 0.10444600186517;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "CLASSDIST";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 0.10444600186517;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "INTDIST";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 0.10444600186517;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "FOLDER";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 0.10444600186517;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "YPLOTTYPE";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 0.10444600186517;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "XREF";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 0.10444600186517;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "XREF2";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 0.10444600186517;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "YREF";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 0.10444600186517;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "Y2REF";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 0.10444600186517;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "YREF2";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 0.10444600186517;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "Y2REF2";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 0.10444600186517;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "GROUPINDEX";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 0.10444600186517;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "JOIN";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 0.10444600186517;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "XEXCLUDE";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 0.10444600186517;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "FREQEXCLUDE";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 0.10444600186517;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "YEXCLUDE";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 0.10444600186517;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "NAME";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 0.10444600186517;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "HEIGHT";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 0.10444600186517;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "WIDTH";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 0.10444600186517;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "XAXISLABEL";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 0.10444600186517;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "Y2AXISLABEL";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 0.10444600186517;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "YAXISLABEL";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 0.10444600186517;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "DISPLAYXLABEL";
MPRINT(EM_REPORT):   VALUE = "Y";
MPRINT(EM_REPORT):   VIEW = 0.10444600186517;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "DISPLAYYLABEL";
MPRINT(EM_REPORT):   VALUE = "Y";
MPRINT(EM_REPORT):   VIEW = 0.10444600186517;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "CHOICETEXT";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 0.10444600186517;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "SEGMENTVALUE";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 0.10444600186517;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "LOWERBAND";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 0.10444600186517;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "UPPERBAND";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 0.10444600186517;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "YLINE";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 0.10444600186517;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "LINKKEY";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 0.10444600186517;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "NODEKEY";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 0.10444600186517;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "NODEID";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 0.10444600186517;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "NODEVALUE";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 0.10444600186517;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "NODECOLOR";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 0.10444600186517;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "NODESHAPE";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 0.10444600186517;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "NODESHAPEVAR";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 0.10444600186517;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "NODELABEL";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 0.10444600186517;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "NODETIP";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 0.10444600186517;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "LINKID";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 0.10444600186517;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "LINKVALUE";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 0.10444600186517;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "LINKFROM";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 0.10444600186517;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "LINKTO";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 0.10444600186517;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "LINKCOLOR";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 0.10444600186517;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "LINKWIDTH";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 0.10444600186517;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "LINKTIP";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 0.10444600186517;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "XFROM";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 0.10444600186517;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "XTO";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 0.10444600186517;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "YFROM";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 0.10444600186517;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "YTO";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 0.10444600186517;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "MATRIXVAR";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 0.10444600186517;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "RESPONSE";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 0.10444600186517;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "SERIES";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 0.10444600186517;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "DESCARG";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 0.10444600186517;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "Y1";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 0.10444600186517;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "Y2";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 0.10444600186517;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "Y3";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 0.10444600186517;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "Y4";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 0.10444600186517;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "Y5";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 0.10444600186517;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "Y6";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 0.10444600186517;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "Y7";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 0.10444600186517;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "Y8";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 0.10444600186517;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "Y9";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 0.10444600186517;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "Y10";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 0.10444600186517;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "Y11";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 0.10444600186517;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "Y12";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 0.10444600186517;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "Y13";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 0.10444600186517;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "Y14";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 0.10444600186517;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "Y15";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 0.10444600186517;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "Y16";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 0.10444600186517;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "TITLE";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 0.10444600186517;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "LEGEND";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 0.10444600186517;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "LEGENDTITLE";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 0.10444600186517;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "SHAPE";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 0.10444600186517;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "METHOD";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 0.10444600186517;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "NOBINMISS";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 0.10444600186517;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   end;
MPRINT(EM_REPORT):   run;
 
NOTE: There were 126 observations read from the data set WORK.EM_USER_REPORT.
NOTE: The data set WORK.EM_USER_REPORT has 252 observations and 4 variables.
NOTE: DATA statement used (Total process time):
      real time           0.04 seconds
      cpu time            0.04 seconds
 
 
MPRINT(REPORT1):  ;
MPRINT(EM_REPORT):   data WORK.EM_USER_REPORT;
MPRINT(EM_REPORT):   set WORK.EM_USER_REPORT end=eof;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   if eof then do;
MPRINT(EM_REPORT):   id+1;
MPRINT(EM_REPORT):   NAME = "KEY";
MPRINT(EM_REPORT):   VALUE = "OUTRSQUARE";
MPRINT(EM_REPORT):   VIEW = 0.54278010574298;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "VIEWTYPE";
MPRINT(EM_REPORT):   VALUE = "DATA";
MPRINT(EM_REPORT):   VIEW = 0.54278010574298;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "AUTODISPLAY";
MPRINT(EM_REPORT):   VALUE = "Y";
MPRINT(EM_REPORT):   VIEW = 0.54278010574298;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "SPK";
MPRINT(EM_REPORT):   VALUE = "Y";
MPRINT(EM_REPORT):   VIEW = 0.54278010574298;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "COMPARE";
MPRINT(EM_REPORT):   VALUE = "N";
MPRINT(EM_REPORT):   VIEW = 0.54278010574298;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "LOCALIZE";
MPRINT(EM_REPORT):   VALUE = "N";
MPRINT(EM_REPORT):   VIEW = 0.54278010574298;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "EQUALIZEROWX";
MPRINT(EM_REPORT):   VALUE = "N";
MPRINT(EM_REPORT):   VIEW = 0.54278010574298;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "EQUALIZEROWY";
MPRINT(EM_REPORT):   VALUE = "N";
MPRINT(EM_REPORT):   VIEW = 0.54278010574298;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "EQUALIZECOLX";
MPRINT(EM_REPORT):   VALUE = "N";
MPRINT(EM_REPORT):   VIEW = 0.54278010574298;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "EQUALIZECOLY";
MPRINT(EM_REPORT):   VALUE = "N";
MPRINT(EM_REPORT):   VIEW = 0.54278010574298;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "NROWS";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 0.54278010574298;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "NCOLS";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 0.54278010574298;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "DISCRETEX";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 0.54278010574298;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "DISCRETEY";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 0.54278010574298;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "LATTICEX";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 0.54278010574298;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "LATTICEY";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 0.54278010574298;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "LATTICETYPE";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 0.54278010574298;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "ABSOLUTEVALUE";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 0.54278010574298;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "SORTORDER";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 0.54278010574298;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "ORIENTATION";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 0.54278010574298;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "METHOD";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 0.54278010574298;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "DIRECTION";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 0.54278010574298;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "BYSET";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 0.54278010574298;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "RENDERMODE";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 0.54278010574298;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "DESCRIPTION";
MPRINT(EM_REPORT):   VALUE = "varseltable";
MPRINT(EM_REPORT):   VIEW = 0.54278010574298;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "X";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 0.54278010574298;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "EXCLUDEVARS";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 0.54278010574298;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "Z";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 0.54278010574298;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "YVARS";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 0.54278010574298;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "FREQVARS";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 0.54278010574298;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "AXIS";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 0.54278010574298;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "FREQ";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 0.54278010574298;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "GROUP";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 0.54278010574298;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "SUBGROUP";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 0.54278010574298;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "BLOCK";
MPRINT(EM_REPORT):   VALUE = "MODEL";
MPRINT(EM_REPORT):   VIEW = 0.54278010574298;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "COLOR";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 0.54278010574298;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "COLORINDEX";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 0.54278010574298;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "TIPTEXT";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 0.54278010574298;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "TIP";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 0.54278010574298;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "TOOLTIP";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 0.54278010574298;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "REPORTID";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 0.54278010574298;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "IDVALUE";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 0.54278010574298;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "ID";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 0.54278010574298;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "SIZE";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 0.54278010574298;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "FROM";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 0.54278010574298;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "TO";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 0.54278010574298;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "VALUE";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 0.54278010574298;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "VIEWS";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 0.54278010574298;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "PARENT";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 0.54278010574298;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "NODETEXT";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 0.54278010574298;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "NODESIZE";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 0.54278010574298;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "STATS";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 0.54278010574298;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "CLASSDIST";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 0.54278010574298;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "INTDIST";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 0.54278010574298;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "FOLDER";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 0.54278010574298;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "YPLOTTYPE";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 0.54278010574298;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "XREF";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 0.54278010574298;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "XREF2";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 0.54278010574298;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "YREF";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 0.54278010574298;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "Y2REF";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 0.54278010574298;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "YREF2";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 0.54278010574298;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "Y2REF2";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 0.54278010574298;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "GROUPINDEX";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 0.54278010574298;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "JOIN";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 0.54278010574298;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "XEXCLUDE";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 0.54278010574298;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "FREQEXCLUDE";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 0.54278010574298;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "YEXCLUDE";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 0.54278010574298;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "NAME";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 0.54278010574298;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "HEIGHT";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 0.54278010574298;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "WIDTH";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 0.54278010574298;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "XAXISLABEL";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 0.54278010574298;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "Y2AXISLABEL";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 0.54278010574298;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "YAXISLABEL";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 0.54278010574298;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "DISPLAYXLABEL";
MPRINT(EM_REPORT):   VALUE = "Y";
MPRINT(EM_REPORT):   VIEW = 0.54278010574298;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "DISPLAYYLABEL";
MPRINT(EM_REPORT):   VALUE = "Y";
MPRINT(EM_REPORT):   VIEW = 0.54278010574298;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "CHOICETEXT";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 0.54278010574298;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "SEGMENTVALUE";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 0.54278010574298;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "LOWERBAND";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 0.54278010574298;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "UPPERBAND";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 0.54278010574298;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "YLINE";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 0.54278010574298;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "LINKKEY";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 0.54278010574298;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "NODEKEY";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 0.54278010574298;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "NODEID";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 0.54278010574298;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "NODEVALUE";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 0.54278010574298;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "NODECOLOR";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 0.54278010574298;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "NODESHAPE";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 0.54278010574298;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "NODESHAPEVAR";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 0.54278010574298;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "NODELABEL";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 0.54278010574298;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "NODETIP";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 0.54278010574298;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "LINKID";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 0.54278010574298;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "LINKVALUE";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 0.54278010574298;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "LINKFROM";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 0.54278010574298;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "LINKTO";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 0.54278010574298;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "LINKCOLOR";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 0.54278010574298;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "LINKWIDTH";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 0.54278010574298;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "LINKTIP";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 0.54278010574298;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "XFROM";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 0.54278010574298;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "XTO";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 0.54278010574298;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "YFROM";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 0.54278010574298;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "YTO";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 0.54278010574298;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "MATRIXVAR";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 0.54278010574298;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "RESPONSE";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 0.54278010574298;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "SERIES";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 0.54278010574298;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "DESCARG";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 0.54278010574298;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "Y1";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 0.54278010574298;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "Y2";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 0.54278010574298;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "Y3";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 0.54278010574298;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "Y4";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 0.54278010574298;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "Y5";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 0.54278010574298;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "Y6";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 0.54278010574298;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "Y7";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 0.54278010574298;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "Y8";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 0.54278010574298;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "Y9";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 0.54278010574298;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "Y10";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 0.54278010574298;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "Y11";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 0.54278010574298;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "Y12";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 0.54278010574298;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "Y13";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 0.54278010574298;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "Y14";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 0.54278010574298;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "Y15";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 0.54278010574298;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "Y16";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 0.54278010574298;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "TITLE";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 0.54278010574298;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "LEGEND";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 0.54278010574298;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "LEGENDTITLE";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 0.54278010574298;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "SHAPE";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 0.54278010574298;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "METHOD";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 0.54278010574298;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "NOBINMISS";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 0.54278010574298;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   end;
MPRINT(EM_REPORT):   run;
 
NOTE: There were 252 observations read from the data set WORK.EM_USER_REPORT.
NOTE: The data set WORK.EM_USER_REPORT has 378 observations and 4 variables.
NOTE: DATA statement used (Total process time):
      real time           0.03 seconds
      cpu time            0.03 seconds
 
 
MPRINT(REPORT1):  ;
MPRINT(EM_REPORT):   data WORK.EM_USER_REPORT;
MPRINT(EM_REPORT):   set WORK.EM_USER_REPORT end=eof;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   if eof then do;
MPRINT(EM_REPORT):   id+1;
MPRINT(EM_REPORT):   NAME = "KEY";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 0.14286820504016;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "VIEWTYPE";
MPRINT(EM_REPORT):   VALUE = "Constellation";
MPRINT(EM_REPORT):   VIEW = 0.14286820504016;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "AUTODISPLAY";
MPRINT(EM_REPORT):   VALUE = "Y";
MPRINT(EM_REPORT):   VIEW = 0.14286820504016;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "SPK";
MPRINT(EM_REPORT):   VALUE = "Y";
MPRINT(EM_REPORT):   VIEW = 0.14286820504016;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "COMPARE";
MPRINT(EM_REPORT):   VALUE = "N";
MPRINT(EM_REPORT):   VIEW = 0.14286820504016;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "LOCALIZE";
MPRINT(EM_REPORT):   VALUE = "N";
MPRINT(EM_REPORT):   VIEW = 0.14286820504016;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "EQUALIZEROWX";
MPRINT(EM_REPORT):   VALUE = "N";
MPRINT(EM_REPORT):   VIEW = 0.14286820504016;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "EQUALIZEROWY";
MPRINT(EM_REPORT):   VALUE = "N";
MPRINT(EM_REPORT):   VIEW = 0.14286820504016;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "EQUALIZECOLX";
MPRINT(EM_REPORT):   VALUE = "N";
MPRINT(EM_REPORT):   VIEW = 0.14286820504016;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "EQUALIZECOLY";
MPRINT(EM_REPORT):   VALUE = "N";
MPRINT(EM_REPORT):   VIEW = 0.14286820504016;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "NROWS";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 0.14286820504016;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "NCOLS";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 0.14286820504016;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "DISCRETEX";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 0.14286820504016;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "DISCRETEY";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 0.14286820504016;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "LATTICEX";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 0.14286820504016;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "LATTICEY";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 0.14286820504016;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "LATTICETYPE";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 0.14286820504016;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "ABSOLUTEVALUE";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 0.14286820504016;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "SORTORDER";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 0.14286820504016;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "ORIENTATION";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 0.14286820504016;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "METHOD";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 0.14286820504016;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "DIRECTION";
MPRINT(EM_REPORT):   VALUE = "FALSE";
MPRINT(EM_REPORT):   VIEW = 0.14286820504016;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "BYSET";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 0.14286820504016;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "RENDERMODE";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 0.14286820504016;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "DESCRIPTION";
MPRINT(EM_REPORT):   VALUE = "clusterplot";
MPRINT(EM_REPORT):   VIEW = 0.14286820504016;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "X";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 0.14286820504016;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "EXCLUDEVARS";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 0.14286820504016;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "Z";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 0.14286820504016;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "YVARS";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 0.14286820504016;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "FREQVARS";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 0.14286820504016;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "AXIS";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 0.14286820504016;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "FREQ";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 0.14286820504016;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "GROUP";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 0.14286820504016;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "SUBGROUP";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 0.14286820504016;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "BLOCK";
MPRINT(EM_REPORT):   VALUE = "MODEL";
MPRINT(EM_REPORT):   VIEW = 0.14286820504016;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "COLOR";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 0.14286820504016;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "COLORINDEX";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 0.14286820504016;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "TIPTEXT";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 0.14286820504016;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "TIP";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 0.14286820504016;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "TOOLTIP";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 0.14286820504016;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "REPORTID";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 0.14286820504016;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "IDVALUE";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 0.14286820504016;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "ID";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 0.14286820504016;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "SIZE";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 0.14286820504016;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "FROM";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 0.14286820504016;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "TO";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 0.14286820504016;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "VALUE";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 0.14286820504016;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "VIEWS";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 0.14286820504016;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "PARENT";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 0.14286820504016;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "NODETEXT";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 0.14286820504016;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "NODESIZE";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 0.14286820504016;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "STATS";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 0.14286820504016;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "CLASSDIST";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 0.14286820504016;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "INTDIST";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 0.14286820504016;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "FOLDER";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 0.14286820504016;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "YPLOTTYPE";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 0.14286820504016;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "XREF";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 0.14286820504016;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "XREF2";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 0.14286820504016;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "YREF";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 0.14286820504016;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "Y2REF";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 0.14286820504016;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "YREF2";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 0.14286820504016;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "Y2REF2";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 0.14286820504016;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "GROUPINDEX";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 0.14286820504016;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "JOIN";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 0.14286820504016;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "XEXCLUDE";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 0.14286820504016;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "FREQEXCLUDE";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 0.14286820504016;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "YEXCLUDE";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 0.14286820504016;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "NAME";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 0.14286820504016;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "HEIGHT";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 0.14286820504016;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "WIDTH";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 0.14286820504016;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "XAXISLABEL";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 0.14286820504016;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "Y2AXISLABEL";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 0.14286820504016;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "YAXISLABEL";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 0.14286820504016;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "DISPLAYXLABEL";
MPRINT(EM_REPORT):   VALUE = "Y";
MPRINT(EM_REPORT):   VIEW = 0.14286820504016;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "DISPLAYYLABEL";
MPRINT(EM_REPORT):   VALUE = "Y";
MPRINT(EM_REPORT):   VIEW = 0.14286820504016;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "CHOICETEXT";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 0.14286820504016;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "SEGMENTVALUE";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 0.14286820504016;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "LOWERBAND";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 0.14286820504016;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "UPPERBAND";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 0.14286820504016;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "YLINE";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 0.14286820504016;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "LINKKEY";
MPRINT(EM_REPORT):   VALUE = "OUTLINK";
MPRINT(EM_REPORT):   VIEW = 0.14286820504016;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "NODEKEY";
MPRINT(EM_REPORT):   VALUE = "OUTNODE";
MPRINT(EM_REPORT):   VIEW = 0.14286820504016;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "NODEID";
MPRINT(EM_REPORT):   VALUE = "NODEID";
MPRINT(EM_REPORT):   VIEW = 0.14286820504016;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "NODEVALUE";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 0.14286820504016;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "NODECOLOR";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 0.14286820504016;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "NODESHAPE";
MPRINT(EM_REPORT):   VALUE = "CIRCLE";
MPRINT(EM_REPORT):   VIEW = 0.14286820504016;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "NODESHAPEVAR";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 0.14286820504016;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "NODELABEL";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 0.14286820504016;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "NODETIP";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 0.14286820504016;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "LINKID";
MPRINT(EM_REPORT):   VALUE = "LINKID";
MPRINT(EM_REPORT):   VIEW = 0.14286820504016;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "LINKVALUE";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 0.14286820504016;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "LINKFROM";
MPRINT(EM_REPORT):   VALUE = "Cluster";
MPRINT(EM_REPORT):   VIEW = 0.14286820504016;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "LINKTO";
MPRINT(EM_REPORT):   VALUE = "Variable";
MPRINT(EM_REPORT):   VIEW = 0.14286820504016;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "LINKCOLOR";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 0.14286820504016;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "LINKWIDTH";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 0.14286820504016;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "LINKTIP";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 0.14286820504016;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "XFROM";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 0.14286820504016;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "XTO";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 0.14286820504016;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "YFROM";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 0.14286820504016;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "YTO";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 0.14286820504016;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "MATRIXVAR";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 0.14286820504016;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "RESPONSE";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 0.14286820504016;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "SERIES";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 0.14286820504016;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "DESCARG";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 0.14286820504016;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "Y1";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 0.14286820504016;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "Y2";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 0.14286820504016;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "Y3";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 0.14286820504016;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "Y4";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 0.14286820504016;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "Y5";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 0.14286820504016;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "Y6";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 0.14286820504016;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "Y7";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 0.14286820504016;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "Y8";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 0.14286820504016;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "Y9";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 0.14286820504016;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "Y10";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 0.14286820504016;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "Y11";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 0.14286820504016;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "Y12";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 0.14286820504016;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "Y13";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 0.14286820504016;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "Y14";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 0.14286820504016;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "Y15";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 0.14286820504016;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "Y16";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 0.14286820504016;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "TITLE";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 0.14286820504016;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "LEGEND";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 0.14286820504016;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "LEGENDTITLE";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 0.14286820504016;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "SHAPE";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 0.14286820504016;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "METHOD";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 0.14286820504016;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "NOBINMISS";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 0.14286820504016;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   end;
MPRINT(EM_REPORT):   run;
 
NOTE: There were 378 observations read from the data set WORK.EM_USER_REPORT.
NOTE: The data set WORK.EM_USER_REPORT has 504 observations and 4 variables.
NOTE: DATA statement used (Total process time):
      real time           0.03 seconds
      cpu time            0.03 seconds
 
 
MPRINT(REPORT1):  ;
MPRINT(EM_REPORT):   data WORK.EM_USER_REPORT;
MPRINT(EM_REPORT):   set WORK.EM_USER_REPORT end=eof;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   if eof then do;
MPRINT(EM_REPORT):   id+1;
MPRINT(EM_REPORT):   NAME = "KEY";
MPRINT(EM_REPORT):   VALUE = "OUTTREE";
MPRINT(EM_REPORT):   VIEW = 0.94438546893391;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "VIEWTYPE";
MPRINT(EM_REPORT):   VALUE = "DENDROGRAM";
MPRINT(EM_REPORT):   VIEW = 0.94438546893391;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "AUTODISPLAY";
MPRINT(EM_REPORT):   VALUE = "Y";
MPRINT(EM_REPORT):   VIEW = 0.94438546893391;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "SPK";
MPRINT(EM_REPORT):   VALUE = "Y";
MPRINT(EM_REPORT):   VIEW = 0.94438546893391;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "COMPARE";
MPRINT(EM_REPORT):   VALUE = "N";
MPRINT(EM_REPORT):   VIEW = 0.94438546893391;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "LOCALIZE";
MPRINT(EM_REPORT):   VALUE = "N";
MPRINT(EM_REPORT):   VIEW = 0.94438546893391;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "EQUALIZEROWX";
MPRINT(EM_REPORT):   VALUE = "N";
MPRINT(EM_REPORT):   VIEW = 0.94438546893391;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "EQUALIZEROWY";
MPRINT(EM_REPORT):   VALUE = "N";
MPRINT(EM_REPORT):   VIEW = 0.94438546893391;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "EQUALIZECOLX";
MPRINT(EM_REPORT):   VALUE = "N";
MPRINT(EM_REPORT):   VIEW = 0.94438546893391;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "EQUALIZECOLY";
MPRINT(EM_REPORT):   VALUE = "N";
MPRINT(EM_REPORT):   VIEW = 0.94438546893391;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "NROWS";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 0.94438546893391;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "NCOLS";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 0.94438546893391;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "DISCRETEX";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 0.94438546893391;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "DISCRETEY";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 0.94438546893391;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "LATTICEX";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 0.94438546893391;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "LATTICEY";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 0.94438546893391;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "LATTICETYPE";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 0.94438546893391;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "ABSOLUTEVALUE";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 0.94438546893391;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "SORTORDER";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 0.94438546893391;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "ORIENTATION";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 0.94438546893391;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "METHOD";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 0.94438546893391;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "DIRECTION";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 0.94438546893391;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "BYSET";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 0.94438546893391;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "RENDERMODE";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 0.94438546893391;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "DESCRIPTION";
MPRINT(EM_REPORT):   VALUE = "dendrogram";
MPRINT(EM_REPORT):   VIEW = 0.94438546893391;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "X";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 0.94438546893391;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "EXCLUDEVARS";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 0.94438546893391;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "Z";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 0.94438546893391;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "YVARS";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 0.94438546893391;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "FREQVARS";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 0.94438546893391;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "AXIS";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 0.94438546893391;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "FREQ";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 0.94438546893391;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "GROUP";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 0.94438546893391;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "SUBGROUP";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 0.94438546893391;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "BLOCK";
MPRINT(EM_REPORT):   VALUE = "MODEL";
MPRINT(EM_REPORT):   VIEW = 0.94438546893391;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "COLOR";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 0.94438546893391;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "COLORINDEX";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 0.94438546893391;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "TIPTEXT";
MPRINT(EM_REPORT):   VALUE = "Variable";
MPRINT(EM_REPORT):   VIEW = 0.94438546893391;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "TIP";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 0.94438546893391;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "TOOLTIP";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 0.94438546893391;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "REPORTID";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 0.94438546893391;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "IDVALUE";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 0.94438546893391;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "ID";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 0.94438546893391;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "SIZE";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 0.94438546893391;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "FROM";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 0.94438546893391;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "TO";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 0.94438546893391;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "VALUE";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 0.94438546893391;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "VIEWS";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 0.94438546893391;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "PARENT";
MPRINT(EM_REPORT):   VALUE = "_PARENT_";
MPRINT(EM_REPORT):   VIEW = 0.94438546893391;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "NODETEXT";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 0.94438546893391;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "NODESIZE";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 0.94438546893391;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "STATS";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 0.94438546893391;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "CLASSDIST";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 0.94438546893391;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "INTDIST";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 0.94438546893391;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "FOLDER";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 0.94438546893391;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "YPLOTTYPE";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 0.94438546893391;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "XREF";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 0.94438546893391;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "XREF2";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 0.94438546893391;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "YREF";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 0.94438546893391;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "Y2REF";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 0.94438546893391;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "YREF2";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 0.94438546893391;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "Y2REF2";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 0.94438546893391;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "GROUPINDEX";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 0.94438546893391;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "JOIN";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 0.94438546893391;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "XEXCLUDE";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 0.94438546893391;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "FREQEXCLUDE";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 0.94438546893391;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "YEXCLUDE";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 0.94438546893391;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "NAME";
MPRINT(EM_REPORT):   VALUE = "_NAME_";
MPRINT(EM_REPORT):   VIEW = 0.94438546893391;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "HEIGHT";
MPRINT(EM_REPORT):   VALUE = "_PROPOR_";
MPRINT(EM_REPORT):   VIEW = 0.94438546893391;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "WIDTH";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 0.94438546893391;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "XAXISLABEL";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 0.94438546893391;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "Y2AXISLABEL";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 0.94438546893391;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "YAXISLABEL";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 0.94438546893391;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "DISPLAYXLABEL";
MPRINT(EM_REPORT):   VALUE = "Y";
MPRINT(EM_REPORT):   VIEW = 0.94438546893391;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "DISPLAYYLABEL";
MPRINT(EM_REPORT):   VALUE = "Y";
MPRINT(EM_REPORT):   VIEW = 0.94438546893391;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "CHOICETEXT";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 0.94438546893391;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "SEGMENTVALUE";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 0.94438546893391;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "LOWERBAND";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 0.94438546893391;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "UPPERBAND";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 0.94438546893391;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "YLINE";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 0.94438546893391;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "LINKKEY";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 0.94438546893391;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "NODEKEY";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 0.94438546893391;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "NODEID";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 0.94438546893391;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "NODEVALUE";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 0.94438546893391;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "NODECOLOR";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 0.94438546893391;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "NODESHAPE";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 0.94438546893391;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "NODESHAPEVAR";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 0.94438546893391;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "NODELABEL";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 0.94438546893391;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "NODETIP";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 0.94438546893391;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "LINKID";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 0.94438546893391;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "LINKVALUE";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 0.94438546893391;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "LINKFROM";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 0.94438546893391;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "LINKTO";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 0.94438546893391;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "LINKCOLOR";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 0.94438546893391;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "LINKWIDTH";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 0.94438546893391;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "LINKTIP";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 0.94438546893391;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "XFROM";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 0.94438546893391;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "XTO";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 0.94438546893391;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "YFROM";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 0.94438546893391;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "YTO";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 0.94438546893391;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "MATRIXVAR";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 0.94438546893391;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "RESPONSE";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 0.94438546893391;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "SERIES";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 0.94438546893391;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "DESCARG";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 0.94438546893391;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "Y1";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 0.94438546893391;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "Y2";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 0.94438546893391;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "Y3";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 0.94438546893391;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "Y4";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 0.94438546893391;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "Y5";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 0.94438546893391;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "Y6";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 0.94438546893391;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "Y7";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 0.94438546893391;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "Y8";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 0.94438546893391;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "Y9";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 0.94438546893391;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "Y10";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 0.94438546893391;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "Y11";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 0.94438546893391;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "Y12";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 0.94438546893391;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "Y13";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 0.94438546893391;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "Y14";
The SAS System
 
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 0.94438546893391;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "Y15";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 0.94438546893391;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "Y16";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 0.94438546893391;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "TITLE";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 0.94438546893391;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "LEGEND";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 0.94438546893391;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "LEGENDTITLE";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 0.94438546893391;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "SHAPE";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 0.94438546893391;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "METHOD";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 0.94438546893391;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "NOBINMISS";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 0.94438546893391;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   end;
MPRINT(EM_REPORT):   run;
 
NOTE: There were 504 observations read from the data set WORK.EM_USER_REPORT.
NOTE: The data set WORK.EM_USER_REPORT has 630 observations and 4 variables.
NOTE: DATA statement used (Total process time):
      real time           0.04 seconds
      cpu time            0.04 seconds
 
 
MPRINT(REPORT1):  ;
MPRINT(EM_REPORT):   data WORK.EM_USER_REPORT;
MPRINT(EM_REPORT):   set WORK.EM_USER_REPORT end=eof;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   if eof then do;
MPRINT(EM_REPORT):   id+1;
MPRINT(EM_REPORT):   NAME = "KEY";
MPRINT(EM_REPORT):   VALUE = "OUTRSQUARE";
MPRINT(EM_REPORT):   VIEW = 1;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "VIEWTYPE";
MPRINT(EM_REPORT):   VALUE = "SCATTER";
MPRINT(EM_REPORT):   VIEW = 1;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "AUTODISPLAY";
MPRINT(EM_REPORT):   VALUE = "N";
MPRINT(EM_REPORT):   VIEW = 1;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "SPK";
MPRINT(EM_REPORT):   VALUE = "Y";
MPRINT(EM_REPORT):   VIEW = 1;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "COMPARE";
MPRINT(EM_REPORT):   VALUE = "N";
MPRINT(EM_REPORT):   VIEW = 1;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "LOCALIZE";
MPRINT(EM_REPORT):   VALUE = "N";
MPRINT(EM_REPORT):   VIEW = 1;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "EQUALIZEROWX";
MPRINT(EM_REPORT):   VALUE = "N";
MPRINT(EM_REPORT):   VIEW = 1;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "EQUALIZEROWY";
MPRINT(EM_REPORT):   VALUE = "N";
MPRINT(EM_REPORT):   VIEW = 1;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "EQUALIZECOLX";
MPRINT(EM_REPORT):   VALUE = "N";
MPRINT(EM_REPORT):   VIEW = 1;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "EQUALIZECOLY";
MPRINT(EM_REPORT):   VALUE = "N";
MPRINT(EM_REPORT):   VIEW = 1;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "NROWS";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 1;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "NCOLS";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 1;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "DISCRETEX";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 1;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "DISCRETEY";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 1;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "LATTICEX";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 1;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "LATTICEY";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 1;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "LATTICETYPE";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 1;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "ABSOLUTEVALUE";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 1;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "SORTORDER";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 1;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "ORIENTATION";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 1;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "METHOD";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 1;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "DIRECTION";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 1;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "BYSET";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 1;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "RENDERMODE";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 1;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "DESCRIPTION";
MPRINT(EM_REPORT):   VALUE = "rsqplot";
MPRINT(EM_REPORT):   VIEW = 1;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "X";
MPRINT(EM_REPORT):   VALUE = "Cluster";
MPRINT(EM_REPORT):   VIEW = 1;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "EXCLUDEVARS";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 1;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "Y";
MPRINT(EM_REPORT):   VALUE = "RSqRatio";
MPRINT(EM_REPORT):   VIEW = 1;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "Z";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 1;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "YVARS";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 1;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "FREQVARS";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 1;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "AXIS";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 1;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "FREQ";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 1;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "GROUP";
MPRINT(EM_REPORT):   VALUE = "Selected";
MPRINT(EM_REPORT):   VIEW = 1;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "SUBGROUP";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 1;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "BLOCK";
MPRINT(EM_REPORT):   VALUE = "MODEL";
MPRINT(EM_REPORT):   VIEW = 1;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "COLOR";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 1;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "COLORINDEX";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 1;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "TIPTEXT";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 1;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "TIP";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 1;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "TOOLTIP";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 1;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "REPORTID";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 1;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "IDVALUE";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 1;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "ID";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 1;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "SIZE";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 1;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "FROM";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 1;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "TO";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 1;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "VALUE";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 1;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "VIEWS";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 1;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "PARENT";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 1;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "NODETEXT";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 1;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "NODESIZE";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 1;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "STATS";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 1;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "CLASSDIST";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 1;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "INTDIST";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 1;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "FOLDER";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 1;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "YPLOTTYPE";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 1;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "XREF";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 1;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "XREF2";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 1;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "YREF";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 1;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "Y2REF";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 1;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "YREF2";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 1;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "Y2REF2";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 1;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "GROUPINDEX";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 1;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "JOIN";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 1;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "XEXCLUDE";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 1;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "FREQEXCLUDE";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 1;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "YEXCLUDE";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 1;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "NAME";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 1;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "HEIGHT";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 1;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "WIDTH";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 1;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "XAXISLABEL";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 1;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "Y2AXISLABEL";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 1;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "YAXISLABEL";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 1;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "DISPLAYXLABEL";
MPRINT(EM_REPORT):   VALUE = "Y";
MPRINT(EM_REPORT):   VIEW = 1;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "DISPLAYYLABEL";
MPRINT(EM_REPORT):   VALUE = "Y";
MPRINT(EM_REPORT):   VIEW = 1;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "CHOICETEXT";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 1;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "SEGMENTVALUE";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 1;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "LOWERBAND";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 1;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "UPPERBAND";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 1;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "YLINE";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 1;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "LINKKEY";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 1;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "NODEKEY";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 1;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "NODEID";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 1;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "NODEVALUE";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 1;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "NODECOLOR";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 1;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "NODESHAPE";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 1;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "NODESHAPEVAR";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 1;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "NODELABEL";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 1;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "NODETIP";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 1;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "LINKID";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 1;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "LINKVALUE";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 1;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "LINKFROM";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 1;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "LINKTO";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 1;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "LINKCOLOR";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 1;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "LINKWIDTH";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 1;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "LINKTIP";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 1;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "XFROM";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 1;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "XTO";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 1;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "YFROM";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 1;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "YTO";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 1;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "MATRIXVAR";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 1;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "RESPONSE";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 1;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "SERIES";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 1;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "DESCARG";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 1;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "Y1";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 1;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "Y2";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 1;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "Y3";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 1;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "Y4";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 1;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "Y5";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 1;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "Y6";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 1;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "Y7";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 1;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "Y8";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 1;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "Y9";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 1;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "Y10";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 1;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "Y11";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 1;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "Y12";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 1;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "Y13";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 1;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "Y14";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 1;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "Y15";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 1;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "Y16";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 1;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "TITLE";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 1;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "LEGEND";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 1;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "LEGENDTITLE";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 1;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "SHAPE";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 1;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "METHOD";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 1;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "NOBINMISS";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 1;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   end;
MPRINT(EM_REPORT):   run;
 
NOTE: There were 630 observations read from the data set WORK.EM_USER_REPORT.
NOTE: The data set WORK.EM_USER_REPORT has 757 observations and 4 variables.
NOTE: DATA statement used (Total process time):
      real time           0.04 seconds
      cpu time            0.03 seconds
 
 
MPRINT(REPORT1):  ;
MPRINT(EM_REPORT):   data WORK.EM_USER_REPORT;
MPRINT(EM_REPORT):   set WORK.EM_USER_REPORT end=eof;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   if eof then do;
MPRINT(EM_REPORT):   id+1;
MPRINT(EM_REPORT):   NAME = "KEY";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 1;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "VIEWTYPE";
MPRINT(EM_REPORT):   VALUE = "DATA";
MPRINT(EM_REPORT):   VIEW = 1;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "AUTODISPLAY";
MPRINT(EM_REPORT):   VALUE = "N";
MPRINT(EM_REPORT):   VIEW = 1;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "SPK";
MPRINT(EM_REPORT):   VALUE = "Y";
MPRINT(EM_REPORT):   VIEW = 1;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "COMPARE";
MPRINT(EM_REPORT):   VALUE = "N";
MPRINT(EM_REPORT):   VIEW = 1;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "LOCALIZE";
MPRINT(EM_REPORT):   VALUE = "N";
MPRINT(EM_REPORT):   VIEW = 1;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "EQUALIZEROWX";
MPRINT(EM_REPORT):   VALUE = "N";
MPRINT(EM_REPORT):   VIEW = 1;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "EQUALIZEROWY";
MPRINT(EM_REPORT):   VALUE = "N";
MPRINT(EM_REPORT):   VIEW = 1;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "EQUALIZECOLX";
MPRINT(EM_REPORT):   VALUE = "N";
MPRINT(EM_REPORT):   VIEW = 1;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "EQUALIZECOLY";
MPRINT(EM_REPORT):   VALUE = "N";
MPRINT(EM_REPORT):   VIEW = 1;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "NROWS";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 1;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "NCOLS";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 1;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "DISCRETEX";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 1;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "DISCRETEY";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 1;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "LATTICEX";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 1;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "LATTICEY";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 1;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "LATTICETYPE";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 1;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "ABSOLUTEVALUE";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 1;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "SORTORDER";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 1;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "ORIENTATION";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 1;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "METHOD";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 1;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "DIRECTION";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 1;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "BYSET";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 1;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "RENDERMODE";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 1;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "DESCRIPTION";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 1;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "X";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 1;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "EXCLUDEVARS";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 1;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "Y";
MPRINT(EM_REPORT):   VALUE = "RsqWithOwnClusComp";
MPRINT(EM_REPORT):   VIEW = 1;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "Z";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 1;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "YVARS";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 1;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "FREQVARS";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 1;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "AXIS";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 1;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "FREQ";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 1;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "GROUP";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 1;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "SUBGROUP";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 1;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "BLOCK";
MPRINT(EM_REPORT):   VALUE = "CUSTOM";
MPRINT(EM_REPORT):   VIEW = 1;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "COLOR";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 1;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "COLORINDEX";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 1;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "TIPTEXT";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 1;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "TIP";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 1;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "TOOLTIP";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 1;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "REPORTID";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 1;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "IDVALUE";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 1;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "ID";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 1;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "SIZE";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 1;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "FROM";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 1;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "TO";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 1;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "VALUE";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 1;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "VIEWS";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 1;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "PARENT";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 1;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "NODETEXT";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 1;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "NODESIZE";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 1;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "STATS";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 1;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "CLASSDIST";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 1;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "INTDIST";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 1;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "FOLDER";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 1;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "YPLOTTYPE";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 1;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "XREF";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 1;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "XREF2";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 1;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "YREF";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 1;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "Y2REF";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 1;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "YREF2";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 1;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "Y2REF2";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 1;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "GROUPINDEX";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 1;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "JOIN";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 1;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "XEXCLUDE";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 1;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "FREQEXCLUDE";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 1;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "YEXCLUDE";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 1;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "NAME";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 1;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "HEIGHT";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 1;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "WIDTH";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 1;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "XAXISLABEL";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 1;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "Y2AXISLABEL";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 1;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "YAXISLABEL";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 1;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "DISPLAYXLABEL";
MPRINT(EM_REPORT):   VALUE = "Y";
MPRINT(EM_REPORT):   VIEW = 1;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "DISPLAYYLABEL";
MPRINT(EM_REPORT):   VALUE = "Y";
MPRINT(EM_REPORT):   VIEW = 1;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "CHOICETEXT";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 1;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "SEGMENTVALUE";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 1;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "LOWERBAND";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 1;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "UPPERBAND";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 1;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "YLINE";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 1;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "LINKKEY";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 1;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "NODEKEY";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 1;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "NODEID";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 1;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "NODEVALUE";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 1;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "NODECOLOR";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 1;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "NODESHAPE";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 1;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "NODESHAPEVAR";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 1;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "NODELABEL";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 1;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "NODETIP";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 1;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "LINKID";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 1;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "LINKVALUE";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 1;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "LINKFROM";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 1;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "LINKTO";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 1;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "LINKCOLOR";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 1;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "LINKWIDTH";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 1;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "LINKTIP";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 1;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "XFROM";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 1;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "XTO";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 1;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "YFROM";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 1;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "YTO";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 1;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "MATRIXVAR";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 1;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "RESPONSE";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 1;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "SERIES";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 1;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "DESCARG";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 1;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "Y1";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 1;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "Y2";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 1;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "Y3";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 1;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "Y4";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 1;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "Y5";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 1;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "Y6";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 1;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "Y7";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 1;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "Y8";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 1;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "Y9";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 1;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "Y10";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 1;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "Y11";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 1;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "Y12";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 1;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "Y13";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 1;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "Y14";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 1;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "Y15";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 1;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "Y16";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 1;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "TITLE";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 1;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "LEGEND";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 1;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "LEGENDTITLE";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 1;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "SHAPE";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 1;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "METHOD";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 1;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "NOBINMISS";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 1;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   end;
MPRINT(EM_REPORT):   run;
 
NOTE: There were 757 observations read from the data set WORK.EM_USER_REPORT.
NOTE: The data set WORK.EM_USER_REPORT has 884 observations and 4 variables.
NOTE: DATA statement used (Total process time):
      real time           0.04 seconds
      cpu time            0.03 seconds
 
 
MPRINT(REPORT1):  ;
MPRINT(EM_REPORT):   data WORK.EM_USER_REPORT;
MPRINT(EM_REPORT):   set WORK.EM_USER_REPORT end=eof;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   if eof then do;
MPRINT(EM_REPORT):   id+1;
MPRINT(EM_REPORT):   NAME = "KEY";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 1;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "VIEWTYPE";
MPRINT(EM_REPORT):   VALUE = "DATA";
MPRINT(EM_REPORT):   VIEW = 1;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "AUTODISPLAY";
MPRINT(EM_REPORT):   VALUE = "N";
MPRINT(EM_REPORT):   VIEW = 1;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "SPK";
MPRINT(EM_REPORT):   VALUE = "Y";
MPRINT(EM_REPORT):   VIEW = 1;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "COMPARE";
MPRINT(EM_REPORT):   VALUE = "N";
MPRINT(EM_REPORT):   VIEW = 1;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "LOCALIZE";
MPRINT(EM_REPORT):   VALUE = "N";
MPRINT(EM_REPORT):   VIEW = 1;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "EQUALIZEROWX";
MPRINT(EM_REPORT):   VALUE = "N";
MPRINT(EM_REPORT):   VIEW = 1;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "EQUALIZEROWY";
MPRINT(EM_REPORT):   VALUE = "N";
MPRINT(EM_REPORT):   VIEW = 1;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "EQUALIZECOLX";
MPRINT(EM_REPORT):   VALUE = "N";
MPRINT(EM_REPORT):   VIEW = 1;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "EQUALIZECOLY";
MPRINT(EM_REPORT):   VALUE = "N";
MPRINT(EM_REPORT):   VIEW = 1;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "NROWS";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 1;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "NCOLS";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 1;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "DISCRETEX";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 1;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "DISCRETEY";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 1;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "LATTICEX";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 1;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "LATTICEY";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 1;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "LATTICETYPE";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 1;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "ABSOLUTEVALUE";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 1;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "SORTORDER";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 1;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "ORIENTATION";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 1;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "METHOD";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 1;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "DIRECTION";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 1;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "BYSET";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 1;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "RENDERMODE";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 1;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "DESCRIPTION";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 1;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "X";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 1;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "EXCLUDEVARS";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 1;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "Y";
MPRINT(EM_REPORT):   VALUE = "RsqWithNextClusComp";
MPRINT(EM_REPORT):   VIEW = 1;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "Z";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 1;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "YVARS";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 1;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "FREQVARS";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 1;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "AXIS";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 1;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "FREQ";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 1;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "GROUP";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 1;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "SUBGROUP";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 1;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "BLOCK";
MPRINT(EM_REPORT):   VALUE = "CUSTOM";
MPRINT(EM_REPORT):   VIEW = 1;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "COLOR";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 1;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "COLORINDEX";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 1;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "TIPTEXT";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 1;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "TIP";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 1;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "TOOLTIP";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 1;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "REPORTID";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 1;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "IDVALUE";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 1;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "ID";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 1;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "SIZE";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 1;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "FROM";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 1;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "TO";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 1;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "VALUE";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 1;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "VIEWS";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 1;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "PARENT";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 1;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "NODETEXT";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 1;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "NODESIZE";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 1;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "STATS";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 1;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "CLASSDIST";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 1;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "INTDIST";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 1;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "FOLDER";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 1;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "YPLOTTYPE";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 1;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "XREF";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 1;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "XREF2";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 1;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "YREF";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 1;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "Y2REF";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 1;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "YREF2";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 1;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "Y2REF2";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 1;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "GROUPINDEX";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 1;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "JOIN";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 1;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "XEXCLUDE";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 1;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "FREQEXCLUDE";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 1;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "YEXCLUDE";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 1;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "NAME";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 1;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "HEIGHT";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 1;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "WIDTH";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 1;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "XAXISLABEL";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 1;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "Y2AXISLABEL";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 1;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "YAXISLABEL";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 1;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "DISPLAYXLABEL";
MPRINT(EM_REPORT):   VALUE = "Y";
MPRINT(EM_REPORT):   VIEW = 1;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "DISPLAYYLABEL";
MPRINT(EM_REPORT):   VALUE = "Y";
MPRINT(EM_REPORT):   VIEW = 1;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "CHOICETEXT";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 1;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "SEGMENTVALUE";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 1;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "LOWERBAND";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 1;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "UPPERBAND";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 1;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "YLINE";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 1;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "LINKKEY";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 1;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "NODEKEY";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 1;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "NODEID";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 1;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "NODEVALUE";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 1;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "NODECOLOR";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 1;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "NODESHAPE";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 1;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "NODESHAPEVAR";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 1;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "NODELABEL";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 1;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "NODETIP";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 1;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "LINKID";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 1;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "LINKVALUE";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 1;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "LINKFROM";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 1;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "LINKTO";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 1;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "LINKCOLOR";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 1;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "LINKWIDTH";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 1;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "LINKTIP";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 1;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "XFROM";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 1;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "XTO";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 1;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "YFROM";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 1;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "YTO";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 1;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "MATRIXVAR";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 1;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "RESPONSE";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 1;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "SERIES";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 1;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "DESCARG";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 1;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "Y1";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 1;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "Y2";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 1;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "Y3";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 1;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "Y4";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 1;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "Y5";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 1;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "Y6";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 1;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "Y7";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 1;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "Y8";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 1;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "Y9";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 1;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "Y10";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 1;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "Y11";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 1;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "Y12";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 1;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "Y13";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 1;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "Y14";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 1;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "Y15";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 1;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "Y16";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 1;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "TITLE";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 1;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "LEGEND";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 1;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "LEGENDTITLE";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 1;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "SHAPE";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 1;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "METHOD";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 1;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "NOBINMISS";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 1;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   end;
MPRINT(EM_REPORT):   run;
 
NOTE: There were 884 observations read from the data set WORK.EM_USER_REPORT.
NOTE: The data set WORK.EM_USER_REPORT has 1011 observations and 4 variables.
NOTE: DATA statement used (Total process time):
      real time           0.04 seconds
      cpu time            0.04 seconds
 
 
MPRINT(REPORT1):  ;
MPRINT(EM_REPORT):   data WORK.EM_USER_REPORT;
MPRINT(EM_REPORT):   set WORK.EM_USER_REPORT end=eof;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   if eof then do;
MPRINT(EM_REPORT):   id+1;
MPRINT(EM_REPORT):   NAME = "KEY";
MPRINT(EM_REPORT):   VALUE = "OUTCORRPLOT";
MPRINT(EM_REPORT):   VIEW = 0.57465919133958;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "VIEWTYPE";
MPRINT(EM_REPORT):   VALUE = "HISTOGRAM";
MPRINT(EM_REPORT):   VIEW = 0.57465919133958;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "AUTODISPLAY";
MPRINT(EM_REPORT):   VALUE = "N";
MPRINT(EM_REPORT):   VIEW = 0.57465919133958;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "SPK";
MPRINT(EM_REPORT):   VALUE = "Y";
MPRINT(EM_REPORT):   VIEW = 0.57465919133958;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "COMPARE";
MPRINT(EM_REPORT):   VALUE = "N";
MPRINT(EM_REPORT):   VIEW = 0.57465919133958;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "LOCALIZE";
MPRINT(EM_REPORT):   VALUE = "N";
MPRINT(EM_REPORT):   VIEW = 0.57465919133958;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "EQUALIZEROWX";
MPRINT(EM_REPORT):   VALUE = "N";
MPRINT(EM_REPORT):   VIEW = 0.57465919133958;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "EQUALIZEROWY";
MPRINT(EM_REPORT):   VALUE = "N";
MPRINT(EM_REPORT):   VIEW = 0.57465919133958;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "EQUALIZECOLX";
MPRINT(EM_REPORT):   VALUE = "N";
MPRINT(EM_REPORT):   VIEW = 0.57465919133958;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "EQUALIZECOLY";
MPRINT(EM_REPORT):   VALUE = "N";
MPRINT(EM_REPORT):   VIEW = 0.57465919133958;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "NROWS";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 0.57465919133958;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "NCOLS";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 0.57465919133958;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "DISCRETEX";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 0.57465919133958;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "DISCRETEY";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 0.57465919133958;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "LATTICEX";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 0.57465919133958;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "LATTICEY";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 0.57465919133958;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "LATTICETYPE";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 0.57465919133958;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "ABSOLUTEVALUE";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 0.57465919133958;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "SORTORDER";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 0.57465919133958;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "ORIENTATION";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 0.57465919133958;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "METHOD";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 0.57465919133958;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "DIRECTION";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 0.57465919133958;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "BYSET";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 0.57465919133958;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "RENDERMODE";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 0.57465919133958;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "DESCRIPTION";
MPRINT(EM_REPORT):   VALUE = "varcorr";
MPRINT(EM_REPORT):   VIEW = 0.57465919133958;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "X";
MPRINT(EM_REPORT):   VALUE = "_X_";
MPRINT(EM_REPORT):   VIEW = 0.57465919133958;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "EXCLUDEVARS";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 0.57465919133958;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "Y";
MPRINT(EM_REPORT):   VALUE = "_Y_";
MPRINT(EM_REPORT):   VIEW = 0.57465919133958;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "Z";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 0.57465919133958;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "YVARS";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 0.57465919133958;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "FREQVARS";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 0.57465919133958;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "AXIS";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 0.57465919133958;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "FREQ";
MPRINT(EM_REPORT):   VALUE = "correlation";
MPRINT(EM_REPORT):   VIEW = 0.57465919133958;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "GROUP";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 0.57465919133958;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "SUBGROUP";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 0.57465919133958;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "BLOCK";
MPRINT(EM_REPORT):   VALUE = "MODEL";
MPRINT(EM_REPORT):   VIEW = 0.57465919133958;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "COLOR";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 0.57465919133958;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "COLORINDEX";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 0.57465919133958;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "TIPTEXT";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 0.57465919133958;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "TIP";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 0.57465919133958;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "TOOLTIP";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 0.57465919133958;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "REPORTID";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 0.57465919133958;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "IDVALUE";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 0.57465919133958;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "ID";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 0.57465919133958;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "SIZE";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 0.57465919133958;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "FROM";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 0.57465919133958;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "TO";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 0.57465919133958;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "VALUE";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 0.57465919133958;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "VIEWS";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 0.57465919133958;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "PARENT";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 0.57465919133958;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "NODETEXT";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 0.57465919133958;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "NODESIZE";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 0.57465919133958;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "STATS";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 0.57465919133958;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "CLASSDIST";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 0.57465919133958;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "INTDIST";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 0.57465919133958;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "FOLDER";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 0.57465919133958;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "YPLOTTYPE";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 0.57465919133958;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "XREF";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 0.57465919133958;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "XREF2";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 0.57465919133958;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "YREF";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 0.57465919133958;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "Y2REF";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 0.57465919133958;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "YREF2";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 0.57465919133958;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "Y2REF2";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 0.57465919133958;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "GROUPINDEX";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 0.57465919133958;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "JOIN";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 0.57465919133958;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "XEXCLUDE";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 0.57465919133958;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "FREQEXCLUDE";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 0.57465919133958;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "YEXCLUDE";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 0.57465919133958;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "NAME";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 0.57465919133958;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "HEIGHT";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 0.57465919133958;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "WIDTH";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 0.57465919133958;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "XAXISLABEL";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 0.57465919133958;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "Y2AXISLABEL";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 0.57465919133958;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "YAXISLABEL";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 0.57465919133958;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "DISPLAYXLABEL";
MPRINT(EM_REPORT):   VALUE = "Y";
MPRINT(EM_REPORT):   VIEW = 0.57465919133958;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "DISPLAYYLABEL";
MPRINT(EM_REPORT):   VALUE = "Y";
MPRINT(EM_REPORT):   VIEW = 0.57465919133958;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "CHOICETEXT";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 0.57465919133958;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "SEGMENTVALUE";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 0.57465919133958;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "LOWERBAND";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 0.57465919133958;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "UPPERBAND";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 0.57465919133958;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "YLINE";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 0.57465919133958;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "LINKKEY";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 0.57465919133958;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "NODEKEY";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 0.57465919133958;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "NODEID";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 0.57465919133958;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "NODEVALUE";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 0.57465919133958;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "NODECOLOR";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 0.57465919133958;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "NODESHAPE";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 0.57465919133958;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "NODESHAPEVAR";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 0.57465919133958;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "NODELABEL";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 0.57465919133958;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "NODETIP";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 0.57465919133958;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "LINKID";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 0.57465919133958;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "LINKVALUE";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 0.57465919133958;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "LINKFROM";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 0.57465919133958;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "LINKTO";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 0.57465919133958;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "LINKCOLOR";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 0.57465919133958;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "LINKWIDTH";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 0.57465919133958;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "LINKTIP";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 0.57465919133958;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "XFROM";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 0.57465919133958;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "XTO";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 0.57465919133958;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "YFROM";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 0.57465919133958;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "YTO";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 0.57465919133958;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "MATRIXVAR";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 0.57465919133958;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "RESPONSE";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 0.57465919133958;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "SERIES";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 0.57465919133958;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "DESCARG";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 0.57465919133958;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "Y1";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 0.57465919133958;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "Y2";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 0.57465919133958;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "Y3";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 0.57465919133958;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "Y4";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 0.57465919133958;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "Y5";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 0.57465919133958;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "Y6";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 0.57465919133958;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "Y7";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 0.57465919133958;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "Y8";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 0.57465919133958;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "Y9";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 0.57465919133958;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "Y10";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 0.57465919133958;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "Y11";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 0.57465919133958;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "Y12";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 0.57465919133958;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "Y13";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 0.57465919133958;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "Y14";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 0.57465919133958;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "Y15";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 0.57465919133958;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "Y16";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 0.57465919133958;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "TITLE";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 0.57465919133958;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "LEGEND";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 0.57465919133958;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "LEGENDTITLE";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 0.57465919133958;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "SHAPE";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 0.57465919133958;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "METHOD";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 0.57465919133958;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "NOBINMISS";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 0.57465919133958;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   end;
MPRINT(EM_REPORT):   run;
 
NOTE: There were 1011 observations read from the data set WORK.EM_USER_REPORT.
NOTE: The data set WORK.EM_USER_REPORT has 1138 observations and 4 variables.
NOTE: DATA statement used (Total process time):
      real time           0.03 seconds
      cpu time            0.03 seconds
 
 
MPRINT(REPORT1):  ;
MPRINT(EM_REPORT):   data WORK.EM_USER_REPORT;
MPRINT(EM_REPORT):   set WORK.EM_USER_REPORT end=eof;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   if eof then do;
MPRINT(EM_REPORT):   id+1;
MPRINT(EM_REPORT):   NAME = "KEY";
MPRINT(EM_REPORT):   VALUE = "OUTCLUSCORRPLOT";
MPRINT(EM_REPORT):   VIEW = 0.45481198628191;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "VIEWTYPE";
MPRINT(EM_REPORT):   VALUE = "HISTOGRAM";
MPRINT(EM_REPORT):   VIEW = 0.45481198628191;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "AUTODISPLAY";
MPRINT(EM_REPORT):   VALUE = "N";
MPRINT(EM_REPORT):   VIEW = 0.45481198628191;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "SPK";
MPRINT(EM_REPORT):   VALUE = "Y";
MPRINT(EM_REPORT):   VIEW = 0.45481198628191;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "COMPARE";
MPRINT(EM_REPORT):   VALUE = "N";
MPRINT(EM_REPORT):   VIEW = 0.45481198628191;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "LOCALIZE";
MPRINT(EM_REPORT):   VALUE = "N";
MPRINT(EM_REPORT):   VIEW = 0.45481198628191;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "EQUALIZEROWX";
MPRINT(EM_REPORT):   VALUE = "N";
MPRINT(EM_REPORT):   VIEW = 0.45481198628191;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "EQUALIZEROWY";
MPRINT(EM_REPORT):   VALUE = "N";
MPRINT(EM_REPORT):   VIEW = 0.45481198628191;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "EQUALIZECOLX";
MPRINT(EM_REPORT):   VALUE = "N";
MPRINT(EM_REPORT):   VIEW = 0.45481198628191;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "EQUALIZECOLY";
MPRINT(EM_REPORT):   VALUE = "N";
MPRINT(EM_REPORT):   VIEW = 0.45481198628191;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "NROWS";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 0.45481198628191;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "NCOLS";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 0.45481198628191;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "DISCRETEX";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 0.45481198628191;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "DISCRETEY";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 0.45481198628191;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "LATTICEX";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 0.45481198628191;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "LATTICEY";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 0.45481198628191;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "LATTICETYPE";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 0.45481198628191;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "ABSOLUTEVALUE";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 0.45481198628191;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "SORTORDER";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 0.45481198628191;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "ORIENTATION";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 0.45481198628191;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "METHOD";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 0.45481198628191;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "DIRECTION";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 0.45481198628191;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "BYSET";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 0.45481198628191;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "RENDERMODE";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 0.45481198628191;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "DESCRIPTION";
MPRINT(EM_REPORT):   VALUE = "cluscorr";
MPRINT(EM_REPORT):   VIEW = 0.45481198628191;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "X";
MPRINT(EM_REPORT):   VALUE = "X";
MPRINT(EM_REPORT):   VIEW = 0.45481198628191;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "EXCLUDEVARS";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 0.45481198628191;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "Y";
MPRINT(EM_REPORT):   VALUE = "Y";
MPRINT(EM_REPORT):   VIEW = 0.45481198628191;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "Z";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 0.45481198628191;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "YVARS";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 0.45481198628191;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "FREQVARS";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 0.45481198628191;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "AXIS";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 0.45481198628191;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "FREQ";
MPRINT(EM_REPORT):   VALUE = "Correlation";
MPRINT(EM_REPORT):   VIEW = 0.45481198628191;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "GROUP";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 0.45481198628191;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "SUBGROUP";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 0.45481198628191;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "BLOCK";
MPRINT(EM_REPORT):   VALUE = "MODEL";
MPRINT(EM_REPORT):   VIEW = 0.45481198628191;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "COLOR";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 0.45481198628191;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "COLORINDEX";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 0.45481198628191;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "TIPTEXT";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 0.45481198628191;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "TIP";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 0.45481198628191;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "TOOLTIP";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 0.45481198628191;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "REPORTID";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 0.45481198628191;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "IDVALUE";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 0.45481198628191;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "ID";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 0.45481198628191;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "SIZE";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 0.45481198628191;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "FROM";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 0.45481198628191;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "TO";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 0.45481198628191;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "VALUE";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 0.45481198628191;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "VIEWS";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 0.45481198628191;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "PARENT";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 0.45481198628191;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "NODETEXT";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 0.45481198628191;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "NODESIZE";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 0.45481198628191;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "STATS";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 0.45481198628191;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "CLASSDIST";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 0.45481198628191;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "INTDIST";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 0.45481198628191;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "FOLDER";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 0.45481198628191;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "YPLOTTYPE";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 0.45481198628191;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "XREF";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 0.45481198628191;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "XREF2";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 0.45481198628191;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "YREF";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 0.45481198628191;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "Y2REF";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 0.45481198628191;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "YREF2";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 0.45481198628191;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "Y2REF2";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 0.45481198628191;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "GROUPINDEX";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 0.45481198628191;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "JOIN";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 0.45481198628191;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "XEXCLUDE";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 0.45481198628191;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "FREQEXCLUDE";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 0.45481198628191;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "YEXCLUDE";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 0.45481198628191;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "NAME";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 0.45481198628191;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "HEIGHT";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 0.45481198628191;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "WIDTH";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 0.45481198628191;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "XAXISLABEL";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 0.45481198628191;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "Y2AXISLABEL";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 0.45481198628191;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "YAXISLABEL";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 0.45481198628191;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "DISPLAYXLABEL";
MPRINT(EM_REPORT):   VALUE = "Y";
MPRINT(EM_REPORT):   VIEW = 0.45481198628191;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "DISPLAYYLABEL";
MPRINT(EM_REPORT):   VALUE = "Y";
MPRINT(EM_REPORT):   VIEW = 0.45481198628191;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "CHOICETEXT";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 0.45481198628191;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "SEGMENTVALUE";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 0.45481198628191;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "LOWERBAND";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 0.45481198628191;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "UPPERBAND";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 0.45481198628191;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "YLINE";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 0.45481198628191;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "LINKKEY";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 0.45481198628191;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "NODEKEY";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 0.45481198628191;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "NODEID";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 0.45481198628191;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "NODEVALUE";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 0.45481198628191;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "NODECOLOR";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 0.45481198628191;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "NODESHAPE";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 0.45481198628191;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "NODESHAPEVAR";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 0.45481198628191;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "NODELABEL";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 0.45481198628191;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "NODETIP";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 0.45481198628191;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "LINKID";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 0.45481198628191;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "LINKVALUE";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 0.45481198628191;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "LINKFROM";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 0.45481198628191;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "LINKTO";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 0.45481198628191;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "LINKCOLOR";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 0.45481198628191;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "LINKWIDTH";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 0.45481198628191;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "LINKTIP";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 0.45481198628191;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "XFROM";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 0.45481198628191;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "XTO";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 0.45481198628191;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "YFROM";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 0.45481198628191;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "YTO";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 0.45481198628191;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "MATRIXVAR";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 0.45481198628191;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "RESPONSE";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 0.45481198628191;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "SERIES";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 0.45481198628191;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "DESCARG";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 0.45481198628191;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "Y1";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 0.45481198628191;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "Y2";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 0.45481198628191;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "Y3";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 0.45481198628191;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "Y4";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 0.45481198628191;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "Y5";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 0.45481198628191;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "Y6";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 0.45481198628191;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "Y7";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 0.45481198628191;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "Y8";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 0.45481198628191;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "Y9";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 0.45481198628191;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "Y10";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 0.45481198628191;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "Y11";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 0.45481198628191;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "Y12";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 0.45481198628191;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "Y13";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 0.45481198628191;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "Y14";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 0.45481198628191;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "Y15";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 0.45481198628191;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "Y16";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 0.45481198628191;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "TITLE";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 0.45481198628191;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "LEGEND";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 0.45481198628191;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "LEGENDTITLE";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 0.45481198628191;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "SHAPE";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 0.45481198628191;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "METHOD";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 0.45481198628191;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "NOBINMISS";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 0.45481198628191;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   end;
MPRINT(EM_REPORT):   run;
 
NOTE: There were 1138 observations read from the data set WORK.EM_USER_REPORT.
NOTE: The data set WORK.EM_USER_REPORT has 1265 observations and 4 variables.
NOTE: DATA statement used (Total process time):
      real time           0.04 seconds
      cpu time            0.04 seconds
 
 
MPRINT(REPORT1):  ;
MPRINT(EM_REPORT):   data WORK.EM_USER_REPORT;
MPRINT(EM_REPORT):   set WORK.EM_USER_REPORT end=eof;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   if eof then do;
MPRINT(EM_REPORT):   id+1;
MPRINT(EM_REPORT):   NAME = "KEY";
MPRINT(EM_REPORT):   VALUE = "OUTCLUSSTRUCT";
MPRINT(EM_REPORT):   VIEW = 2;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "VIEWTYPE";
MPRINT(EM_REPORT):   VALUE = "BAR";
MPRINT(EM_REPORT):   VIEW = 2;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "AUTODISPLAY";
MPRINT(EM_REPORT):   VALUE = "N";
MPRINT(EM_REPORT):   VIEW = 2;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "SPK";
MPRINT(EM_REPORT):   VALUE = "Y";
MPRINT(EM_REPORT):   VIEW = 2;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "COMPARE";
MPRINT(EM_REPORT):   VALUE = "N";
MPRINT(EM_REPORT):   VIEW = 2;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "LOCALIZE";
MPRINT(EM_REPORT):   VALUE = "N";
MPRINT(EM_REPORT):   VIEW = 2;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "EQUALIZEROWX";
MPRINT(EM_REPORT):   VALUE = "N";
MPRINT(EM_REPORT):   VIEW = 2;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "EQUALIZEROWY";
MPRINT(EM_REPORT):   VALUE = "N";
MPRINT(EM_REPORT):   VIEW = 2;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "EQUALIZECOLX";
MPRINT(EM_REPORT):   VALUE = "N";
MPRINT(EM_REPORT):   VIEW = 2;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "EQUALIZECOLY";
MPRINT(EM_REPORT):   VALUE = "N";
MPRINT(EM_REPORT):   VIEW = 2;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "NROWS";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 2;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "NCOLS";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 2;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "DISCRETEX";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 2;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "DISCRETEY";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 2;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "LATTICEX";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 2;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "LATTICEY";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 2;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "LATTICETYPE";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 2;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "ABSOLUTEVALUE";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 2;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "SORTORDER";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 2;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "ORIENTATION";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 2;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "METHOD";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 2;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "DIRECTION";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 2;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "BYSET";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 2;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "RENDERMODE";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 2;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "DESCRIPTION";
MPRINT(EM_REPORT):   VALUE = "corrstruct";
MPRINT(EM_REPORT):   VIEW = 2;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "X";
MPRINT(EM_REPORT):   VALUE = "Cluster";
MPRINT(EM_REPORT):   VIEW = 2;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "EXCLUDEVARS";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 2;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "Z";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 2;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "YVARS";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 2;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "FREQVARS";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 2;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "AXIS";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 2;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "FREQ";
MPRINT(EM_REPORT):   VALUE = "_anynumeric_";
MPRINT(EM_REPORT):   VIEW = 2;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "GROUP";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 2;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "SUBGROUP";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 2;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "BLOCK";
MPRINT(EM_REPORT):   VALUE = "MODEL";
MPRINT(EM_REPORT):   VIEW = 2;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "COLOR";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 2;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "COLORINDEX";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 2;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "TIPTEXT";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 2;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "TIP";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 2;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "TOOLTIP";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 2;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "REPORTID";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 2;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "IDVALUE";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 2;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "ID";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 2;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "SIZE";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 2;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "FROM";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 2;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "TO";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 2;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "VALUE";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 2;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "VIEWS";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 2;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "PARENT";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 2;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "NODETEXT";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 2;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "NODESIZE";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 2;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "STATS";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 2;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "CLASSDIST";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 2;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "INTDIST";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 2;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "FOLDER";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 2;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "YPLOTTYPE";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 2;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "XREF";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 2;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "XREF2";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 2;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "YREF";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 2;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "Y2REF";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 2;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "YREF2";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 2;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "Y2REF2";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 2;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "GROUPINDEX";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 2;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "JOIN";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 2;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "XEXCLUDE";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 2;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "FREQEXCLUDE";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 2;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "YEXCLUDE";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 2;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "NAME";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 2;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "HEIGHT";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 2;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "WIDTH";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 2;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "XAXISLABEL";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 2;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "Y2AXISLABEL";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 2;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "YAXISLABEL";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 2;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "DISPLAYXLABEL";
MPRINT(EM_REPORT):   VALUE = "Y";
MPRINT(EM_REPORT):   VIEW = 2;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "DISPLAYYLABEL";
MPRINT(EM_REPORT):   VALUE = "Y";
MPRINT(EM_REPORT):   VIEW = 2;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "CHOICETEXT";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 2;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "SEGMENTVALUE";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 2;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "LOWERBAND";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 2;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "UPPERBAND";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 2;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "YLINE";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 2;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "LINKKEY";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 2;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "NODEKEY";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 2;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "NODEID";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 2;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "NODEVALUE";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 2;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "NODECOLOR";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 2;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "NODESHAPE";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 2;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "NODESHAPEVAR";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 2;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "NODELABEL";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 2;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "NODETIP";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 2;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "LINKID";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 2;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "LINKVALUE";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 2;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "LINKFROM";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 2;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "LINKTO";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 2;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "LINKCOLOR";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 2;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "LINKWIDTH";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 2;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "LINKTIP";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 2;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "XFROM";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 2;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "XTO";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 2;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "YFROM";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 2;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "YTO";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 2;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "MATRIXVAR";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 2;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "RESPONSE";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 2;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "SERIES";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 2;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "DESCARG";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 2;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "Y1";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 2;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "Y2";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 2;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "Y3";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 2;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "Y4";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 2;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "Y5";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 2;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "Y6";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 2;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "Y7";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 2;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "Y8";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 2;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "Y9";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 2;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "Y10";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 2;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "Y11";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 2;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "Y12";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 2;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "Y13";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 2;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "Y14";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 2;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "Y15";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 2;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "Y16";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 2;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "TITLE";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 2;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "LEGEND";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 2;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "LEGENDTITLE";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 2;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "SHAPE";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 2;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "METHOD";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 2;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   NAME = "NOBINMISS";
MPRINT(EM_REPORT):   VALUE = "";
MPRINT(EM_REPORT):   VIEW = 2;
MPRINT(EM_REPORT):   output;
MPRINT(EM_REPORT):   end;
MPRINT(EM_REPORT):   run;
 
NOTE: There were 1265 observations read from the data set WORK.EM_USER_REPORT.
NOTE: The data set WORK.EM_USER_REPORT has 1391 observations and 4 variables.
NOTE: DATA statement used (Total process time):
      real time           0.03 seconds
      cpu time            0.03 seconds
 
 
MPRINT(REPORT1):   ;
MPRINT(REPORT):  ;
MPRINT(REPORT):  ;
MPRINT(REPORT):   data EMWS8.VarClus_VARCLUSMETA;
MPRINT(REPORT):   set EMWS8.VarClus_VARCLUSMETA;
MPRINT(REPORT):   NewTrain = "N";
MPRINT(REPORT):   run;
 
NOTE: There were 1 observations read from the data set EMWS8.VARCLUS_VARCLUSMETA.
NOTE: The data set EMWS8.VARCLUS_VARCLUSMETA has 1 observations and 5 variables.
NOTE: DATA statement used (Total process time):
      real time           0.01 seconds
      cpu time            0.01 seconds
 
 
MPRINT(REPORT):   quit;
MPRINT(MAIN):  ;
MPRINT(EM_DIAGRAM):  ;
MPRINT(EM_DIAGRAM):   *------------------------------------------------------------*;
MPRINT(EM_DIAGRAM):   * End REPORT: VarClus;
MPRINT(EM_DIAGRAM):   *------------------------------------------------------------*;
103556
103557     *------------------------------------------------------------*;
103558     * End REPORT: VarClus;
103559     *------------------------------------------------------------*;
 
103560     /* Reset EM Options */
103561     options formchar="|----|+|---+=|-/\<>*";
MPRINT(EM_DIAGRAM):    options formchar="|----|+|---+=|-/\<>*";
103562     options nocenter ls=256 ps=10000;
MPRINT(EM_DIAGRAM):   options nocenter ls=256 ps=10000;
103563     goptions reset=all device=WMF NODISPLAY;
MPRINT(EM_DIAGRAM):   goptions reset=all device=WMF NODISPLAY;
103564     proc sort data=WORK.EM_USER_REPORT;
MPRINT(EM_DIAGRAM):    proc sort data=WORK.EM_USER_REPORT;
103565     by ID VIEW;
MPRINT(EM_DIAGRAM):   by ID VIEW;
103566     run;
MPRINT(EM_DIAGRAM):   run;
 
NOTE: There were 1391 observations read from the data set WORK.EM_USER_REPORT.
NOTE: The data set WORK.EM_USER_REPORT has 1391 observations and 4 variables.
NOTE: PROCEDURE SORT used (Total process time):
      real time           0.01 seconds
      cpu time            0.01 seconds
 
 
MPRINT(EM_DIAGRAM):    proc printto;
MPRINT(EM_DIAGRAM):   run;
